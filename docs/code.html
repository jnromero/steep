
<html>

<head>
    <link href="style.css?234" rel="stylesheet" type="text/css" />
    <link href="../code/css/prism/prism.css" rel="stylesheet" type="text/css" />
</head>

<body>
<div id="sideBar">
    <div class="sideBarHeader">STEEP Files</div>
</div>
<div id="mainContent">

<div class="header">/LICENSE</div>
<div class="p">
<pre class="line-numbers"><code class="language-plain">Copyright 2018 Julian Romero

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</code></pre>
</div>

<div class="header">/README.md</div>
<div class="p">
<pre class="line-numbers"><code class="language-plain"># steep - Simple Toolbox for Experimental Economics Programs
Steep is a minimal framework that allows for interaction between a python server and web browser clients (via javascript).  Steep is simple, and doesn't have a lot of built in features, which allows for a lot of flexibility.

Some preliminary documentation can be found here: 

http://steep.readthedocs.io/en/latest/
</code></pre>
</div>

<div class="header">/changes.txt</div>
<div class="p">
<pre class="line-numbers"><code class="language-plain">Make a timer so that can pause and restart experiment from different times
	- rather than using time.time() will use self.steepTime

- fix sidNotSet
- make slider
- ability to add packages

</code></pre>
</div>

<div class="header">/code/css/common.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">/** * Eric Meyer's Reset CSS v2.0 (http://meyerweb.com/eric/tools/css/reset/) * http://cssreset.com */
/*html, body, div, span, applet, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, code,del, dfn, em, img, ins, kbd, q, s, samp,small, strike, strong, sub, sup, tt, var,b, u, i, center,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td,article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary,time, mark, audio, video {  margin: 0;  padding: 0; border: 0;  font-size: 100%;  font: inherit;  vertical-align: baseline;}/* HTML5 display-role reset for older browsers */
/*article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {  display: block;}body {  line-height: 1;}ol, ul {  list-style: none;}blockquote, q { quotes: none;}blockquote:before, blockquote:after,q:before, q:after { content: '';  content: none;}*/
table {  border-collapse: collapse;  border-spacing: 0;}

* {
    box-sizing: border-box;
}

::-webkit-scrollbar { 
    display: none; 
}


body {
    background-color:rgba(50,50,150,.1);
    padding: 0;
    margin:0px auto;
    /*font-family:'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif;*/
    font-family:Proxima Nova;
    font-size: 12px;
    font-style: normal;
    font-variant: normal;
    font-weight: 300;
}


div{
    -khtml-user-select: none;
    -o-user-select: none;
    -moz-user-select: none;
    -webkit-user-select: none;
    user-select: none;

}


#mainDiv {
    position:relative;
    width:1280px;    
    height:1024px;    
    width:1600px;    
    height:900px;    
    background-color:rgba(255,255,0,.1);
    margin: 0 auto;
    overflow:hidden;
}


#genericScreen{
    font-size: 300%;
    position: absolute;
    background-color: rgba(250,250,250,1);
    display: block;
    width: 100%;
    height:100%;
    box-sizing: border-box;
    border:10px green solid;
    text-align:center;
}


#genericScreenInside { 
  position: absolute; 
  width: 100%;
  height:100%;
  box-sizing: border-box;
  border:60px transparent solid;
  display: table; 
}

#genericScreenText {
  display: table-cell; 
  vertical-align: middle; 
  text-align: center; 
    line-height:100px;;
}


/*https://jsfiddle.net/qaws2emt/*/

.arrow_box {
  z-index: 9999;
  box-sizing: border-box;
  position: absolute;
  border: 4px solid;
  background: #88b7d5;
  border-color: #c2e1f5;
  min-height:100px;
  width:200px;
  line-height:25px;
  text-align:center;
}
.arrow_box:after, .arrow_box:before {
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.arrow_box:after {
  border-color: rgba(136, 183, 213, 0);
  border-width: 20px;
}
.arrow_box:before {
  border-color: rgba(194, 225, 245, 0);
  border-width: 26px;
}

.arrow_box_left,.arrow_box_right{
  animation-name: bounceLR;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
  animation-duration: 1s;
}

.arrowOpacity{
  animation-name: opacityFade;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
  animation-duration: 1s;
}


.arrow_box_left:after, .arrow_box_left:before {
  right: 100%;
  top: 50%;
}

.arrow_box_left:after {
  border-right-color: #88b7d5;
  margin-top: -20px;
}
.arrow_box_left:before {
  border-right-color: #c2e1f5;
  margin-top: -26px;
}

.arrow_box_right:after, .arrow_box_right:before {
  left: 100%;
  top: 50%;
}

.arrow_box_right:after {
  border-left-color: #88b7d5;
  margin-top: -20px;
}
.arrow_box_right:before {
  border-left-color: #c2e1f5;
  margin-top: -26px;
}

.arrow_box_up,.arrow_box_down{
  animation-name: bounceUD;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
  animation-duration: 1s;
}


.arrow_box_up:after, .arrow_box_up:before {
  left: 50%;
  bottom: 100%;
}

.arrow_box_up:after {
  border-bottom-color: #88b7d5;
  margin-left: -20px;
}
.arrow_box_up:before {
  border-bottom-color: #c2e1f5;
  margin-left: -26px;
}


.arrow_box_down:after, .arrow_box_down:before {
  left: 50%;
  top: 100%;
}

.arrow_box_down:after {
  border-top-color: #88b7d5;
  margin-left: -20px;
}
.arrow_box_down:before {
  border-top-color: #c2e1f5;
  margin-left: -26px;
}



.thisArrow{
  left:100px;
  top:100px;
}

@keyframes bounceUD {
    0% {transform: translateY(0px);}
    50% {transform: translateY(20px);}
    100% {transform: translateY(0px);}
}

@keyframes bounceLR {
    0% {transform: translateX(0px);}
    50% {transform: translateX(20px);}
    100% {transform: translateX(0px);}
}


@keyframes opacityFade {
    0% {opacity: 0;}
    50% {opacity: 1;}
    100% {opacity: 0;}
}


.placedText{
  position: absolute;
  width:100%;
  text-align: center;
  color: black;
  height: 50px;
}




  
  *{
    --w3-yellow: rgba(236, 219, 84, 1); 
    --w3-red: rgba(233, 75, 60, 1); 
    --w3-lightblue: rgba(111, 159, 216, 1);
    --w3-brownred: rgba(148, 71, 67, 1);
    --w3-lavender: rgba(219, 177, 205, 1);
    --w3-pink: rgba(236, 151, 135, 1);
    --w3-turquoise: rgba(0, 165, 145, 1);
    --w3-purple: rgba(107, 91, 149, 1);
    --w3-brown:rgba(108, 79, 61, 1) ;
    --w3-offwhite: rgba(234, 222, 219, 1);
    --w3-pinkpurple: rgba(188, 112, 164, 1);
    --w3-green: rgba(191, 214, 65, 1);

    --w3-yellow1: rgba(236, 219, 84, .1); 
    --w3-red1: rgba(233, 75, 60, .1); 
    --w3-lightblue1: rgba(111, 159, 216, .1);
    --w3-brownred1: rgba(148, 71, 67, .1);
    --w3-lavender1: rgba(219, 177, 205, .1);
    --w3-pink11: rgba(236, 151, 135, .1);
    --w3-turquoise1: rgba(0, 165, 145, .1);
    --w3-purple1: rgba(107, 91, 149, .1);
    --w3-brown:rgba(108, 79, 61, .1) ;
    --w3-offwhite1: rgba(234, 222, 219, .1);
    --w3-pinkpurple1: rgba(188, 112, 164, .1);
    --w3-green1: rgba(191, 214, 65, .1);

    --w3-yellow2: rgba(236, 219, 84, .2); 
    --w3-red2: rgba(233, 75, 60, .2); 
    --w3-lightblue2: rgba(111, 159, 216, .2);
    --w3-brownred2: rgba(148, 71, 67, .2);
    --w3-lavender2: rgba(219, 177, 205, .2);
    --w3-pink2: rgba(236, 151, 135, .2);
    --w3-turquoise2: rgba(0, 165, 145, .2);
    --w3-purple2: rgba(107, 91, 149, .2);
    --w3-brown:rgba(108, 79, 61, .2) ;
    --w3-offwhite2: rgba(234, 222, 219, .2);
    --w3-pinkpurple2: rgba(188, 112, 164, .2);
    --w3-green2: rgba(191, 214, 65, .2);

  }


</code></pre>
</div>

<div class="header">/code/css/console.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">
/** * Eric Meyer's Reset CSS v2.0 (http://meyerweb.com/eric/tools/css/reset/) * http://cssreset.com */
html, body, div, span, applet, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, code,del, dfn, em, img, ins, kbd, q, s, samp,small, strike, strong, sub, sup, tt, var,b, u, i, center,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td,article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary,time, mark, audio, video {  margin: 0;  padding: 0; border: 0;  font-size: 100%;  font: inherit;  vertical-align: baseline;}/* HTML5 display-role reset for older browsers */article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {  display: block;}body {  line-height: 1;}ol, ul {  list-style: none;}blockquote, q { quotes: none;}blockquote:before, blockquote:after,q:before, q:after { content: '';  content: none;}table {  border-collapse: collapse;  border-spacing: 0;}

html{
  background-color:rgba(0, 0, 0, .2);
  -webkit-tap-highlight-color:transparent;
}


body{
  background-color:rgba(255,255,255,.9);
  width:1600px;
  height:900px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 0px;
}


#mainDiv{
  width: 100%;
  height:100%;
  border:0px solid red;
  overflow: scroll;
  position:relative;
  background-color: rgba(0,255,0,.1);
  background-color: rgba(255,255,255,1);
}



#pythonConsole{
  background-color: rgba(255,255,255,1);
  position:absolute;
  left: 2%;
  top:5%;
  height:90%;
  width:90%;
  border:0px solid black;
  overflow: hidden;
  overflow: scroll; 
}

#pythonConsoleIN{
  background-color: rgba(255,255,255,1);
  color:green;
  position:absolute;
  left: 0%;
  top:0%;
  width:100%;
  min-height:100%;
  border:0px solid black;
  overflow: hidden;
  overflow-x: scroll;

}

.error{
  color:red;
}

#consoleTabContainer{
  position: absolute;
  top:900px;
  width:1600px;
  line-height: 50px;
  border-left: 1px solid black;
}


.consoleTab{
  display: inline-block;
  top:0px;
  text-align: center;
  width:50px;
  height:50px;
  line-height: 50px;
  border: 1px solid black;
  border-top: 0px;
  border-left: 0px;
  text-decoration: none;
  font-size: 150%;
}

.consoleTabPressed{
  background-color: rgba(0,255,0,.1);
}

.lineNumber{
  display: inline-block;
  color:black;
  font-size: 50%;
  width:50px;
  height: 25px;
  text-align: center;
  line-height: 25px;
}

.stdTwisted{
  color:blue;
}

.stdErr{
  color:red;
}

.stdOut{
  color:green;
}

.consoleLine{
  font-family: Inconsolata;
  font-size: 14px;
  font-style: normal;
  font-variant: normal;
  font-weight: 500;
  line-height: 20px;
  width:30000px;
  overflow-x: scroll;
}

.subLine{
  color:black;
  margin-left:50px;
  font-size: 16px;
  line-height: 18px;
}
</code></pre>
</div>

<div class="header">/code/css/instructions.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">/** * Eric Meyer's Reset CSS v2.0 (http://meyerweb.com/eric/tools/css/reset/) * http://cssreset.com */
html, body, div, span, applet, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, code,del, dfn, em, img, ins, kbd, q, s, samp,small, strike, strong, sub, sup, tt, var,b, u, i, center,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td,article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary,time, mark, audio, video {  margin: 0;  padding: 0; border: 0;  font-size: 100%;  font: inherit;  vertical-align: baseline;}/* HTML5 display-role reset for older browsers */article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {  display: block;}body {  line-height: 1;}ol, ul {  list-style: none;}blockquote, q { quotes: none;}blockquote:before, blockquote:after,q:before, q:after { content: '';  content: none;}table {  border-collapse: collapse;  border-spacing: 0;}

#mainDivOverlay {
    position:absolute;
    display: block;
    background-color:rgba(0,0,0,.7);
    z-index:2;
    left: 0px;
    top:0px;
    width:100%;    
    height:100%;    
    overflow-y:hidden;
}


#captionOverlay {
    position:absolute;
    display: block;
    background-color:rgba(255,0,0,0);
    z-index:900;
    left: 0px;
    bottom:0px;
    width:100%;    
    height:100%;    
    overflow-y:hidden;
}



#captions {
    background-color: rgba(155,155,255,.2);
    color: rgba(255,0,0,1);
    position:absolute;
    width:100%;    
    height:40px;
    display: block;
    font-size: 200%;   
    margin: auto;
    bottom:0px;
    overflow-y:hidden;
    text-align: center;
    line-height: 40px;
    z-index:500;
}

.instructionsElapsed {
    background-color: rgba(240,240,255,1);
    color: rgba(255,0,0,1);
    position:absolute;
    width:100%; 
    height:40px;
    display: block;
    font-size: 200%;   
    margin: auto;
    bottom:0px;
    overflow-y:hidden;
    text-align: left;
    line-height: 40px;
    z-index:5;
}

#welcomeScreen{
    font-size: 400%;
    position: absolute;
    background-color: rgba(100,100,250,.2);
    display: block;
    width: 100%;
    height:100%;
    box-sizing: border-box;
    border:0px green solid;
    text-align:center;
}


.welcomeScreenTitle{
    display: inline-block;
    font-size: 400%;
}



.welcomeScreenTitle.animated1 {
  transform-style: preserve-3d;
  animation: 5000ms spin1 infinite linear;
}

.welcomeScreenTitle.animated2 {
  transform-style: preserve-3d;
  animation: 5000ms spin2 infinite linear;
}

.welcomeScreenTitle.animated3 {
  transform-style: preserve-3d;
  animation: 5000ms spin3 infinite linear;
}

.welcomeScreenTitle.animated4 {
  transform-style: preserve-3d;
  animation: 5000ms spin4 infinite linear;
}

.welcomeScreenTitle.animated5 {
  transform-style: preserve-3d;
  animation: 5000ms spin5 infinite linear;
}

@keyframes spin1 {
  0% { transform: rotateY( 0deg ); }
  10% { transform: rotateY( 360deg ); }
  100% { transform: rotateY( 360deg ); }
}

@keyframes spin2 {
  0% { transform: rotateY( 0deg ); }
  5% { transform: rotateY( 0deg ); }
  15% { transform: rotateY( 360deg ); }
  100% { transform: rotateY( 360deg ); }
}

@keyframes spin3 {
  0% { transform: rotateY( 0deg ); }
  10% { transform: rotateY( 0deg ); }
  20% { transform: rotateY( 360deg ); }
  100% { transform: rotateY( 360deg ); }
}

@keyframes spin4 {
  0% { transform: rotateY( 0deg ); }
  15% { transform: rotateY( 0deg ); }
  25% { transform: rotateY( 360deg ); }
  100% { transform: rotateY( 360deg ); }
}

@keyframes spin5 {
  0% { transform: rotateY( 0deg ); }
  20% { transform: rotateY( 0deg ); }
  30% { transform: rotateY( 360deg ); }
  100% { transform: rotateY( 360deg ); }
}


@keyframes spin22 {
  0% { transform: scale( 1 ); }
  100% { transform: scale( 1.1 ); }
}


#welcomeScreenInside { 
    background-color: red;
  position: absolute; 
  left: 3%; 
  top: 3%; 
  width: 94%; 
  height: 94%; 
  display: table; 
}

#welcomeScreenText {
  display: table-cell; 
  vertical-align: middle; 
  text-align: center; 
    line-height:75px;;
}

#controlsDiv{
  position: absolute;
  left:0;
  top:0;
  background-color: rgba(255,0,0,0);
  height:100%;
  width:100%;
  z-index: 999999;
  animation-name: fadeAwayBackground;
  animation-iteration-count: 1;
  animation-timing-function: ease-out;
  animation-duration: 2s;
}
#controlsDivTitle{
  position: absolute;
  font-size: 60px;
  text-align: center;
  top:0px;
  line-height: 1000px;
  height: 100%;
  width: 100%;
  z-index: 99999;
  animation-name: fadeAway;
  animation-iteration-count: 1;
  animation-timing-function: ease-out;
  animation-duration: 2s;
  color:rgba(255,255,255,0);
}

#controlsDivButtonPause{
  position: absolute;
  top:0px;
  background-color: rgba(255,0,0,0);
  height:100px;
  width:100%;
  z-index: 99999;
  border:5px solid rgba(255,255,255,0);
  color:rgba(255,255,255,0);
  font-size: 30px;
  line-height: 100px;
  text-align: center;
  transition: color .25s ease-in-out;
  animation-name: fadeAway;
  animation-iteration-count: 1;
  animation-timing-function: ease-out;
  animation-duration: 2s;
}

.controlsDivButton{
  position: absolute;
  top:100px;
  background-color: rgba(255,0,0,0);
  height:100%;
  width:16.666%;
  z-index: 999999;
  border:5px solid rgba(255,255,255,.1);
  color:rgba(255,255,255,0);
  font-size: 30px;
  line-height: 100%;
  text-align: center;
  transition: color .25s ease-in-out;
  animation-name: fadeAway;
  animation-iteration-count: 1;
  animation-timing-function: ease-out;
  animation-duration: 2s;
}

.controlsDivButton:hover{
  animation-name: fadeAway;
  animation-iteration-count: 1;
  animation-timing-function: ease-out;
  animation-duration: 2s;
}


@keyframes fadeAway {
    0% {
      color:rgba(255,255,255,.5);
      border:5px solid rgba(255,255,255,.5);
    }
    100% {
      color:rgba(255,255,255,0);
      border:5px solid rgba(255,255,255,.1);
    }
}

@keyframes fadeAwayBackground {
    0% {
      background-color:rgba(0,0,0,.5);
    }
    100% {
      background-color:rgba(0,0,0,0);
    }
}

#vseelLogo{
  position: absolute;
  top:300px;
  font-size: 500%;
  text-align:center;
  width:100%;
  opacity: 1;
}


</code></pre>
</div>

<div class="header">/code/css/monitor.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">


#monitorTable{
  position:absolute;
  left: 25px;
  top:0px;
  width:1250px;
}


#taskTable{
  position:absolute;
  left: 975;
  top:275px;
  width:275px;
}



#monitorTable td,th{
    height: 50px;
    vertical-align: middle;
    text-align: center;
    padding: 15px;
}

#taskTable td,th{
    height: 50px;
    vertical-align: middle;
    padding: 15px;
}

#monitorTable th{
    font-weight: bold;
  background-color:rgba(0,0,255,.2);
  border-bottom: 1px solid black;
}

#monitorTable tr:nth-child(2n+1) {background: rgba(0,255,0,.05)}
#monitorTable tr:nth-child(2n+2) {background: rgba(0,0,255,.05)}
#monitorTable tr:nth-child(2n+1):hover {background: rgba(0,255,0,.2)}
#monitorTable tr:nth-child(2n+2):hover {background: rgba(0,0,255,.2)}
#monitorTable tr:nth-child(1):hover {background: rgba(0,0,255,0)}


#acceptingButton{
  top:0px;
}



#loadInstructionsButton{
  top:60px;
}


#instructionsContainer{
  background-color:var(--w3-red);
  position:absolute;
  right: 25px;
  top:135px;
  width:275px;
  height:50px;
  line-height: 50px;
  text-align: center;
  border:1px solid black;
}


.instructionsControlButton{
    box-sizing: border-box;

}

.instructionsControlButton:hover{
color:green;}

#instructionsRestartButton{
  position:absolute;
  left: 0px;
  top:0px;
  width:75px;
  height:50px;
  line-height: 50px;
  text-align: center;
}



#instructionsPlayButton{
  position:absolute;
  left: 100px;
  top:0px;
  width:75px;
  height:50px;
  line-height: 50px;
  text-align: center;
}

#instructionsEndButton{
  position:absolute;
  left: 200px;
  top:0px;
  width:75px;
  height:50px;
  line-height: 50px;
  text-align: center;
}


#instructionsTime{
  background-color: green;
  position:absolute;
  left: 0px;
  top:0px;
  width:0px;
  height:5px;
  line-height: 50px;
  text-align: center;
  z-index: 1;
}

#monitorTableCaptionsRow{
  height:100px;
  font-size: 28px;
}

#monitorTableCaptionsRowEntry{
  text-align: center; 
  height:100px;
}

#instructionsStatusBar{
  background-color:rgba(255,0,0,.1);
  position:absolute;
  left: 0px;
  top:50px;
  width:0px;
  height:100px;
  border-right:2px solid red;
}

.taskButton{
  background-color:var(--w3-red);
  position:absolute;
  right: 25px;
  top:0px;
  width:275px;
  height:50px;
  line-height: 50px;
  font-size: 20px;
  text-align: center;
  color: white;
/*  border:1px solid black;
*/}


.alwaysThere{
  background-color:var(--w3-lightblue);
}



#monitorHeader{
  position: absolute;
  z-index: 10;
  min-width: 1600px;
  width: 100%;
  height: 75px;
  top:0px;
  background-color: var(--w3-red);
}


#monitorHeaderRight{
  position: absolute;
  z-index: 11;
  height: 75px;
  background-color: var(--w3-lightblue);
  left: 50%;
  top:0px;
  width:600px;
}


@media (max-width: 1600px) {
  #monitorHeaderRight{
    left: 800px;
    width:600px;
}


</code></pre>
</div>

<div class="header">/code/css/prism/prism.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">/* PrismJS 1.14.0
http://prismjs.com/download.html#themes=prism-coy&languages=markup+css+clike+javascript+bash+latex+python&plugins=line-numbers+toolbar+command-line+copy-to-clipboard */
/**
 * prism.js Coy theme for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/tshedor/workshop-wp-theme (Example: http://workshop.kansan.com/category/sessions/basics or http://workshop.timshedor.com/category/sessions/basics);
 * @author Tim  Shedor
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 2;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	position: relative;
	margin: .5em 0;
	overflow: visible;
	padding: 0;
}
pre[class*="language-"]>code {
	position: relative;
	border-left: 3px solid #358ccb;
	box-shadow: -1px 0px 0px 0px #358ccb, 0px 0px 0px 1px #dfdfdf;
	background-color: #fdfdfd;
	background-image: linear-gradient(transparent 50%, rgba(69, 142, 209, 0.04) 50%);
	background-size: 3em 3em;
	background-origin: content-box;
	background-attachment: local;
}

code[class*="language"] {
	max-height: inherit;
	height: inherit;
	padding: 0 1em;
	display: block;
	overflow: auto;
}

/* Margin bottom to accomodate shadow */
:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background-color: #fdfdfd;
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
	margin-bottom: 1em;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	position: relative;
	padding: .2em;
	border-radius: 0.3em;
	color: #c92c2c;
	border: 1px solid rgba(0, 0, 0, 0.1);
	display: inline;
	white-space: normal;
}

pre[class*="language-"]:before,
pre[class*="language-"]:after {
	content: '';
	z-index: -2;
	display: block;
	position: absolute;
	bottom: 0.75em;
	left: 0.18em;
	width: 40%;
	height: 20%;
	max-height: 13em;
	box-shadow: 0px 13px 8px #979797;
	-webkit-transform: rotate(-2deg);
	-moz-transform: rotate(-2deg);
	-ms-transform: rotate(-2deg);
	-o-transform: rotate(-2deg);
	transform: rotate(-2deg);
}

:not(pre) > code[class*="language-"]:after,
pre[class*="language-"]:after {
	right: 0.75em;
	left: auto;
	-webkit-transform: rotate(2deg);
	-moz-transform: rotate(2deg);
	-ms-transform: rotate(2deg);
	-o-transform: rotate(2deg);
	transform: rotate(2deg);
}

.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #7D8B99;
}

.token.punctuation {
	color: #5F6364;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.function-name,
.token.constant,
.token.symbol,
.token.deleted {
	color: #c92c2c;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.function,
.token.builtin,
.token.inserted {
	color: #2f9c0a;
}

.token.operator,
.token.entity,
.token.url,
.token.variable {
	color: #a67f59;
	background: rgba(255, 255, 255, 0.5);
}

.token.atrule,
.token.attr-value,
.token.keyword,
.token.class-name {
	color: #1990b8;
}

.token.regex,
.token.important {
	color: #e90;
}

.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: rgba(255, 255, 255, 0.5);
}

.token.important {
	font-weight: normal;
}

.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

.namespace {
	opacity: .7;
}

@media screen and (max-width: 767px) {
	pre[class*="language-"]:before,
	pre[class*="language-"]:after {
		bottom: 14px;
		box-shadow: none;
	}

}

/* Plugin styles */
.token.tab:not(:empty):before,
.token.cr:before,
.token.lf:before {
	color: #e0d7d1;
}

/* Plugin styles: Line Numbers */
pre[class*="language-"].line-numbers {
	padding-left: 0;
}

pre[class*="language-"].line-numbers code {
	padding-left: 3.8em;
}

pre[class*="language-"].line-numbers .line-numbers-rows {
	left: 0;
}

/* Plugin styles: Line Highlight */
pre[class*="language-"][data-line] {
	padding-top: 0;
	padding-bottom: 0;
	padding-left: 0;
}
pre[data-line] code {
	position: relative;
	padding-left: 4em;
}
pre .line-highlight {
	margin-top: 0;
}

pre.line-numbers {
	position: relative;
	padding-left: 3.8em;
	counter-reset: linenumber;
}

pre.line-numbers > code {
	position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
	position: absolute;
	pointer-events: none;
	top: 0;
	font-size: 100%;
	left: -3.8em;
	width: 3em; /* works for line-numbers below 1000 lines */
	letter-spacing: -1px;
	border-right: 1px solid #999;

	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;

}

	.line-numbers-rows > span {
		pointer-events: none;
		display: block;
		counter-increment: linenumber;
	}

		.line-numbers-rows > span:before {
			content: counter(linenumber);
			color: #999;
			display: block;
			padding-right: 0.8em;
			text-align: right;
		}
div.code-toolbar {
	position: relative;
}

div.code-toolbar > .toolbar {
	position: absolute;
	top: .3em;
	right: .2em;
	transition: opacity 0.3s ease-in-out;
	opacity: 0;
}

div.code-toolbar:hover > .toolbar {
	opacity: 1;
}

div.code-toolbar > .toolbar .toolbar-item {
	display: inline-block;
}

div.code-toolbar > .toolbar a {
	cursor: pointer;
}

div.code-toolbar > .toolbar button {
	background: none;
	border: 0;
	color: inherit;
	font: inherit;
	line-height: normal;
	overflow: visible;
	padding: 0;
	-webkit-user-select: none; /* for button */
	-moz-user-select: none;
	-ms-user-select: none;
}

div.code-toolbar > .toolbar a,
div.code-toolbar > .toolbar button,
div.code-toolbar > .toolbar span {
	color: #bbb;
	font-size: .8em;
	padding: 0 .5em;
	background: #f5f2f0;
	background: rgba(224, 224, 224, 0.2);
	box-shadow: 0 2px 0 0 rgba(0,0,0,0.2);
	border-radius: .5em;
}

div.code-toolbar > .toolbar a:hover,
div.code-toolbar > .toolbar a:focus,
div.code-toolbar > .toolbar button:hover,
div.code-toolbar > .toolbar button:focus,
div.code-toolbar > .toolbar span:hover,
div.code-toolbar > .toolbar span:focus {
	color: inherit;
	text-decoration: none;
}

.command-line-prompt {
	border-right: 1px solid #999;
	display: block;
	float: left;
	font-size: 100%;
	letter-spacing: -1px;
	margin-right: 1em;
	pointer-events: none;

	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}

.command-line-prompt > span:before {
	color: #999;
	content: ' ';
	display: block;
	padding-right: 0.8em;
}

.command-line-prompt > span[data-user]:before {
	content: "[" attr(data-user) "@" attr(data-host) "] $";
}

.command-line-prompt > span[data-user="root"]:before {
	content: "[" attr(data-user) "@" attr(data-host) "] #";
}

.command-line-prompt > span[data-prompt]:before {
	content: attr(data-prompt);
}


</code></pre>
</div>

<div class="header">/code/css/prism/prism.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">/* PrismJS 1.14.0
http://prismjs.com/download.html#themes=prism-coy&languages=markup+css+clike+javascript+bash+latex+python&plugins=line-numbers+toolbar+command-line+copy-to-clipboard */
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-([\w-]+)\b/i,t=0,n=_self.Prism={manual:_self.Prism&&_self.Prism.manual,disableWorkerMessageHandler:_self.Prism&&_self.Prism.disableWorkerMessageHandler,util:{encode:function(e){return e instanceof r?new r(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/&lt;/g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e,t){var r=n.util.type(e);switch(t=t||{},r){case"Object":if(t[n.util.objId(e)])return t[n.util.objId(e)];var a={};t[n.util.objId(e)]=a;for(var l in e)e.hasOwnProperty(l)&&(a[l]=n.util.clone(e[l],t));return a;case"Array":if(t[n.util.objId(e)])return t[n.util.objId(e)];var a=[];return t[n.util.objId(e)]=a,e.forEach(function(e,r){a[r]=n.util.clone(e,t)}),a}return e}},languages:{extend:function(e,t){var r=n.util.clone(n.languages[e]);for(var a in t)r[a]=t[a];return r},insertBefore:function(e,t,r,a){a=a||n.languages;var l=a[e];if(2==arguments.length){r=arguments[1];for(var i in r)r.hasOwnProperty(i)&&(l[i]=r[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===a[e]&&t!=e&&(this[t]=o)}),a[e]=o},DFS:function(e,t,r,a){a=a||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],r||l),"Object"!==n.util.type(e[l])||a[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||a[n.util.objId(e[l])]||(a[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,a)):(a[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,a)))}},plugins:{},highlightAll:function(e,t){n.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,r){var a={callback:r,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var l,i=a.elements||e.querySelectorAll(a.selector),o=0;l=i[o++];)n.highlightElement(l,t===!0,a.callback)},highlightElement:function(t,r,a){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1].toLowerCase(),i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,t.parentNode&&(o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l));var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(n.hooks.run("before-highlight",u),u.element.textContent=u.code,n.hooks.run("after-highlight",u)),n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),r&&_self.Worker){var g=new Worker(n.filename);g.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,a&&a.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},g.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,a&&a.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,a){var l={code:e,grammar:t,language:a};return n.hooks.run("before-tokenize",l),l.tokens=n.tokenize(l.code,l.grammar),n.hooks.run("after-tokenize",l),r.stringify(n.util.encode(l.tokens),l.language)},matchGrammar:function(e,t,r,a,l,i,o){var s=n.Token;for(var u in r)if(r.hasOwnProperty(u)&&r[u]){if(u==o)return;var g=r[u];g="Array"===n.util.type(g)?g:[g];for(var c=0;c&lt;g.length;++c){var h=g[c],f=h.inside,d=!!h.lookbehind,m=!!h.greedy,p=0,y=h.alias;if(m&&!h.pattern.global){var v=h.pattern.toString().match(/[imuy]*$/)[0];h.pattern=RegExp(h.pattern.source,v+"g")}h=h.pattern||h;for(var b=a,k=l;b&lt;t.length;k+=t[b].length,++b){var w=t[b];if(t.length>e.length)return;if(!(w instanceof s)){if(m&&b!=t.length-1){h.lastIndex=k;var _=h.exec(e);if(!_)break;for(var j=_.index+(d?_[1].length:0),P=_.index+_[0].length,A=b,x=k,O=t.length;O>A&&(P>x||!t[A].type&&!t[A-1].greedy);++A)x+=t[A].length,j>=x&&(++b,k=x);if(t[b]instanceof s)continue;I=A-b,w=e.slice(k,x),_.index-=k}else{h.lastIndex=0;var _=h.exec(w),I=1}if(_){d&&(p=_[1]?_[1].length:0);var j=_.index+p,_=_[0].slice(p),P=j+_.length,N=w.slice(0,j),S=w.slice(P),C=[b,I];N&&(++b,k+=N.length,C.push(N));var E=new s(u,f?n.tokenize(_,f):_,y,_,m);if(C.push(E),S&&C.push(S),Array.prototype.splice.apply(t,C),1!=I&&n.matchGrammar(e,t,r,b,k,!0,u),i)break}else if(i)break}}}}},tokenize:function(e,t){var r=[e],a=t.rest;if(a){for(var l in a)t[l]=a[l];delete t.rest}return n.matchGrammar(e,r,t,0,0,!1),r},hooks:{all:{},add:function(e,t){var r=n.hooks.all;r[e]=r[e]||[],r[e].push(t)},run:function(e,t){var r=n.hooks.all[e];if(r&&r.length)for(var a,l=0;a=r[l++];)a(t)}}},r=n.Token=function(e,t,n,r,a){this.type=e,this.content=t,this.alias=n,this.length=0|(r||"").length,this.greedy=!!a};if(r.stringify=function(e,t,a){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return r.stringify(n,t,e)}).join("");var l={type:e.type,content:r.stringify(e.content,t,a),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:a};if(e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o=Object.keys(l.attributes).map(function(e){return e+'="'+(l.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"&lt;"+l.tag+' class="'+l.classes.join(" ")+'"'+(o?" "+o:"")+">"+l.content+"&lt;/"+l.tag+">"},!_self.document)return _self.addEventListener?(n.disableWorkerMessageHandler||_self.addEventListener("message",function(e){var t=JSON.parse(e.data),r=t.language,a=t.code,l=t.immediateClose;_self.postMessage(n.highlight(a,n.languages[r],r)),l&&_self.close()},!1),_self.Prism):_self.Prism;var a=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return a&&(n.filename=a.src,n.manual||a.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
Prism.languages.markup={comment:/&lt;!--[\s\S]*?-->/,prolog:/&lt;\?[\s\S]+?\?>/,doctype:/&lt;!DOCTYPE[\s\S]+?>/i,cdata:/&lt;!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/&lt;\/?(?!\d)[^\s>\/=$&lt;%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^&lt;\/?[^\s>\/]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/(^|[^\\])["']/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup;
Prism.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^{}\s][^{};]*?(?=\s*\{)/,string:{pattern:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/\B!important\b/i,"function":/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.languages.css,Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;style[\s\S]*?>)[\s\S]*?(?=&lt;\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css",greedy:!0}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag));
Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(?:true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|&lt;=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,"function":/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|&lt;&lt;?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[[^\]\r\n]+]|\\.|[^\/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})\]]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i,alias:"function"},constant:/\b[A-Z][A-Z\d_]*\b/}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;script[\s\S]*?>)[\s\S]*?(?=&lt;\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript",greedy:!0}}),Prism.languages.js=Prism.languages.javascript;
!function(e){var t={variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|&lt;&lt;=?|>>=?|&lt;=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[\w#?*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^&lt;])&lt;&lt;\s*)["']?(\w+?)["']?\s*\r?\n(?:[\s\S])*?\r?\n\2/,lookbehind:!0,greedy:!0,inside:t},{pattern:/(["'])(?:\\[\s\S]|\$\([^)]+\)|`[^`]+`|(?!\1)[^\\])*\1/,greedy:!0,inside:t}],variable:t.variable,"function":{pattern:/(^|[\s;|&])(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|[\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&])(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|[\s;|&])/,lookbehind:!0},"boolean":{pattern:/(^|[\s;|&])(?:true|false)(?=$|[\s;|&])/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|&lt;&lt;&lt;?|>>|&lt;=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var a=t.variable[1].inside;a.string=e.languages.bash.string,a["function"]=e.languages.bash["function"],a.keyword=e.languages.bash.keyword,a["boolean"]=e.languages.bash["boolean"],a.operator=e.languages.bash.operator,a.punctuation=e.languages.bash.punctuation,e.languages.shell=e.languages.bash}(Prism);
!function(a){var e=/\\(?:[^a-z()[\]]|[a-z*]+)/i,n={"equation-command":{pattern:e,alias:"regex"}};a.languages.latex={comment:/%.*/m,cdata:{pattern:/(\\begin\{((?:verbatim|lstlisting)\*?)\})[\s\S]*?(?=\\end\{\2\})/,lookbehind:!0},equation:[{pattern:/\$(?:\\[\s\S]|[^\\$])*\$|\\\([\s\S]*?\\\)|\\\[[\s\S]*?\\\]/,inside:n,alias:"string"},{pattern:/(\\begin\{((?:equation|math|eqnarray|align|multline|gather)\*?)\})[\s\S]*?(?=\\end\{\2\})/,lookbehind:!0,inside:n,alias:"string"}],keyword:{pattern:/(\\(?:begin|end|ref|cite|label|usepackage|documentclass)(?:\[[^\]]+\])?\{)[^}]+(?=\})/,lookbehind:!0},url:{pattern:/(\\url\{)[^}]+(?=\})/,lookbehind:!0},headline:{pattern:/(\\(?:part|chapter|section|subsection|frametitle|subsubsection|paragraph|subparagraph|subsubparagraph|subsubsubparagraph)\*?(?:\[[^\]]+\])?\{)[^}]+(?=\}(?:\[[^\]]+\])?)/,lookbehind:!0,alias:"class-name"},"function":{pattern:e,alias:"selector"},punctuation:/[[\]{}&]/}}(Prism);
Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},"triple-quoted-string":{pattern:/("""|''')[\s\S]+?\1/,greedy:!0,alias:"string"},string:{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},"function":{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|nonlocal|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,"boolean":/\b(?:True|False|None)\b/,number:/(?:\b(?=\d)|\B(?=\.))(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|&lt;[&lt;=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/};
!function(){if("undefined"!=typeof self&&self.Prism&&self.document){var e="line-numbers",t=/\n(?!$)/g,n=function(e){var n=r(e),s=n["white-space"];if("pre-wrap"===s||"pre-line"===s){var l=e.querySelector("code"),i=e.querySelector(".line-numbers-rows"),a=e.querySelector(".line-numbers-sizer"),o=l.textContent.split(t);a||(a=document.createElement("span"),a.className="line-numbers-sizer",l.appendChild(a)),a.style.display="block",o.forEach(function(e,t){a.textContent=e||"\n";var n=a.getBoundingClientRect().height;i.children[t].style.height=n+"px"}),a.textContent="",a.style.display="none"}},r=function(e){return e?window.getComputedStyle?getComputedStyle(e):e.currentStyle||null:null};window.addEventListener("resize",function(){Array.prototype.forEach.call(document.querySelectorAll("pre."+e),n)}),Prism.hooks.add("complete",function(e){if(e.code){var r=e.element.parentNode,s=/\s*\bline-numbers\b\s*/;if(r&&/pre/i.test(r.nodeName)&&(s.test(r.className)||s.test(e.element.className))&&!e.element.querySelector(".line-numbers-rows")){s.test(e.element.className)&&(e.element.className=e.element.className.replace(s," ")),s.test(r.className)||(r.className+=" line-numbers");var l,i=e.code.match(t),a=i?i.length+1:1,o=new Array(a+1);o=o.join("&lt;span>&lt;/span>"),l=document.createElement("span"),l.setAttribute("aria-hidden","true"),l.className="line-numbers-rows",l.innerHTML=o,r.hasAttribute("data-start")&&(r.style.counterReset="linenumber "+(parseInt(r.getAttribute("data-start"),10)-1)),e.element.appendChild(l),n(r),Prism.hooks.run("line-numbers",e)}}}),Prism.hooks.add("line-numbers",function(e){e.plugins=e.plugins||{},e.plugins.lineNumbers=!0}),Prism.plugins.lineNumbers={getLine:function(t,n){if("PRE"===t.tagName&&t.classList.contains(e)){var r=t.querySelector(".line-numbers-rows"),s=parseInt(t.getAttribute("data-start"),10)||1,l=s+(r.children.length-1);s>n&&(n=s),n>l&&(n=l);var i=n-s;return r.children[i]}}}}}();
!function(){if("undefined"!=typeof self&&self.Prism&&self.document){var t=[],e={},n=function(){};Prism.plugins.toolbar={};var a=Prism.plugins.toolbar.registerButton=function(n,a){var o;o="function"==typeof a?a:function(t){var e;return"function"==typeof a.onClick?(e=document.createElement("button"),e.type="button",e.addEventListener("click",function(){a.onClick.call(this,t)})):"string"==typeof a.url?(e=document.createElement("a"),e.href=a.url):e=document.createElement("span"),e.textContent=a.text,e},t.push(e[n]=o)},o=Prism.plugins.toolbar.hook=function(a){var o=a.element.parentNode;if(o&&/pre/i.test(o.nodeName)&&!o.parentNode.classList.contains("code-toolbar")){var r=document.createElement("div");r.classList.add("code-toolbar"),o.parentNode.insertBefore(r,o),r.appendChild(o);var i=document.createElement("div");i.classList.add("toolbar"),document.body.hasAttribute("data-toolbar-order")&&(t=document.body.getAttribute("data-toolbar-order").split(",").map(function(t){return e[t]||n})),t.forEach(function(t){var e=t(a);if(e){var n=document.createElement("div");n.classList.add("toolbar-item"),n.appendChild(e),i.appendChild(n)}}),r.appendChild(i)}};a("label",function(t){var e=t.element.parentNode;if(e&&/pre/i.test(e.nodeName)&&e.hasAttribute("data-label")){var n,a,o=e.getAttribute("data-label");try{a=document.querySelector("template#"+o)}catch(r){}return a?n=a.content:(e.hasAttribute("data-url")?(n=document.createElement("a"),n.href=e.getAttribute("data-url")):n=document.createElement("span"),n.textContent=o),n}}),Prism.hooks.add("complete",o)}}();
!function(){if("undefined"!=typeof self&&self.Prism&&self.document){var e=/\s*\bcommand-line\b\s*/;Prism.hooks.add("before-highlight",function(a){if(a.vars=a.vars||{},a.vars["command-line"]=a.vars["command-line"]||{},a.vars["command-line"].complete||!a.code)return a.vars["command-line"].complete=!0,void 0;var n=a.element.parentNode;if(!n||!/pre/i.test(n.nodeName)||!e.test(n.className)&&!e.test(a.element.className))return a.vars["command-line"].complete=!0,void 0;if(a.element.querySelector(".command-line-prompt"))return a.vars["command-line"].complete=!0,void 0;var t=a.code.split("\n");a.vars["command-line"].numberOfLines=t.length,a.vars["command-line"].outputLines=[];var r=n.getAttribute("data-output"),s=n.getAttribute("data-filter-output");if(r||""===r){r=r.split(",");for(var o=0;o&lt;r.length;o++){var m=r[o].split("-"),i=parseInt(m[0],10),l=2===m.length?parseInt(m[1],10):i;if(!isNaN(i)&&!isNaN(l)){1>i&&(i=1),l>t.length&&(l=t.length),i--,l--;for(var d=i;l>=d;d++)a.vars["command-line"].outputLines[d]=t[d],t[d]=""}}}else if(s)for(var o=0;o&lt;t.length;o++)0===t[o].indexOf(s)&&(a.vars["command-line"].outputLines[o]=t[o].slice(s.length),t[o]="");a.code=t.join("\n")}),Prism.hooks.add("before-insert",function(e){if(e.vars=e.vars||{},e.vars["command-line"]=e.vars["command-line"]||{},!e.vars["command-line"].complete){for(var a=e.highlightedCode.split("\n"),n=0;n&lt;e.vars["command-line"].outputLines.length;n++)e.vars["command-line"].outputLines.hasOwnProperty(n)&&(a[n]=e.vars["command-line"].outputLines[n]);e.highlightedCode=a.join("\n")}}),Prism.hooks.add("complete",function(a){if(a.vars=a.vars||{},a.vars["command-line"]=a.vars["command-line"]||{},!a.vars["command-line"].complete){var n=a.element.parentNode;e.test(a.element.className)&&(a.element.className=a.element.className.replace(e," ")),e.test(n.className)||(n.className+=" command-line");var t=function(e,a){return(n.getAttribute(e)||a).replace(/"/g,"&quot")},r=new Array(a.vars["command-line"].numberOfLines+1),s=t("data-prompt","");if(""!==s)r=r.join('&lt;span data-prompt="'+s+'">&lt;/span>');else{var o=t("data-user","user"),m=t("data-host","localhost");r=r.join('&lt;span data-user="'+o+'" data-host="'+m+'">&lt;/span>')}var i=document.createElement("span");i.className="command-line-prompt",i.innerHTML=r;for(var l=0;l&lt;a.vars["command-line"].outputLines.length;l++)if(a.vars["command-line"].outputLines.hasOwnProperty(l)){var d=i.children[l];d.removeAttribute("data-user"),d.removeAttribute("data-host"),d.removeAttribute("data-prompt")}a.element.insertBefore(i,a.element.firstChild),a.vars["command-line"].complete=!0}})}}();
!function(){if("undefined"!=typeof self&&self.Prism&&self.document){if(!Prism.plugins.toolbar)return console.warn("Copy to Clipboard plugin loaded before Toolbar plugin."),void 0;var o=window.ClipboardJS||void 0;o||"function"!=typeof require||(o=require("clipboard"));var e=[];if(!o){var t=document.createElement("script"),n=document.querySelector("head");t.onload=function(){if(o=window.ClipboardJS)for(;e.length;)e.pop()()},t.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js",n.appendChild(t)}Prism.plugins.toolbar.registerButton("copy-to-clipboard",function(t){function n(){var e=new o(i,{text:function(){return t.code}});e.on("success",function(){i.textContent="Copied!",r()}),e.on("error",function(){i.textContent="Press Ctrl+C to copy",r()})}function r(){setTimeout(function(){i.textContent="Copy"},5e3)}var i=document.createElement("a");return i.textContent="Copy",o?n():e.push(n),i})}}();

</code></pre>
</div>

<div class="header">/code/html/client.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import imp

def getPage(config):
    pf = imp.load_source('pf', config['webServerRoot']+config['packageFolder']+"/html/pageFunctions.py")
    files=pf.getFiles(config)
    this=''
    this+='&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Traditional//EN">\n'
    this+='&lt;html id="everything">\n'
    this+='\t&lt;head>\n'
    this+='\t\t&lt;title>STEEP: Client&lt;/title>\n'
    this+=pf.addExternalFiles(config,"headStart")
    this+=pf.javascriptLine(files['common']['jquery.js'])
    this+=pf.javascriptLine(files['common']['velocity.js'])
    this+=pf.javascriptLine(files["exp"]['config.js'])
    this+=pf.javascriptLine(files['common']['common.js'])
    this+=pf.javascriptLine(files['common']['websocketConnect.js'])
    this+=pf.cssLine(files['common']['instructions.css'])
    this+=pf.cssLine(files['common']['common.css'])
    this+=pf.cssLine(files['common']['simulateMouse.css'])
    this+=pf.addPluginFiles(config,"css")
    this+=pf.cssLine(files['exp']['experiment.css'])
    this+=pf.addExternalFiles(config,"headEnd")
    this+='\t&lt;/head>\n'
    this+='\t&lt;body>\n'
    this+=pf.addExternalFiles(config,"bodyStart")
    this+=pf.javascriptLine(files['common']['simulateMouse.js'])
    this+=pf.javascriptLine(files['common']['video.js'])
    this+=pf.addPluginFiles(config,"js")
    this+=pf.javascriptLine(files['common']['instructions.js'])
    this+=pf.javascriptLine(files['exp']['experiment.js'])
    this+=pf.addExternalFiles(config,"bodyEnd")
    this+='\t&lt;/body>\n'
    this+='&lt;/html>'
    return this
</code></pre>
</div>

<div class="header">/code/html/instructions.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import imp

def getPage(config):
    pf = imp.load_source('pf', config['webServerRoot']+config['packageFolder']+"/html/pageFunctions.py")
    files=pf.getFiles(config)
    this=''
    this+='&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Traditional//EN">\n'
    this+='&lt;html id="everything">\n'
    this+='\t&lt;head>\n'
    this+=pf.addExternalFiles(config,"headStart")
    this+=pf.javascriptLine(files['common']['jquery.js'])
    this+=pf.javascriptLine(files["exp"]['config.js'])
    this+=pf.javascriptLine(files['common']['common.js'])
    this+=pf.cssLine(files['common']['instructions.css'])
    this+=pf.cssLine(files['common']['common.css'])
    this+=pf.cssLine(files['common']['simulateMouse.css'])
    this+=pf.addPluginFiles(config,"css")
    this+=pf.cssLine(files['exp']['experiment.css'])
    this+=pf.addExternalFiles(config,"headEnd")
    this+='\t&lt;/head>\n'
    this+='\t&lt;body>\n'
    this+=pf.addExternalFiles(config,"bodyStart")
    this+=pf.javascriptLine(files['common']['simulateMouse.js'])
    this+=pf.javascriptLine(files['common']['video.js'])
    this+=pf.addPluginFiles(config,"js")
    this+=pf.javascriptLine(files['exp']['experiment.js'])
    this+=pf.javascriptLine(files['common']['instructions.js'])
    this+=pf.javascriptLine(files['exp']['instructions.js'])
    this+=pf.addExternalFiles(config,"bodyEnd")
    this+='\t&lt;/body>\n'
    this+='&lt;/html>'

    return this
</code></pre>
</div>

<div class="header">/code/html/monitor.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import imp
import sys
import netifaces as ni


def getPage(config):
  pf = imp.load_source('pf', config['webServerRoot']+config['packageFolder']+"/html/pageFunctions.py")
  thisVersion=sys.version.split("\n")[0]
  thisVersion=thisVersion.replace("\"","'")
  string=""
  string+="\n\nwindow.pythonVersion=\"%s\";\n"%(thisVersion)
  string+="window.pythonExecutable=\"%s\";\n"%(sys.executable)
  ips=[]
  for k in ni.interfaces():
    ni.ifaddresses(k)
    try:  
      ip = ni.ifaddresses(k)[2][0]['addr']
      ips.append(["%s"%(k),"%s"%(ip)])
    except Exception as e: 
      # print("error getting ips",str(e))
      "no address"

  ips=[[str(y.encode("utf-8")) for y in x] for x in ips]
  string+="window.ipAddresses=%s;\n"%(ips)
  files=pf.getFiles(config)
  this=''
  this+='&lt;html>\n'
  this+='\t&lt;head>\n'
  this+='\t\t&lt;title>STEEP: Monitor&lt;/title>\n'
  this+=pf.addExternalFiles(config,"headStart")
  this+=pf.javascriptLine(files['common']['jquery.js'])
  this+=pf.javascriptLine(files["exp"]['config.js'])
  this+=pf.javascriptLine(files['common']['common.js'])
  this+=pf.javascriptLine(files['common']['websocketConnect.js'])
  this+=pf.cssLine(files['common']['monitor.css'])
  this+=pf.cssLine(files['common']['common.css'])
  this+=pf.addExternalFiles(config,"headEnd")
  this+='\t&lt;/head>\n'
  this+='\t&lt;body>\n'
  this+=pf.addExternalFiles(config,"bodyStart")
  this+='\t\t&lt;div id="mainDiv">&lt;/div>\n'
  this+='\t\t\t&lt;script type="text/javascript">%s;&lt;/script>\n'%(string)
  this+=pf.javascriptLine(files['common']['monitor.js'])
  this+=pf.addExternalFiles(config,"bodyEnd")
  this+='\t&lt;/body>\n'
  this+='&lt;/html>'

  return this
</code></pre>
</div>

<div class="header">/code/html/pageFunctions.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import random


def addExternalFiles(config,location):
    #location is either "headStart" or "headEnd" "bodyStart" "bodyEnd"
    string=""
    if "additionalFiles" in config:
        for fileDetails in config["additionalFiles"]:
            fileLocation=fileDetails[2]
            fileType=fileDetails[1]
            filePath=fileDetails[0]
            extension=filePath.split(".")[-1]
            if fileLocation==location:
                if fileType=="full":
                    if extension=="js":
                        string+=javascriptLine(fileDetails[0])
                    elif extension=="css":
                        string+=cssLine(fileDetails[0])
                elif fileType=="relative":
                    domain=config['domain']
                    currentExperiment=config['currentExperiment']
                    experimentURL=domain+currentExperiment
                    relativeURL=experimentURL+"files/"+fileDetails[0]
                    if extension=="js":
                        string+=javascriptLine(relativeURL)
                    if extension=="css":
                        string+=cssLine(relativeURL)
    return string


    this+=pf.addPluginFiles(config,"js")

def addPluginFiles(config,extension):
    string=""
    if "plugins" in config:
        for plugin in config["plugins"]:
            path=plugin[0]
            pathLocation=plugin[1]
            if pathLocation=="relative":
                domain=config['domain']
                currentExperiment=config['currentExperiment']
                experimentURL=domain+currentExperiment
                url=experimentURL+"files/"+path
            elif pathLocation=="absolute":
                path="/"+path.replace(config['webServerRoot'],"")
                domain=config['domain']
                # currentExperiment=config['currentExperiment']
                # experimentURL=domain+currentExperiment
                url=domain+path
            if extension=="js":
                string=javascriptLine(url.replace(".py",".js"))+string
            elif extension=="css":
                string=cssLine(url.replace(".py",".css"))+string
    return string




def javascriptLine(url):
 return '\t\t&lt;script type="text/javascript" src="%s">&lt;/script>\n'%(url)

def cssLine(url):
  return '\t\t&lt;link rel="stylesheet" type="text/css" href="%s">\n'%(url)

def getFiles(config):
    packageFolder=config['packageFolder']
    currentExperiment=config['currentExperiment']
    domain=config['domain']
    packageURL=domain+packageFolder
    experimentURL=domain+currentExperiment

    files={}
    files['common']={}

    files['common']['jquery.js']=packageURL+"javascript/jquery-1.11.3.min.js"
    files['common']['velocity.js']=packageURL+"javascript/velocity.min.js"
    files['common']['common.js']=packageURL+"javascript/common.js"
    files['common']['websocketConnect.js']=packageURL+"javascript/websocketConnect.js"
    files['common']['video.js']=packageURL+"javascript/video.js"
    files['common']['instructions.js']=packageURL+"javascript/instructions.js"
    files['common']['monitor.js']=packageURL+"javascript/monitor.js"

    files['common']['simulateMouse.css']=packageURL+"javascript/simulateMouse/simulateMouse.css"
    files['common']['simulateMouse.js']=packageURL+"javascript/simulateMouse/simulateMouse.js"

    files['common']['instructions.css']=packageURL+"css/instructions.css"
    files['common']['common.css']=packageURL+"css/common.css"
    files['common']['monitor.css']=packageURL+"css/monitor.css"

    files["exp"]={}
    files["exp"]['config.js']=config["configJsURL"]
    files["exp"]['experiment.css']=experimentURL+"files/experiment.css"
    files["exp"]['experiment.js']=experimentURL+"files/experiment.js"
    files["exp"]['tester.js']=experimentURL+"files/tester.js"

    if "instructionsFolder" in config:
        instructionsFolder=experimentURL+config['instructionsFolder']
        files["exp"]['instructions.js']=instructionsFolder+"instructions.js"


    #this ensures that we won't use cached versions of these js and css files.  
    for k in files:
        for j in files[k]:
            files[k][j]=files[k][j]+"?r=%s"%(str(random.random()).replace(".",""))

    return files

</code></pre>
</div>

<div class="header">/code/html/tester.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import imp

def getPage(config):
    pf = imp.load_source('pf', config['webServerRoot']+config['packageFolder']+"/html/pageFunctions.py")
    files=pf.getFiles(config)
    this=''
    this+='&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Traditional//EN">\n'
    this+='&lt;html id="everything">\n'
    this+='\t&lt;head>\n'
    this+='\t\t&lt;title>STEEP: Tester&lt;/title>\n'
    this+=pf.addExternalFiles(config,"headStart")
    this+=pf.javascriptLine(files['common']['jquery.js'])
    this+=pf.javascriptLine(files['common']['velocity.js'])
    this+=pf.javascriptLine(files["exp"]['config.js'])
    this+=pf.javascriptLine(files['common']['common.js'])
    this+=pf.javascriptLine(files['common']['websocketConnect.js'])
    this+=pf.cssLine(files['common']['instructions.css'])
    this+=pf.cssLine(files['common']['common.css'])
    this+=pf.cssLine(files['common']['questionnaire.css'])
    this+=pf.cssLine(files['common']['simulateMouse.css'])
    this+=pf.addPluginFiles(config,"css")
    this+=pf.cssLine(files['exp']['experiment.css'])
    this+=pf.addExternalFiles(config,"headEnd")
    this+='\t&lt;/head>\n'
    this+='\t&lt;body>\n'
    this+=pf.addExternalFiles(config,"bodyStart")
    this+=pf.javascriptLine(files['common']['simulateMouse.js'])
    this+=pf.javascriptLine(files['common']['video.js'])
    this+=pf.addPluginFiles(config,"js")
    this+=pf.javascriptLine(files['exp']['experiment.js'])
    this+=pf.javascriptLine(files['common']['instructions.js'])
    this+=pf.javascriptLine(files['common']['questionnaire.js'])
    this+=pf.javascriptLine(files['exp']['tester.js'])
    instructions=False
    if "instructionsFolder" in config:
        instructions=True
    if instructions==True:
        this+=pf.javascriptLine(files['exp']['instructions.js'])
    this+=pf.addExternalFiles(config,"bodyEnd")
    this+='\t&lt;/body>\n'
    this+='&lt;/html>'
    return this
</code></pre>
</div>

<div class="header">/code/html/video.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#!/usr/bin/python
import imp

def getPage(config):
    pf = imp.load_source('pf', config['webServerRoot']+config['packageFolder']+"/html/pageFunctions.py")
    files=pf.getFiles(config)
    this=''
    this+='&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Traditional//EN">\n'
    this+='&lt;html id="everything">\n'
    this+='\t&lt;head>\n'
    this+='\t\t&lt;title>STEEP: Client&lt;/title>\n'
    this+=pf.addExternalFiles(config,"headStart")
    this+=pf.javascriptLine(files['common']['jquery.js'])
    this+=pf.javascriptLine(files['common']['velocity.js'])
    this+=pf.javascriptLine(files["exp"]['config.js'])
    this+=pf.javascriptLine(files['common']['common.js'])
    this+=pf.javascriptLine(files['common']['websocketConnect.js'])
    this+=pf.cssLine(files['common']['instructions.css'])
    this+=pf.cssLine(files['common']['common.css'])
    this+=pf.cssLine(files['common']['simulateMouse.css'])
    this+=pf.addPluginFiles(config,"css")
    this+=pf.cssLine(files['exp']['experiment.css'])
    this+=pf.addExternalFiles(config,"headEnd")
    this+='\t&lt;/head>\n'
    this+='\t&lt;body>\n'
    this+=pf.addExternalFiles(config,"bodyStart")
    this+=pf.javascriptLine(files['common']['simulateMouse.js'])
    this+=pf.javascriptLine(files['common']['video.js'])
    this+=pf.addPluginFiles(config,"js")
    this+=pf.javascriptLine(files['exp']['experiment.js'])
    this+=pf.javascriptLine(files['common']['instructions.js'])
    this+=pf.addExternalFiles(config,"bodyEnd")
    this+='\t&lt;/body>\n'
    this+='&lt;/html>'
    return this
</code></pre>
</div>

<div class="header">/code/javascript/common.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">var partial = function (func /*, 0..n args */) {
    var args = Array.prototype.slice.call(arguments, 1);
    return function () {
        var allArguments = args.concat(Array.prototype.slice.call(arguments));
        return func.apply(this, allArguments);
    };
};


function runServerFunction(args){
    var message={"type":args[0]};
    sendMessage(message);
}


function hoverDiv(divId,incoming){
    var oldStyle=[]
    for(k in incoming){
        if(incoming[k]!=undefined){
            oldStyle[k]=document.getElementById(divId).style[k];
        }
        else{
            oldStyle[k]="";
        }
    }
    document.getElementById(divId).addEventListener("mouseover", function(){
        for(k in incoming){
            document.getElementById(divId).style[k]=incoming[k];
        }
    });
    document.getElementById(divId).addEventListener("mouseout", function(){
        for(k in incoming){
            document.getElementById(divId).style[k]=oldStyle[k];
        }
    });
}


function hoverDivChangeOtherDiv(divIdHover,divIdChange,incoming){
    var oldStyle=[]
    for(k in incoming){
        if(incoming[k]!=undefined){
            oldStyle[k]=document.getElementById(divIdChange).style[k];
        }
        else{
            oldStyle[k]="";
        }
    }
    document.getElementById(divIdHover).addEventListener("mouseover", function(){
        for(k in incoming){
            document.getElementById(divIdChange).style[k]=incoming[k];
        }
    });
    document.getElementById(divIdHover).addEventListener("mouseout", function(){
        for(k in incoming){
            document.getElementById(divIdChange).style[k]=oldStyle[k];
        }
    });
}


//clickButton("many","makeChoiceButton",makeChoiceButtonClicked,27);
function clickButton(buttonType, divID, func) {
  var args = Array.prototype.slice.call(arguments,3);
  var thisDiv = document.getElementById(divID);
  thisDiv.addEventListener("click", function listener(e) {
    if (buttonType == "once") {
      thisDiv.removeEventListener("click", listener);
    }
    args.push(e)
    var functionToRun = partial(func, args);
    functionToRun(e);
  });
}

function removeAllListeners(divID){
    var thisDiv = document.getElementById(divID);
    var clone = thisDiv.cloneNode();
    while (thisDiv.firstChild) {
        clone.appendChild(thisDiv.lastChild);
    }
    thisDiv.parentNode.replaceChild(clone,thisDiv);
}



function keyNameToKeyCode(keyName){
  //http://keycode.info/
  if(keyName=="left"){var keyCode=37;}
  else if(keyName=="right"){var keyCode=39;}
  else if(keyName=="up"){var keyCode=38;}
  else if(keyName=="down"){var keyCode=40;}
  else if(keyName=="w"){var keyCode=87;}
  else if(keyName=="y"){var keyCode=89;}
  else{var keyCode=-111111;}
  return keyCode
}

window.keyDownListeners=[]
function pressKey(buttonType,key,func) {
  removePressKeyListener(key);
  var keyCode=keyNameToKeyCode(key);

  var args = Array.prototype.slice.call(arguments,3);
  var functionToRun = partial(func,args);
  var removeListener = partial(removePressKeyListener,key);
  window.keyDownListeners[key]=function(e){
    if (event.keyCode == keyCode) {
        if (buttonType=="once"){removeListener();}
        functionToRun();
    }
  }
  document.addEventListener("keyup",window.keyDownListeners[key],false);
}

function removePressKeyListener(key) {
  document.removeEventListener("keyup",window.keyDownListeners[key]);
}



function removeListeners(divID) {
    var element=document.getElementById(divID);
    var clone = element.cloneNode();
    while (element.firstChild) {
      clone.appendChild(element.lastChild);
    }
    element.parentNode.replaceChild(clone, element);
}

function refreshMyPage(){
    console.log("ref");
    window.location.reload();
}

function addParamToURL(incoming){
    insertParam(incoming['params']);
    // location.reload();
}

function getUrlParameter(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i &lt; sURLVariables.length; i++) 
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam) 
        {
            return sParameterName[1];
        }
    }
}

function insertParam(params) {
        var varNewURL=document.location.search;
        console.log(varNewURL);
        for(var k=0;k&lt;params.length;k++){
            var key = escape(params[k][0]); value = escape(params[k][1]);
            var kvp = varNewURL.substr(1).split('&');
            if (kvp == '') {
                varNewURL = '?' + key + '=' + value;
            }
            else {

                var i = kvp.length; var x; while (i--) {
                    x = kvp[i].split('=');

                    if (x[0] == key) {
                        x[1] = value;
                        kvp[i] = x.join('=');
                        break;
                    }
                }

                if (i &lt; 0) { kvp[kvp.length] = [key, value].join('='); }

                //this will reload the page, it's likely better to store this until finished
                varNewURL = kvp.join('&');
            }
        }
        //document.location.search=varNewURL
        console.log(varNewURL);
        varNewURL="?subjectID=test1&viewType=instructions";
        window.history.pushState(null,null,window.location.pathname+"?"+varNewURL);
    }



function setQueryString(incoming){
    window.history.pushState(null,null,window.location.pathname+incoming['queryString']);
}

function isDivNotThere(divIN){
    var out=true;
    if(document.getElementById(divIN)!=null){
        out=false;
    }
    return out;
}


function divExists(divIN){
    var out=true;
    if(document.getElementById(divIN)==null){
        out=false;
    }
    return out;
}

function createDiv(id){
    deleteDiv(id);
    var thisDiv = document.createElement("div");
    thisDiv.id=id;
    return thisDiv;
}

function createAndAddDiv(newDivID,parentDivID){
    thisDiv=createAndAddElement("div",newDivID,parentDivID)
    return thisDiv;
}

function createAndAddElement(elementType,newElementID,parentElementID){
    //console.log(newDivID,parentDivID);
    deleteDiv(newElementID);
    var thisElement = document.createElement(elementType);
    if(newElementID!=""){
        thisElement.id=newElementID;
    }
    document.getElementById(parentElementID).appendChild(thisElement);
    return thisElement;

}




function deleteDiv(id){
    if(document.getElementById(id)!=null){
        var element = document.getElementById(id);
        element.parentNode.removeChild(element);
    }
}

function clearAll(){
    deleteDiv("mainDiv");
    var mainDiv=createDiv("mainDiv");
    $("body").prepend(mainDiv);
}


function wakeUp(incoming){
}

function clickEvent(e) {
  // e = Mouse click event.
  var rect = e.target.getBoundingClientRect();
  var x = e.clientX - rect.left; //x position within the element.
  var y = e.clientY - rect.top;  //y position within the element.
  return [x,y]
}


function placeTextOLD(divid,text,top,fontSize,color,fadeTime){
    thisDiv=createAndAddDiv(divid,"mainDiv");
    thisDiv.innerHTML=text;
    thisDiv.style.opacity="0";
    thisDiv.style.top=top+"px";
    thisDiv.style.width="100%";
    thisDiv.style.fontSize=fontSize+"%";
    thisDiv.style.textAlign="center";
    thisDiv.style.color=color;
    thisDiv.style.position="absolute";
    setTimeout(function(){
        document.getElementById(divid).style.opacity = "1";
        document.getElementById(divid).style.transition = "opacity "+fadeTime+"s ease";
    },50);
}

function placeTextNewButStillOld(incoming){
    if(incoming['divid']==undefined){
        incoming['divid']="randomDiv"+parseInt(Math.random()*10000000000);
    }
    if(incoming['top']==undefined){
        incoming['top']="0px";
    }
    if(incoming['fontSize']==undefined){
        incoming['fontSize']="";
    }
    if(incoming['width']==undefined){
        incoming['width']="100%";
    }
    if(incoming['textAlign']==undefined){
        incoming['textAlign']="center";
    }
    if(incoming['color']==undefined){
        incoming['color']="black";
    }
    if(incoming['fadeTime']==undefined){
        incoming['fadeTime']=".01";
    }
    if(incoming['height']==undefined){
        incoming['height']="";
    }
    if(incoming['lineHeight']==undefined){
        incoming['lineHeight']=incoming['height'];
    }
    if(incoming['backgroundColor']==undefined){
        incoming['backgroundColor']="";
    }
    if(incoming['parentDiv']==undefined){
        incoming['parentDiv']="mainDiv";
    }
    if(incoming['text']==undefined){
        incoming['text']="";
    }
    if(incoming['opacity']==undefined){
        incoming['opacity']="";
    }
    if(incoming['padding']==undefined){
        incoming['padding']="";
    }
    if(incoming['paddingLeft']==undefined){
        incoming['paddingLeft']="";
    }
    if(incoming['zIndex']==undefined){
        incoming['zIndex']="";
    }

    if(incoming['userSelect']==undefined){
        incoming['userSelect']="none";//none for no selection or all for easy selection
    }
    if(incoming['className']==undefined){
        incoming['className']="";//none for no selection or all for easy selection
    }


    var textDiv=createAndAddDiv(incoming["divid"],incoming['parentDiv']);
    textDiv.className=incoming["className"];
    textDiv.innerHTML=incoming['text'];
    textDiv.style.opacity="1";
    textDiv.style.top=incoming['top'];
    textDiv.style.width=incoming['width'];
    textDiv.style.height=incoming['height'];
    textDiv.style.lineHeight=incoming['lineHeight'];
    textDiv.style.fontSize=incoming['fontSize'];
    textDiv.style.left=incoming['left'];
    textDiv.style.textAlign=incoming["textAlign"];
    textDiv.style.color=incoming["color"];
    textDiv.style.position="absolute";
    textDiv.style.opacity=incoming["opacity"];
    textDiv.style.zIndex=incoming["zIndex"];
    textDiv.style.userSelect=incoming['userSelect'];
    if(incoming['borderLeft']!=undefined){
        textDiv.style.borderLeft=incoming['borderLeft'];
    }
    if(incoming['borderRight']!=undefined){
        textDiv.style.borderRight=incoming['borderRight'];
    }
    if(incoming['borderTop']!=undefined){
        textDiv.style.borderTop=incoming['borderTop'];
    }
    if(incoming['borderBottom']!=undefined){
        textDiv.style.borderBottom=incoming['borderBottom'];
    }
    if(incoming['border']!=undefined){
        textDiv.style.border=incoming['border'];
    }
    textDiv.style.paddingLeft=incoming['paddingLeft'];
    textDiv.style.padding=incoming['padding'];
    textDiv.style.backgroundColor=incoming['backgroundColor'];
}




function placeText(incoming){
    if(incoming['divid']==undefined){
        incoming['divid']="randomDiv"+parseInt(Math.random()*10000000000);
    }
    if(incoming['parentDiv']==undefined){
        incoming['parentDiv']="mainDiv";
    }
    var textDiv=createAndAddDiv(incoming["divid"],incoming['parentDiv']);

    if(incoming['height']==undefined){
        incoming['height']="50px";
    }
    if(incoming['lineHeight']==undefined){
        incoming['lineHeight']=incoming['height'];
    }
    if(incoming['className']==undefined){
        incoming['className']="";//none for no selection or all for easy selection
    }
    if(incoming['text']==undefined){
        incoming['text']="";//none for no selection or all for easy selection
    }

    textDiv.className="placedText "+incoming["className"];
    textDiv.innerHTML=incoming['text'];

    var toNotSet=["text","className","parentDiv","divid"]
    for(var k in incoming){
        if(toNotSet.indexOf(k)==-1){
            textDiv.style[k]=incoming[k];
        }
    }
}



function makeTimePretty(timeIN){
    var m=Math.floor(timeIN/60);
    var s=Math.floor(timeIN-m*60);
    var d=(timeIN-60*m-s).toFixed(0);
    m=("0"+m).slice(-2);
    s=("0"+s).slice(-2)+d.slice(1);
    var pretty=m+":"+s;
    return pretty
}


window.timerCalls={};
function moveTimer(timerName){
    clearTimeout(window.timerCalls[timerName]);
    var timerSeconds=window.timers[timerName]-((new Date()).getTime()-window.timers['timerCheck'])/1000;
    var pf = partial(moveTimer,timerName);
    if(timerSeconds>0){
        var pretty = makeTimePretty(timerSeconds);
        if(document.getElementById(timerName)!=null){
            document.getElementById(timerName).innerHTML=pretty;
            window.timerCalls[timerName]=setTimeout(pf,100);
        }
        else{
            window.timerCalls[timerName]=setTimeout(pf,10);
        }
    }
    else{
        if(document.getElementById(timerName)!=null){
            document.getElementById(timerName).innerHTML="0:00";
        }
    }
}

function stopTimer(timerName){
    clearTimeout(window.timerCalls[timerName]);
}

function genericScreen(message){
    clearAll();
    createAndAddDiv("genericScreen","mainDiv")
    createAndAddDiv("genericScreenInside","genericScreen")
    createAndAddDiv("genericScreenText","genericScreenInside")
    document.getElementById("genericScreenText").innerHTML=message;
    placeText({"text":window.state['subjectID'],"fontSize":"20px","top":"20px","left":"20px","width":"300px","textAlign":"left"});
}


function multipleMessages(incoming){
    var messages=incoming['messages'];
    for(var messageNumber=0;messageNumber&lt;messages.length;messageNumber++){
        var thisMessage=messages[messageNumber];
        messageManager(JSON.stringify(thisMessage));
    }
}

function copyObject(obj){
    var objectOut=JSON.parse(JSON.stringify(obj));
    return objectOut
}

function combineObjects(dict1,dict2){//dict1 has priority over dict2
    let this1=copyObject(dict1);
    let this2=copyObject(dict2);
    let output={}
    for(let k in this1){
        if(!(k in this2)){
            //add to final if in this1 but no this2
            output[k]=copyObject(this1[k]);
        }
        else{//key in both
            if((typeof this1[k]=="number" || typeof this1[k]=="string" || this1[k] instanceof Array) && (typeof this2[k]=="number" || typeof this2[k]=="string" || this2[k] instanceof Array)){
                output[k]=copyObject(this1[k]);//this 1 takes priority
            }
            else if(typeof this1[k]=="object" && typeof this2[k]=="object"){
                //both objects
                output[k]=combineObjects(this1[k],this2[k]);
            } 
            else{
                console.log("the following key is mixed with objects and strings and numbers")
                console.log(k)
            }
        }
    }
    for(let k in this2){
        if(!(k in this1)){
            //add to final if in this2 but no this1
            output[k]=copyObject(this2[k])
        }
    }
    return output
}


function confirmAction(statement,message){
    placeText({"divid":"confirmationAlertBackgroud","top":"0px","left":"0px","width":"100%","height":"100%","backgroundColor":"rgba(0,0,0,.3)","zIndex":2147483648});
    placeText({"parentDiv":"confirmationAlertBackgroud","divid":"confirmationDiv","text":statement,"fontSize":"30px","lineHeight":"50px","height":"unset","padding":"50px","paddingBottom":"150px","top":"calc(25% - 150px)","left":"calc(50% - 300px)","width":"600px","backgroundColor":"rgba(255,255,255,1)","border":"5px solid black"});
    placeText({"parentDiv":"confirmationDiv","divid":"confirmationDivButtonYes","text":"Yes","fontSize":"26px","bottom":"25px","left":"100px","width":"150px","height":"75px","backgroundColor":"rgba(0,255,0,.1)","border":"5px solid rgba(0,255,0,.3)"});
    placeText({"parentDiv":"confirmationDiv","divid":"confirmationDivButtonNo","text":"No","fontSize":"26px","bottom":"25px","left":"350px","width":"150px","height":"75px","backgroundColor":"rgba(255,0,0,.1)","border":"5px solid rgba(255,0,0,.3)"});
    // placeText({"parentDiv":"confirmationDiv","divid":"confirmationDivButtonNo","text":"No","fontSize":"20px","lineHeight":"50px","padding":"50px","top":"calc(25% - 150px)","left":"calc(50% - 300px)","width":"600px","height":"300px","backgroundColor":"rgba(255,255,255,1)"});
    hoverDivChangeOtherDiv("confirmationDivButtonYes","confirmationDivButtonYes",{"border":"5px solid green","backgroundColor":"rgba(0,255,0,.3)"})
    hoverDivChangeOtherDiv("confirmationDivButtonNo","confirmationDivButtonNo",{"border":"5px solid red","backgroundColor":"rgba(255,0,0,.3)"})
    clickButton("many","confirmationDiv",confirmationActionButtonClick,message);
}

function confirmationActionButtonClick(args){
    var e=args[args.length-1];
    var message=args[0];
    if (e.target !== e.currentTarget) {
        var clickedItem = e.target.id;
        if(clickedItem=="confirmationDivButtonYes"){
            removeAllListeners("confirmationDiv");
            sendMessage(message);   
        }
        else if(clickedItem=="confirmationDivButtonNo"){
            deleteDiv("confirmationAlertBackgroud");
        }
    }
// e.stopPropagation();
}


function updateTimers(incoming){
  window.timers=incoming['timers'];
  if(window.timers==undefined){window.timers={};}
  window.timers['timerCheck']=(new Date()).getTime();
}


function messageManager(msg){
  var incoming = JSON.parse(msg);
  window.state=incoming['status'];
  updateTimers(incoming);
  //http://stackoverflow.com/questions/359788/how-to-execute-a-javascript-function-when-i-have-its-name-as-a-string
  window[incoming['type']](incoming);
}


//http://stackoverflow.com/questions/359788/how-to-execute-a-javascript-function-when-i-have-its-name-as-a-string
function runFunctionFromString(functionName){
    if(typeof(window[functionName])==="function")
    {
      window[functionName]();
      return true;
    }      
    else{
      return false;
    }
}

function statusManager(){
  thisStatus=window.state;
  if(runFunctionFromString(thisStatus["page"])==false){
      if(thisStatus[0]==-1){
        message="Loading...";
        genericScreen(message);
      }
      else if(thisStatus["page"]=="generic"){
        clearAll();
        genericScreen(thisStatus["message"]);
      }
  }
}

function updateStatus(msg) {
    statusManager();
}

mainDiv = createDiv("mainDiv");
$("body").prepend(mainDiv);


function camelCaseToRegular(string){
  string=string
    // insert a space before all caps
    .replace(/([A-Z])/g, ' $1')
    // uppercase the first character
    .replace(/^./, function(str){ return str.toUpperCase(); })
    return string
}



</code></pre>
</div>

<div class="header">/code/javascript/instructions.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">function loadInstructions(incoming){
    deleteDiv("audioHolder");
    var video = document.createElement('video');
    video.id = 'audioHolder';
    video.src = incoming['source'];
    video.playbackRate = 1;
    video.height='0px';
    video.preload='auto'
    document.body.appendChild(video);
    loadClickSound();
}


function startAudio(incoming){
    console.log("startAudio",incoming['currentTime'])
    if(incoming['playbackRate']==undefined){incoming['playbackRate']=1;}
    document.getElementById("audioHolder").playbackRate = incoming['playbackRate'];
    document.getElementById("audioHolder").currentTime = incoming['currentTime']*document.getElementById("audioHolder").playbackRate;
    document.getElementById("audioHolder").play();
}


function doNothing(){
    console.log("do Nothign");
}



function updateTimeAndAudio(incoming){
    if(incoming['elapsedTime']!=undefined){
        window.elapsed=incoming['elapsedTime'];
        window.lastCheck=(new Date()).getTime();
        document.getElementById("audioHolder").currentTime = window.elapsed*document.getElementById("audioHolder").playbackRate;
        clearTimeout(window.moveInstructionsTimer);
    }
}


function evalStringAsFunction(incoming){
    var strings=incoming['strings'];
    window.elapsed=incoming['elapsedTime'];
    window.lastCheck=(new Date()).getTime();
    document.getElementById("audioHolder").currentTime = window.elapsed*document.getElementById("audioHolder").playbackRate;
    for(var k=0;k&lt;strings.length;k++){
        eval(strings[k])();
    }
    clearTimeout(window.moveInstructionsTimer);
}


function drawInstructionsTimer(incoming){
    window.thisTimerName=incoming['whichTimer'];
    element=createAndAddDiv(window.thisTimerName,"captionOverlay");
    element.className="instructionsElapsed";
}

function drawElapsedTime(){
    element=createAndAddDiv("instructionsElapsed","mainDiv");
    element.innerHTML=makeTimePretty(window.elapsed+((new Date()).getTime()-window.lastCheck)/1000);
    window.moveInstructionsTimer=setTimeout(drawElapsedTime,100);
}



function drawCaptionOverlay(incoming){
    var captionOverlay = createAndAddDiv('captionOverlay',"mainDiv");
    var captions = createAndAddDiv('captions',"captionOverlay");
}


function setCaptions(incoming){
    var captions=document.getElementById('captions');
    captions.innerHTML=incoming['caption'];
    window.thisTimerName=incoming['whichTimer'];
    moveTimer(window.thisTimerName); 
    var currentTime=incoming['length']-window.timers[window.thisTimerName];
    if(isNaN(currentTime)){currentTime=0;}
    document.getElementById("audioHolder").currentTime = currentTime*document.getElementById("audioHolder").playbackRate;
}



function startInstructions(incoming){
    clearAllInstructions();
    window.instructionIndex=0;
    window.elapsed=incoming['time']*1000+.0000001;
    window.startTime=(new Date()).getTime()-window.elapsed;
    doInstructions();
}


function pauseInstructions(){
    document.getElementById('audioHolder').pause(); 
    stopTimer(window.thisTimerName);
}



////functions that are called from python:
function changeBackgroundColor(incoming){
    document.getElementById("mainDiv").style.backgroundColor=incoming['color'];
}

function placeTextINstructions(incoming){
    var textDiv=createAndAddDiv(incoming["divid"],"mainDiv")
    textDiv.innerHTML=incoming['text'];
    textDiv.style.opacity="0";
    textDiv.style.top=incoming['top']+"px";
    textDiv.style.width="100%";
    textDiv.style.fontSize=incoming['fontSize']+"%";
    textDiv.style.left=incoming['left']+"px";
    textDiv.style.textAlign=incoming["textAlign"];
    textDiv.style.color=incoming["color"];
    textDiv.style.position="absolute";
    setTimeout(function(){
        document.getElementById(incoming["divid"]).style.opacity = "1";
        document.getElementById(incoming["divid"]).style.transition = "opacity "+incoming["fadeTime"]+"s ease";
    },50);
}


function toggleOverlay(){
    if(document.getElementById("mainDivOverlay")!=null){
        var element = document.getElementById("mainDivOverlay");
        element.parentNode.removeChild(element);
    }
    else{
        var mainDivOverlay = document.createElement("div");
        mainDivOverlay.id = "mainDivOverlay";
        $("#mainDiv").append(mainDivOverlay);
    }
}


function clearAllInstructions(){
    var cursorDiv=document.getElementById("cursorOverlay");
    var captionOverlay=document.getElementById("captionOverlay");
    deleteDiv("mainDiv");
    var mainDiv=createDiv("mainDiv");
    $("body").prepend(mainDiv);
    $("#mainDiv").prepend(cursorDiv);
    $("#mainDiv").prepend(captionOverlay);
    var captions=document.getElementById('captions');
}


// function getQueryParameters() {
//   var queryString = location.search.slice(1),
//       params = {};

//   queryString.replace(/([^=]*)=([^&]*)&*/g, function (_, key, value) {
//     params[key] = value;
//   });

//   return params;
// }


// function setQueryParameters(params) {
//   var query = [],
//       key, value;

//   for(key in params) {
//     if(!params.hasOwnProperty(key)) continue;
//     value = params[key];
//     query.push(key + "=" + value);
//   }

//   history.pushState("","New Page Title",window.location.pathname+"?"+query.join("&"));
//   //location.search = query.join("&");
// }


// function updateQueryParameters(param,value) {
//     var params = getQueryParameters();
//     if(params[param] != value) {
//       params[param] = value;
//       setQueryParameters(params);
//     }

// }

// function pauseInstructions(){
//     if(document.getElementById('videoHolder').paused==false){
//         clearTimeout(window.nextInstructionTask);
//         document.getElementById('videoHolder').pause(); 
//         currentTime=document.getElementById("videoHolder").currentTime;
//         updateQueryParameters("startTime",currentTime);
//     }
//     else{
//         changeInstructionsTime(0);
//     }
//     drawInstructionsControls();
// }




// function reloadInstructions(incoming){
//     console.log("loadVideo");
//     var video = document.createElement('video');
//     video.id = 'videoHolder';
//     video.src = incoming['source'];
//     video.height='0px';
//     document.body.appendChild(video);
//     startInstructions(incoming);
// }

function endInstructions(incoming){
    clearTimeout(window.moveInstructionsTimer);
    deleteDiv('audioHolder');
    deleteDiv('clickMp3Div');
    deleteDiv('captionOverlay');
    deleteDiv('cursorOverlay');
    statusManager();
    // deleteDiv("mainDiv");
    // mainDiv=createDiv("mainDiv");
    // $("body").prepend(mainDiv);
    // statusManager();
}


function changeCaptionBottom(incoming){
    value=incoming['y'];
    document.getElementById("captionOverlay").style.bottom=value+"px";
    // document.getElementById("instructionsElapsed").style.bottom=value+"px";
}


// window.captionIndex=0;
// function showCaptions(reloadType){
//     if(document.getElementById('videoHolder')!=null){
//         window.captionDiff=window.captions[window.captionIndex][2]-document.getElementById('videoHolder').currentTime;
//     }
//     else{
//         window.captionDiff=0;
//     }
//     if(reloadType=="refresh"){
//         window.captionDiff=0;
//         thisCaptionTime=0;
//         window.captionIndex=0;
//         while(thisCaptionTime&lt;window.elapsed){
//             if(window.captions.length>window.captionIndex){
//                 thisCaptionTime=thisCaptionTime+window.captions[window.captionIndex][1]*1000;
//                 window.captionIndex=window.captionIndex+1;
//                 interval=thisCaptionTime-window.elapsed;
//             }
//             else{
//                 break;
//             }
//         }
//         window.captionIndex=window.captionIndex-1;
//     }
//     else{
//         window.captionIndex=window.captionIndex+1;
//         if(window.captions.length>window.captionIndex){
//             interval=window.captions[window.captionIndex][1]*1000;
//         }
//         else{
//             interval=10000000000;
//         }
//     }

//     if(document.getElementById("captionOverlay")==null){
//         var captionOverlay = createDiv('captionOverlay');
//         var mainDiv = document.getElementById("mainDiv");
//         captionOverlay.style.width=mainDiv.style.width;
//         var captions = createDiv('captions');
//         captionOverlay.appendChild(captions);
//         mainDiv.appendChild(captionOverlay);
//     }
//     else{
//         var captions = document.getElementById("captions");
//     }
//     if(window.captions.length>window.captionIndex){
//         captions.innerHTML=window.captions[window.captionIndex][0];
//     }
//     else{
//         captions.innerHTML="Instructions Finished";        
//     }
//     //console.log(window.captionIndex,interval,window.captionDiff*1000);
//     //console.log("nextCaption",interval+window.captionDiff*1000);
//     setTimeout(showCaptions,interval+window.captionDiff*1000);
//     drawElapsedTime();
// }

// function placeText(divid,text,top,fontSize,color,fadeTime,textAlign,left){
//     var title1 = document.createElement("a");
//     title1.id=divid;
//     title1.innerHTML=text;
//     title1.style.opacity="0";
//     //title1.style.lineHeight="300px";
//     title1.style.top=top+"px";
//     title1.style.width="100%";
//     title1.style.fontSize=fontSize+"%";
//     title1.style.left=left;
//     title1.style.textAlign=textAlign;
//     title1.style.color=color;
//     title1.style.position="absolute";
//     $("#mainDiv").append(title1);
//     setTimeout(function(){
//         document.getElementById(divid).style.opacity = "1";
//         document.getElementById(divid).style.transition = "opacity "+fadeTime+"s ease";
//     },50);
// }






function drawLogoVSEEL(){
    logo=createAndAddElement("a","vseelLogo","mainDiv");
    letters=["","V","S","E","E","L"]
    for(var k=1;k&lt;=5;k++){
        test=createAndAddElement("div","vseelLogoLetter"+k,"vseelLogo");
        test.className="welcomeScreenTitle spin"+k+" animated"+k;
        test.innerHTML=letters[k];
    }
}

function drawLogoESL(){
    logo=createAndAddElement("a","vseelLogo","mainDiv");
    letters=["","E","S","L"]
    for(k=1;k&lt;=3;k++){
        test=createAndAddElement("div","vseelLogoLetter"+k,"vseelLogo");
        test.className="welcomeScreenTitle spin"+k+" animated"+k;
        test.innerHTML=letters[k];
    }
    // placeText("we",logo.innerHTML,300,400,"rgba(0,0,0,1)",4,"center","0px");
}



// function highlightArea(divName,width,height,top,left,borderWidth,borderColor){
//     thisDiv=createDiv(divName);
//     thisDiv.className="highlightDiv";
//     thisDiv.style.borderWidth=borderWidth+"px";
//     thisDiv.style.borderColor=borderColor;
//     thisDiv.style.width=width+"px";
//     thisDiv.style.height=height+"px";
//     thisDiv.style.top=top+"px";
//     thisDiv.style.left=left+"px";
//     $("#mainDiv").append(thisDiv);
// }




// //document.getElementById("mainDiv").addEventListener("click", displayDate);





// function moveDivToHighZ(divName){
//     document.getElementById(divName).style.zIndex = "3";
// }

// function moveDivToLowZ(divName){
//     document.getElementById(divName).style.zIndex = "1";
// }




function highlightDiv(incoming){
    var divName=incoming['divName'];
    document.getElementById(divName).style.zIndex = "3";
}

function unHighlightDiv(incoming){
    var divName=incoming['divName'];
    document.getElementById(divName).style.zIndex = null;
}



function growDiv(divName,scale,origin,time){
    document.getElementById(divName).style.zIndex = "99999999";
    document.getElementById(divName).style.transform += " scale("+scale+")";
    document.getElementById(divName).style.transition = time+"s ease-out";
    document.getElementById(divName).style.transformOrigin = origin;
}

function growDiv(divName,scale,origin,time){
    document.getElementById(divName).style.zIndex = null;
    document.getElementById(divName).style.transform += null;
    document.getElementById(divName).style.transition = time+"s ease-out";
    document.getElementById(divName).style.transformOrigin = origin;
}


function growDivOLD(divName,scale,origin,time){
    if(document.getElementById(divName).style.transform.indexOf("scale("+scale+")")>-1){
        document.getElementById(divName).style.zIndex = "1";
        document.getElementById(divName).style.transform=document.getElementById(divName).style.transform.replace("scale("+scale+")","");
    }
    else{
        document.getElementById(divName).style.zIndex = "3";
        document.getElementById(divName).style.transform += " scale("+scale+")";
    }

    document.getElementById(divName).style.transition = time+"s ease-out";
    document.getElementById(divName).style.transformOrigin = origin;
}

// function highlightText(divName,color,scale,time){
//     document.getElementById(divName).style.fontSize=parseInt(scale*100)+"%";
//     document.getElementById(divName).style.color=color;
//     document.getElementById(divName).style.transition = time+"s ease-out";
// }

// function highlightDivBorder(divName,color,time,width){
//     document.getElementById(divName).style.border=width+"px solid "+color;
//     document.getElementById(divName).style.transition = time+"s ease-out";
// }

// function instructionHighlightArea(sx,sy,wx,wy){
//     deleteDiv("instructionHighlight");
//     if(wx>0){
//         var title1 = document.createElement("a");
//         title1.id="instructionHighlight";
//         title1.style.top=sy+"px";
//         title1.style.left=sx+"px";
//         title1.style.width=wx+"px";
//         title1.style.height=wx+"px";
//         title1.style.border="10px solid blue";
//         title1.style.position="absolute";
//         title1.style.boxSizing = "border-box";
//         title1.style.zIndex = "4";
//         $("#mainDiv").append(title1);
//     }
// }




// function getStartTime(){
//     window.startTime=(new Date()).getTime();
// }


// function setInnerHtml(divIN,text){
//   document.getElementById(divIN).innerHTML=text;
// }





// function updateStatusOnClient(){
//     var message={"type":"updateStatusFromClient","status":window.state};
//     sendMessage(message);
// }





function drawInstructionsControls(){
    controlsDiv=createDiv("controlsDiv");
    document.body.appendChild(controlsDiv);


    controlsDivButton=createDiv("controlsDivTitle");
    controlsDivButton.innerHTML="Click to move forward or backward.";
    controlsDiv.appendChild(controlsDivButton);


    changeInstructionsTime
    controlsDivButtonBack30=createAndAddDiv("controlsDivButtonBack30","controlsDivTitle")
    controlsDivButtonBack30.innerHTML="Back 30";
    controlsDivButtonBack30.className="controlsDivButton";
    controlsDivButtonBack30.style.left="0%";
    clickButton("many","controlsDivButtonBack30",changeInstructionsTime,-30);

    controlsDivButtonBack5=createAndAddDiv("controlsDivButtonBack5","controlsDivTitle")
    controlsDivButtonBack5.innerHTML="Back 5";
    controlsDivButtonBack5.className="controlsDivButton";
    controlsDivButtonBack5.style.left="16.666666%";
    clickButton("many","controlsDivButtonBack5",changeInstructionsTime,-5);

    controlsDivButtonBack1=createAndAddDiv("controlsDivButtonBack1","controlsDivTitle")
    controlsDivButtonBack1.innerHTML="Back 1";
    controlsDivButtonBack1.className="controlsDivButton";
    controlsDivButtonBack1.style.left="33.3333333%";
    clickButton("many","controlsDivButtonBack1",changeInstructionsTime,-1);


    controlsDivButtonForward1=createAndAddDiv("controlsDivButtonForward1","controlsDivTitle")
    controlsDivButtonForward1.innerHTML="Forward 1";
    controlsDivButtonForward1.className="controlsDivButton";
    controlsDivButtonForward1.style.left="50%";
    clickButton("many","controlsDivButtonForward1",changeInstructionsTime,1);

    controlsDivButtonForward5=createAndAddDiv("controlsDivButtonForward5","controlsDivTitle")
    controlsDivButtonForward5.innerHTML="Forward 5";
    controlsDivButtonForward5.className="controlsDivButton";
    controlsDivButtonForward5.style.left="66.66666666%";
    clickButton("many","controlsDivButtonForward5",changeInstructionsTime,5);

    controlsDivButtonForward30=createAndAddDiv("controlsDivButtonForward30","controlsDivTitle")
    controlsDivButtonForward30.innerHTML="Forward 30";
    controlsDivButtonForward30.className="controlsDivButton";
    controlsDivButtonForward30.style.left="83.33333333%";
    clickButton("many","controlsDivButtonForward30",changeInstructionsTime,30);

    controlsDivButtonPause=createAndAddDiv("controlsDivButtonPause","controlsDivTitle")
    controlsDivButtonPause.innerHTML="Pause";
    controlsDivButtonPause.style.left="0%";
    clickButton("many","controlsDivButtonPause",toggleInsructionsPauseOnClient);//this pauses

    // document.body.addEventListener("click",moveInstructionsBackAndForth);
    // drawInstructionsControls();

}


function toggleInsructionsPauseOnClient(){
  msg={'type':"toggleInsructionsPauseOnClient"};
  sock.send(JSON.stringify(msg));
}

function changeInstructionsTime(args){
  var amount=args[0];
  msg={'type':"changeInstructionsTime",'amount':amount};
  sock.send(JSON.stringify(msg));
}





</code></pre>
</div>

<div class="header">/code/javascript/jquery-1.11.3.min.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">/*! jQuery v1.11.3 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.3",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b="length"in a&&a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1&lt;&lt;31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="&lt;a id='"+u+"'>&lt;/a>&lt;select id='"+u+"-\f]' msallowcapture=''>&lt;option selected=''>&lt;/option>&lt;/select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType&lt;6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[0>c?c+b:c]}),even:oa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d&lt;b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function ra(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,ya(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="&lt;a href='#'>&lt;/a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="&lt;input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^&lt;(\w+)\s*\/?>(?:&lt;\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(&lt;[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="&lt;"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType&lt;11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;

return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length&lt;c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  &lt;link/>&lt;table>&lt;/table>&lt;a href='/a'>a&lt;/a>&lt;input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="&lt;:nav>&lt;/:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="&lt;textarea>x&lt;/textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="&lt;input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function aa(){return!0}function ba(){return!1}function ca(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")&lt;0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h&lt;b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ca()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===ca()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?aa:ba):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=aa,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=aa,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=aa,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=ba;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=ba),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function da(a){var b=ea.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var ea="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fa=/ jQuery\d+="(?:null|\d+)"/g,ga=new RegExp("&lt;(?:"+ea+")[\\s/>]","i"),ha=/^\s+/,ia=/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ja=/&lt;([\w:]+)/,ka=/&lt;tbody/i,la=/&lt;|&#?\w+;/,ma=/&lt;(?:script|style|link)/i,na=/checked\s*(?:[^=]|=\s*.checked.)/i,oa=/^$|\/(?:java|ecma)script/i,pa=/^true\/(.*)/,qa=/^\s*&lt;!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ra={option:[1,"&lt;select multiple='multiple'>","&lt;/select>"],legend:[1,"&lt;fieldset>","&lt;/fieldset>"],area:[1,"&lt;map>","&lt;/map>"],param:[1,"&lt;object>","&lt;/object>"],thead:[1,"&lt;table>","&lt;/table>"],tr:[2,"&lt;table>&lt;tbody>","&lt;/tbody>&lt;/table>"],col:[2,"&lt;table>&lt;tbody>&lt;/tbody>&lt;colgroup>","&lt;/colgroup>&lt;/table>"],td:[3,"&lt;table>&lt;tbody>&lt;tr>","&lt;/tr>&lt;/tbody>&lt;/table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X&lt;div>","&lt;/div>"]},sa=da(y),ta=sa.appendChild(y.createElement("div"));ra.optgroup=ra.option,ra.tbody=ra.tfoot=ra.colgroup=ra.caption=ra.thead,ra.th=ra.td;function ua(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ua(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function va(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wa(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xa(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function ya(a){var b=pa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function za(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Aa(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Ba(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xa(b).text=a.text,ya(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!ga.test("&lt;"+a.nodeName+">")?f=a.cloneNode(!0):(ta.innerHTML=a.outerHTML,ta.removeChild(f=ta.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ua(f),h=ua(a),g=0;null!=(e=h[g]);++g)d[g]&&Ba(e,d[g]);if(b)if(c)for(h=h||ua(a),d=d||ua(f),g=0;null!=(e=h[g]);g++)Aa(e,d[g]);else Aa(a,f);return d=ua(f,"script"),d.length>0&&za(d,!i&&ua(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=da(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(la.test(f)){h=h||o.appendChild(b.createElement("div")),i=(ja.exec(f)||["",""])[1].toLowerCase(),l=ra[i]||ra._default,h.innerHTML=l[1]+f.replace(ia,"&lt;$1>&lt;/$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&ha.test(f)&&p.push(b.createTextNode(ha.exec(f)[0])),!k.tbody){f="table"!==i||ka.test(f)?"&lt;table>"!==l[1]||ka.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ua(p,"input"),va),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ua(o.appendChild(f),"script"),g&&za(h),c)){e=0;while(f=h[e++])oa.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ua(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&za(ua(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ua(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fa,""):void 0;if(!("string"!=typeof a||ma.test(a)||!k.htmlSerialize&&ga.test(a)||!k.leadingWhitespace&&ha.test(a)||ra[(ja.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ia,"&lt;$1>&lt;/$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ua(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ua(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&na.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ua(i,"script"),xa),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ua(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,ya),j=0;f>j;j++)d=g[j],oa.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qa,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Ca,Da={};function Ea(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fa(a){var b=y,c=Da[a];return c||(c=Ea(a,b),"none"!==c&&c||(Ca=(Ca||m("&lt;iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Ca[0].contentWindow||Ca[0].contentDocument).document,b.write(),b.close(),c=Ea(a,b),Ca.detach()),Da[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Ga=/^margin/,Ha=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ia,Ja,Ka=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ia=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Ha.test(g)&&Ga.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ia=function(a){return a.currentStyle},Ja=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ia(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ha.test(g)&&!Ka.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function La(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  &lt;link/>&lt;table>&lt;/table>&lt;a href='/a'>a&lt;/a>&lt;input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight),b.removeChild(i)),b.innerHTML="&lt;table>&lt;tr>&lt;td>&lt;/td>&lt;td>t&lt;/td>&lt;/tr>&lt;/table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Ma=/alpha\([^)]*\)/i,Na=/opacity\s*=\s*([^)]*)/,Oa=/^(none|table(?!-c[ea]).+)/,Pa=new RegExp("^("+S+")(.*)$","i"),Qa=new RegExp("^([+-])=("+S+")","i"),Ra={position:"absolute",visibility:"hidden",display:"block"},Sa={letterSpacing:"0",fontWeight:"400"},Ta=["Webkit","O","Moz","ms"];function Ua(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ta.length;while(e--)if(b=Ta[e]+c,b in a)return b;return d}function Va(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fa(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wa(a,b,c){var d=Pa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Ya(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ia(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Ja(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ha.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xa(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ja(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ua(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qa.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ua(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Ja(a,b,d)),"normal"===f&&b in Sa&&(f=Sa[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Oa.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Ra,function(){return Ya(a,b,d)}):Ya(a,b,d):void 0},set:function(a,c,d){var e=d&&Ia(a);return Wa(a,c,d?Xa(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Na.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Ma,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Ma.test(f)?f.replace(Ma,e):f+" "+e)}}),m.cssHooks.marginRight=La(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Ja,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Ga.test(a)||(m.cssHooks[a+b].set=Wa)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ia(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Va(this,!0)},hide:function(){return Va(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Za(a,b,c,d,e){
return new Za.prototype.init(a,b,c,d,e)}m.Tween=Za,Za.prototype={constructor:Za,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Za.propHooks[this.prop];return a&&a.get?a.get(this):Za.propHooks._default.get(this)},run:function(a){var b,c=Za.propHooks[this.prop];return this.options.duration?this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Za.propHooks._default.set(this),this}},Za.prototype.init.prototype=Za.prototype,Za.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Za.propHooks.scrollTop=Za.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Za.prototype.init,m.fx.step={};var $a,_a,ab=/^(?:toggle|show|hide)$/,bb=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cb=/queueHooks$/,db=[ib],eb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bb.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bb.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fb(){return setTimeout(function(){$a=void 0}),$a=m.now()}function gb(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hb(a,b,c){for(var d,e=(eb[b]||[]).concat(eb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ib(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fa(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fa(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ab.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fa(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hb(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jb(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kb(a,b,c){var d,e,f=0,g=db.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$a||fb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$a||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jb(k,j.opts.specialEasing);g>f;f++)if(d=db[f].call(j,a,k,j.opts))return d;return m.map(k,hb,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kb,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],eb[c]=eb[c]||[],eb[c].unshift(b)},prefilter:function(a,b){b?db.unshift(a):db.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kb(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),m.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($a=m.now();c&lt;b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$a=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_a||(_a=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_a),_a=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  &lt;link/>&lt;table>&lt;/table>&lt;a href='/a'>a&lt;/a>&lt;input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lb,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mb,nb,ob=m.expr.attrHandle,pb=/^(?:checked|selected)$/i,qb=k.getSetAttribute,rb=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nb:mb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rb&&qb||!pb.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qb?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nb={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rb&&qb||!pb.test(c)?a.setAttribute(!qb&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ob[b]||m.find.attr;ob[b]=rb&&qb||!pb.test(b)?function(a,b,d){var e,f;return d||(f=ob[b],ob[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ob[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rb&&qb||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mb&&mb.set(a,b,c)}}),qb||(mb={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},ob.id=ob.name=ob.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mb.set},m.attrHooks.contenteditable={set:function(a,b,c){mb.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sb=/^(?:input|select|textarea|button|object)$/i,tb=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sb.test(a.nodeName)||tb.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var ub=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")&lt;0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ub," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vb=m.now(),wb=/\?/,xb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xb,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yb,zb,Ab=/#.*$/,Bb=/([?&])_=[^&]*/,Cb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Db=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Eb=/^(?:GET|HEAD)$/,Fb=/^\/\//,Gb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hb={},Ib={},Jb="*/".concat("*");try{zb=location.href}catch(Kb){zb=y.createElement("a"),zb.href="",zb=zb.href}yb=Gb.exec(zb.toLowerCase())||[];function Lb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mb(a,b,c,d){var e={},f=a===Ib;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nb(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Ob(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zb,type:"GET",isLocal:Db.test(yb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nb(Nb(a,m.ajaxSettings),b):Nb(m.ajaxSettings,a)},ajaxPrefilter:Lb(Hb),ajaxTransport:Lb(Ib),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cb.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zb)+"").replace(Ab,"").replace(Fb,yb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gb.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yb[1]&&c[2]===yb[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yb[3]||("http:"===yb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mb(Hb,k,b,v),2===t)return v;h=m.event&&k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Eb.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wb.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bb.test(e)?e.replace(Bb,"$1_="+vb++):e+(wb.test(e)?"&":"?")+"_="+vb++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jb+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mb(Ib,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Ob(k,v,c)),u=Pb(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth&lt;=0&&a.offsetHeight&lt;=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qb=/%20/g,Rb=/\[\]$/,Sb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;function Vb(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rb.test(a)?d(a,e):Vb(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vb(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vb(c,a[c],b,e);return d.join("&").replace(Qb,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sb,"\r\n")}}):{name:b.name,value:c.replace(Sb,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zb()||$b()}:Zb;var Wb=0,Xb={},Yb=m.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Xb)Xb[a](void 0,!0)}),k.cors=!!Yb&&"withCredentials"in Yb,Yb=k.ajax=!!Yb,Yb&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xb[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xb[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zb(){try{return new a.XMLHttpRequest}catch(b){}}function $b(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _b=[],ac=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_b.pop()||m.expando+"_"+vb++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ac.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ac.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ac,"$1"+e):b.jsonp!==!1&&(b.url+=(wb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_b.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bc=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bc)return bc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("&lt;div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cc=a.document.documentElement;function dc(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dc(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cc;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cc})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dc(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=La(k.pixelPosition,function(a,c){return c?(c=Ja(a,b),Ha.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ec=a.jQuery,fc=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fc),b&&a.jQuery===m&&(a.jQuery=ec),m},typeof b===K&&(a.jQuery=a.$=m),m});

</code></pre>
</div>

<div class="header">/code/javascript/monitor.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">
function goToPageNewTab(args){
  window.open(args[0],"_blank");
}


function drawPageTabs(currentPage){
  // placeText({"text":"Server Links","divid":"server2Button","top":"0px","left":"0px","width":"100px","height":"25px","fontSize":"100%","color":"black"});
  var consoleLeft="400px";
  var monitorLeft="200px";
  var serverLeft="0px";


  placeText({"parentDiv":"monitorHeaderRight","zIndex":"11","text":"Server Info","divid":"serverInfoButton","top":"0px","left":serverLeft,"width":"200px","height":"75px","fontSize":"20px","border":"0px solid rgba(0,0,0,.1)","color":"white"});
  placeText({"parentDiv":"monitorHeaderRight","zIndex":"11","text":"Monitor","divid":"monitorButton","top":"0px","left":monitorLeft,"width":"200px","height":"75px","fontSize":"20px","border":"0px solid rgba(0,0,0,.1)","color":"white"});
  placeText({"parentDiv":"monitorHeaderRight","zIndex":"11","text":"Console","divid":"consoleButton","top":"0px","left":consoleLeft,"width":"200px","height":"75px","fontSize":"20px","border":"0px solid rgba(0,0,0,.1)","color":"white"});

  clickButton("many","serverInfoButton",changeMonitorPage,"serverInfo");
  clickButton("many","monitorButton",changeMonitorPage,"monitor");
  clickButton("many","consoleButton",changeMonitorPage,"console");

  document.getElementById(currentPage+"Button").style.backgroundColor='rgba(255,255,255,.5)';
  var hoverInfo={"backgroundColor":"white","color":"navy"};
  hoverDiv("serverInfoButton",hoverInfo)
  hoverDiv("monitorButton",hoverInfo)
  hoverDivChangeOtherDiv("consoleButton","consoleButton",hoverInfo)
}




function drawMonitorHeader(){
    deleteDiv("monitorHeader");
    var thisDiv = document.createElement("div");
    thisDiv.id="monitorHeader";
    document.body.prepend(thisDiv);

    deleteDiv("monitorHeaderRight");
    var thisDiv = document.createElement("div");
    thisDiv.id="monitorHeaderRight";
    document.body.prepend(thisDiv);

  placeText({"parentDiv":"monitorHeader","text":"STEEP","divid":"steepTitle","top":"0px","left":"calc(50% - 800px)","width":"800px","height":"75px","fontSize":"30px","border":"0px solid rgba(0,0,0,.1)","color":"white"});  
}
function drawMainDivInside(){
  document.getElementById("mainDiv").style.height="100%";
  document.getElementById("mainDiv").style.backgroundColor="white";
  placeText({"divid":"mainDivInside","top":"100px","left":"0px","width":"1600px","height":"calc(100% - 100px)"});
  document.getElementById("mainDivInside").style.overflowY = "scroll";
}



function changeMonitorPage(args){
  sock.send(JSON.stringify({"type":"changeMonitorPage","page":args[0]}));
}


function goToPointInInstructions(args){
  var e=args[args.length-1];
  var pos=clickEvent(e);
  var pct=pos[0]/document.getElementById("monitorTableCaptionsRowEntry").offsetWidth;
  var msg={"type":"changeInstructionsTimeFromMonitor","percentage":pct}
  var statement="Are you sure change the instructions time?";
  sock.send(JSON.stringify(msg));

  // confirmAction(statement,msg);
  
}

function makeMonitorTable(msg){
  var subjectIDs=msg['table']['subjectIDs'];
  var titles=msg['table']['titles'];
  var connected=msg['table']['connected'];

  if(isDivNotThere("monitorTableHolder")){
    placeText({"parentDiv":"mainDivInside","divid":"monitorTableHolder","width":"1300px","height":"100%","top":"0px","left":"0px"});
    var table=createAndAddElement("table","monitorTable","monitorTableHolder");
  }


  if(window.serverStatus['page']=="instructions"){
    var captionRow=createAndAddElement("tr","monitorTableCaptionsRow","monitorTable");
    var captionEntry=createAndAddElement("td","monitorTableCaptionsRowEntry","monitorTableCaptionsRow");
    captionEntry.colSpan=titles.length+1;
    captionEntry.innerHTML=window.serverStatus['instructions']['lastCaption'];

    var instructionsStatusBar=createAndAddDiv("instructionsStatusBar","monitorTableCaptionsRowEntry");
    instructionsStatusBar.style.width=serverStatus['instructions']['time']*document.getElementById("monitorTableCaptionsRowEntry").offsetWidth;
      clickButton("many","monitorTableCaptionsRowEntry",goToPointInInstructions);

  }
  else{
    deleteDiv("instructionsStatusBar");
  }


  if(isDivNotThere("monitorTableHeaderRow")){
    var thisRow=createAndAddElement("tr","monitorTableHeaderRow","monitorTable");
  }

  if(isDivNotThere("monitorTableHeader_"+0)){
    var thisHeader=createAndAddElement("th","monitorTableHeader_"+0,"monitorTableHeaderRow");
    thisHeader.innerHTML="#";
  }

  for(k=0;k&lt;titles.length;k++){
    if(isDivNotThere("monitorTableHeader_"+(k+1))){
      var thisHeader=createAndAddElement("th","monitorTableHeader_"+(k+1),"monitorTableHeaderRow");
    }
    if(document.getElementById("monitorTableHeader_"+(k+1)).innerHTML!=titles[k]){
      document.getElementById("monitorTableHeader_"+(k+1)).innerHTML=titles[k];
      clickButton("many","monitorTableHeader_"+(k+1),sortMonitorTable,k);
    }
  }

  for(var s=0;s&lt;subjectIDs.length;s++){
    var thisRow=createAndAddElement("tr","monitorTableRow_"+s,"monitorTable");
    if(connected[subjectIDs[s]]=="disconnected"){
      console.log("@#$@#$",s);
      thisRow.style.backgroundColor="rgba(255,0,0,.2)";
    }
    var thisEntry=createAndAddElement("td","monitorTableEntry_"+s+"-0","monitorTableRow_"+s);
    thisEntry.innerHTML=s+1;
    for(var k=0;k&lt;titles.length;k++){
      var thisEntry=createAndAddElement("td","monitorTableEntry_"+s+"-"+(k+1),"monitorTableRow_"+s);
      thisEntry.innerHTML=msg['table'][subjectIDs[s]][titles[k]];
    }
  }
}





function sortMonitorTable(args){
  col=args[0];
  msg={'type':"sortMonitorTableMessage",'col':col};
  sock.send(JSON.stringify(msg));
}

function changeMonitorTable(args){
  newTable=args[0];
  msg={'type':"changeMonitorTable",'table':newTable};
  sock.send(JSON.stringify(msg));
}



function stopPythonServer(){
  var statement="Are you sure you want to stop the python server??  Only do this if you are done with the experiment or you have an error.  You might be able to restart, but only maybe.";
  var msg={'type':"stopPythonServer"};
  confirmAction(statement,msg);
}


function restartPythonServer(){
  var statement="Are you sure you want to restart the python server??  Only do this if you are done with the experiment or you have an error.  You might be able to restart, but only maybe.";
  var msg={'type':"restartPythonServer"};
  confirmAction(statement,msg);
}

function makeTaskTable(msg){
  placeText({"parentDiv":"mainDivInside","divid":"taskTableHolder","width":"300px","height":"100%","top":"0px","right":"0px"});
  drawAcceptingSwitch();
  for(row=0;row&lt;msg['taskList'].length;row++){
    var thisTask=msg['taskList'][row];
    var taskTitle=msg['taskStatus'][thisTask]['title'];
    var taskStatus=msg['taskStatus'][thisTask]['status'];
    if(taskTitle=="Load Instructions"){
      drawInstructionsController();
    }
    else{
      drawGenericTask(row,thisTask,taskTitle,taskStatus);
    }
  }

  drawDataFileButton(msg);
  drawStopServerButton(msg);
  drawRestartServerButton(msg);
  drawRefreshAllButton(msg);

}


function drawGenericTask(row,thisTask,taskTitle,taskStatus){
  var divName="taskDiv_"+thisTask;
  var thisDiv=createAndAddDiv(divName,"taskTableHolder");
  thisDiv.className="taskButton";
  thisDiv.style.top=(60+60*row)+"px";
  thisDiv.innerHTML=taskTitle;
  if(taskStatus=="Done"){
      thisDiv.style.backgroundColor="var(--w3-green)";
  }
  else{
      thisDiv.style.backgroundColor="var(--w3-red)";
      clickButton("many",divName,sendToServer,thisTask,taskTitle);
  }
}


function drawDataFileButton(msg){
  var dataFileButton=createAndAddDiv("dataFileButton","taskTableHolder");
  dataFileButton.className="taskButton alwaysThere";
  dataFileButton.innerHTML="Download Data Folder (.zip)";
  dataFileButton.style.top=(100+60*msg['taskList'].length)+"px";
  dataFileButton.href=msg['dataFolderURL'];
  clickButton("many","dataFileButton",downloadDataFile,msg['dataFolderURL']);
}

function downloadDataFile(args){
  window.location.href=args[0];
}



function drawStopServerButton(msg){
  var stopPythonServerButton=createAndAddDiv("stopPythonServerButton","taskTableHolder");
  stopPythonServerButton.className="taskButton alwaysThere";
  stopPythonServerButton.innerHTML="Stop Python Server";
  stopPythonServerButton.style.top=(220+60*msg['taskList'].length)+"px";
  clickButton("once","stopPythonServerButton",stopPythonServer);

}


function drawRestartServerButton(msg){
  var stopPythonServerButton=createAndAddDiv("restartPythonServerButton","taskTableHolder");
  stopPythonServerButton.className="taskButton alwaysThere";
  stopPythonServerButton.innerHTML="Restart Python Server";
  stopPythonServerButton.style.top=(280+60*msg['taskList'].length)+"px";
  clickButton("once","restartPythonServerButton",restartPythonServer);

}

function drawRefreshAllButton(msg){
  var refreshAllButton=createAndAddDiv("refreshAllButton","taskTableHolder");
  refreshAllButton.className="taskButton alwaysThere";
  refreshAllButton.innerHTML="Refresh All Clients";
  refreshAllButton.style.top=(160+60*msg['taskList'].length)+"px";
  clickButton("once","refreshAllButton",refreshClient,"all");
    // var thisRow = document.createElement("tr");
  // var cell = document.createElement("td");
  // cell.colSpan="3";
  // cell.align="center";
  // cell.innerHTML="&lt;a href='javascript:void(0)' onclick='refreshClient(\"all\");'>Refresh All&lt;/a>";
  // thisRow.appendChild(cell);
  // table.appendChild(thisRow);

}

function toggleAcceptingSwitch(){
  msg={'type':"toggleAcceptingSwitch"};
  sock.send(JSON.stringify(msg));
}

function drawAcceptingSwitch(){
  var acceptingButton=createAndAddDiv("acceptingButton","taskTableHolder");
  acceptingButton.className="taskButton";
  clickButton("once","acceptingButton",toggleAcceptingSwitch);
  if(window.serverStatus['acceptingClients']==0){
    acceptingButton.innerHTML="Not Accepting Clients"
    acceptingButton.style.backgroundColor="var(--w3-green)";
  }
  else if(window.serverStatus['acceptingClients']==1){
    acceptingButton.innerHTML="Accepting Clients"
    acceptingButton.style.backgroundColor="var(--w3-red)";
  }
}

function loadInstructions(){
  msg={'type':"loadInstructions"};
  sock.send(JSON.stringify(msg));
}

function resumeInstructions(){
  msg={'type':"resumeInstructions"};
  sock.send(JSON.stringify(msg));
}

function restartInstructions(){
  msg={'type':"restartInstructions"};
  sock.send(JSON.stringify(msg));
}
function stopInstructions(){
  msg={'type':"stopInstructions"};
  sock.send(JSON.stringify(msg));
}


function monitorEndInstructions(){
  msg={'type':"endInstructionsMessage"};
  sock.send(JSON.stringify(msg));
}

// function moveInstrutionsMonitorTimer(){
//   var timerSeconds=serverStatus['instructions']['time']+((new Date()).getTime()-window.lastTimeCheck)/1000;
//   document.getElementById('instructionsTime').innerHTML=makeTimePretty(timerSeconds);
//   if(serverStatus['instructions']['playing']==1){
//     setTimeout(moveInstrutionsMonitorTimer,100);
//   }
// }

function drawInstructionsController(){
  var loadInstructionsButton=createAndAddDiv("loadInstructionsButton","taskTableHolder");
  loadInstructionsButton.className="taskButton";
  if(window.serverStatus['instructions']['loaded']==0 && window.serverStatus['instructions']['finished']==0){
    loadInstructionsButton.innerHTML="Load Instructions";
    clickButton("once","loadInstructionsButton",loadInstructions);
    loadInstructionsButton.style.backgroundColor="var(--w3-red)";
  }
  else if(window.serverStatus['instructions']['loaded']==0 && window.serverStatus['instructions']['finished']==1){
    loadInstructionsButton.innerHTML="Finished (Click to load again)";
    clickButton("once","loadInstructionsButton",loadInstructions);
    loadInstructionsButton.style.backgroundColor="var(--w3-green)";
  }
  else if(window.serverStatus['instructions']['loaded']==1){
    if(window.serverStatus['instructions']['playing']==1){
      var instructionsPlayButton=createAndAddDiv("instructionsPlayButton","loadInstructionsButton");
      instructionsPlayButton.innerHTML="Pause";
      instructionsPlayButton.className="instructionsControlButton";
      clickButton("once","instructionsPlayButton",stopInstructions);
    }
    else if(window.serverStatus['instructions']['playing']==0){
      var instructionsPlayButton=createAndAddDiv("instructionsPlayButton","loadInstructionsButton");
      instructionsPlayButton.innerHTML="Play";
      instructionsPlayButton.className="instructionsControlButton";
      clickButton("once","instructionsPlayButton",resumeInstructions);
    }


    var instructionsRestartButton=createAndAddDiv("instructionsRestartButton","loadInstructionsButton");
    instructionsRestartButton.innerHTML="Restart";
    instructionsRestartButton.className="instructionsControlButton";
    clickButton("many","instructionsRestartButton",restartInstructions);

    var instructionsEndButton=createAndAddDiv("instructionsEndButton","loadInstructionsButton");
    instructionsEndButton.innerHTML="End";
    instructionsEndButton.className="instructionsControlButton";
    clickButton("many","instructionsEndButton",monitorEndInstructions);

  }
}

function sendToServer(args){
  var thisTask=args[0];
  var taskTitle=args[1];
  var statement="Are you sure you want to "+taskTitle+"??";
  var message={"type":thisTask};
  confirmAction(statement,message);
}

function refreshClient(args){
  var sid=args[0];
  msg={}
  msg['type']="refreshMyPage";
  msg['subjectIDIncoming']=sid;
  var statement="Are you sure you want to refresh "+sid+"??";
  confirmAction(statement,msg);
}

function deleteClient(args){
  var sid=args[0];
  msg={}
  msg['type']="deleteThisClient";
  msg['subjectIDIncoming']=sid;
  var statement="Are you sure you want to delete subject "+sid+"??";
  confirmAction(statement,msg);
}

function chooseVolunteer(args){
  var sid=args[0];
  msg={}
  msg['type']="chooseVolunteer";
  msg['subjectIDIncoming']=sid;
  sock.send(JSON.stringify(msg));
}




function startIt(type){
  msg={"type":type};
  sock.send(JSON.stringify(msg));
}


function getAutomatic(){
  $.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if(results==null){return null;}
    else{return results[1] || 0;}
  }
  for(var k=0;k&lt;5;k++){
    var timeDelay=300*(k+1);
    var username=$.urlParam('automatic'+k);
    if(username!=undefined){
      console.log("running",username);
      if(username=="stopAccepting"){
        setTimeout(toggleAcceptingSwitch,timeDelay);        
      }   
      else if(username=="loadInstructions"){
        setTimeout(loadInstructions,timeDelay);        
      }   
      else if(username=="resumeInstructions"){
        setTimeout(resumeInstructions,timeDelay);        
      }   
      else{
        console.log(username,"!!!!!!");
        var pf = partial(startIt,username);
        setTimeout(pf,timeDelay);        
      }
    }
  }
}



function drawMonitorPageLinks(){
  placeText({"zIndex":"6","color":"white","fontSize":"20px","lineHeight":"75px","text":"Other Monitor Pages - Current Page: "+camelCaseToRegular(window.currentMonitorTable),"divid":"otherMonitorPagesHolder","top":"-250px","left":"775px","width":"650px","height":(100+75*Math.floor(1+(window.monitorTables.length-1)/3))+"px","fontSize":"20px","backgroundColor":"var(--w3-purple)","transition":"all .25s ease"});
  for(var k=0;k&lt;window.monitorTables.length;k++){
    if(window.currentMonitorTable==window.monitorTables[k]){
      var backgroundColor="var(--w3-lightblue2)";
    }
    else{
      var backgroundColor="var(--w3-lightblue)";
    }
    var y=Math.floor(1+k/3)*75
    var x=25+(k%3)*200;
    placeText({"parentDiv":"otherMonitorPagesHolder","text":camelCaseToRegular(window.monitorTables[k]),"divid":"otherMonitorPage"+k,"top":y+"px","left":x+"px","width":"200px","height":"75px","fontSize":"20px","color":'white',"backgroundColor":backgroundColor});
    clickButton("many","otherMonitorPage"+k,changeMonitorTable,window.monitorTables[k]);
    var hoverInfo={"backgroundColor":"white","color":"navy"};
    hoverDivChangeOtherDiv("otherMonitorPage"+k,"otherMonitorPage"+k,hoverInfo);
  }

  if(window.currentMonitorTable!=undefined){
    placeText({"parentDiv":"monitorHeaderRight","zIndex":"11","divid":"currentMonitorPage","text":camelCaseToRegular(window.currentMonitorTable),"fontSize":"100%","color":"white","top":"50px","left":"200px","width":"200px","height":"25px",});
    hoverDivChangeOtherDiv("currentMonitorPage","otherMonitorPagesHolder",{"top":"70px","left":"775px"});
    clickButton("many","currentMonitorPage",changeMonitorPage,"monitor");
  }
  hoverDivChangeOtherDiv("monitorButton","otherMonitorPagesHolder",{"top":"70px","left":"775px"});
  hoverDivChangeOtherDiv("otherMonitorPagesHolder","otherMonitorPagesHolder",{"top":"70px","left":"775px"});
}


getAutomatic();

drawMonitorHeader();
drawMainDivInside();

function getMonitorTablesInfo(msg){
  window.monitorTables=msg['monitorTables'];
  window.currentMonitorTable=msg['currentMonitorTable']
  window.serverStatus=msg['serverStatus'];
  window.consoleTabsInfo=msg['consoleTabs'];
}

function updateMonitorHeader(msg){
  console.log("updateMonitorHeader")
  clearAll();
  drawMonitorHeader();
  drawMainDivInside();
  getMonitorTablesInfo(msg);
  drawPageTabs(msg['currentPage']);
  drawConsoleTabs();
  drawMonitorPageLinks();
}

function updateMonitorTable(msg){
  deleteDiv("serverInfoContainer");
  deleteDiv("configInfoContainer");
  deleteDiv("mainInfoHolder");
  deleteDiv("consoleLinesHolder");
  getMonitorTablesInfo(msg);
  window.lastTimeCheck=(new Date()).getTime();
  makeMonitorTable(msg);
}

function updateTaskTable(msg){
  deleteDiv("consoleLinesHolder")
  window.serverStatus=msg['serverStatus'];
  makeTaskTable(msg);
}


function getColor(outputType){
  if(outputType=="stderr"){
    background="rgba(255,0,0,.1)";
    text="rgba(255,0,0,1)";
  }
  else if(outputType=="stdout"){
    background="rgba(0,255,0,.05)";
    text="rgba(0,150,0,1)";
  }
  else if(outputType=="twisted"){
    background="rgba(0,0,255,.1)";
    text="rgba(0,150,0,1)";
  }
  else if(outputType=="twistedError"){
    background="rgba(0,0,255,.1)";
    text="rgba(200,0,0,1)";
  }
  else{
    background="rgba(255,255,255,.1)";
    text="rgba(255,0,0,1)";

  }
  return [background,text]
}

function drawConsoleLines(){
  var currentY=0;
  var lineHeight=0;
  placeText({"parentDiv":"mainDivInside","divid":"consoleLinesHolder","width":"100%","height":"100%","top":"0px","left":"0px",});
  for(var k=0;k&lt;window.consoleLines.length;k++){

    //getLine height
    if(window.consoleLines[k][3]['sameLine']!="True"){
      currentY+=lineHeight;
    }

    if(window.consoleLines[k][3]['height']!=undefined){
      var lineHeight=parseInt(window.consoleLines[k][3]['height'].substring(0,window.consoleLines[k][3]['height'].length-2));
    }
    else{
      var lineHeight=25;
    }




    if(window.consoleLines[k][3]['sameLine']!="True"){
      //draw background
      var thisFormat={
        "parentDiv":"consoleLinesHolder",
        "divid":"lineBackground"+k,
        "text":"",
        "top":currentY+"px",
        "left":"0px",
        "textAlign":"left",
        "height":"25px",
        "fontSize":"125%",
        "backgroundColor":getColor(window.consoleLines[k][0])[0],
        "paddingLeft":"10px",
      }
      for(j in window.consoleLines[k][3]){
        thisFormat[j]=window.consoleLines[k][3][j];
        // thisFormat["backgroundColor"]="rgba(255,0,0,.1)";
        thisFormat["width"]="100%";
        thisFormat["left"]="0px";
        thisFormat["borderBottom"]="1px solid rgba(0,0,0,.1)";
      }
      placeText(thisFormat);


      //draw line numbers
        placeText({
          "parentDiv":"consoleLinesHolder",
          "divid":"lineNumber"+k,
          "text":window.consoleLines[k][2]+":",
          "top":currentY+"px",
          "left":"0px",
          "width":'25px',
          "height":"25px",
          "color":getColor(window.consoleLines[k][0])[1],
          "textAlign":"right"
        });
    }

    //draw text
    var thisFormat={
      "parentDiv":"consoleLinesHolder",
      "divid":"line"+k,
      "text":window.consoleLines[k][1],
      "top":currentY+"px",
      "left":"25px",
      "textAlign":"left",
      "height":"25px",
      "fontSize":"125%",
      "paddingLeft":"10px",
      "color":getColor(window.consoleLines[k][0])[1],
    }
    for(j in window.consoleLines[k][3]){
      thisFormat[j]=window.consoleLines[k][3][j];
      thisFormat["backgroundColor"]="";
    }
    placeText(thisFormat);
  }
}




function drawConsoleTabs(){
  placeText({
    "zIndex":"6",
    "color":"white",
    "fontSize":"20px",
    "lineHeight":"75px",
    "text":"Console Navigator - Current Page"+(window.consoleTabsInfo[0])+" out of "+window.consoleTabsInfo[1],
    "divid":"consoleTabsHolder",
    "top":"-250px",
    "left":"675px",
    "width":"850px",
    "height":"175px",
    "fontSize":"20px",
    "backgroundColor":"white",
      "backgroundColor":"var(--w3-purple)",
    "transition":"all .25s ease"
    });


  placeText({
      "parentDiv":"consoleTabsHolder",
      "divid":"firstPageTab",
      "text":"First Page",
      "fontSize":"20px",
      "color":'white',
      "top":75+"px",
      "left":25+"px",
      "width":"200px",
      "height":"75px",
      "backgroundColor":"var(--w3-lightblue)"
    });


  placeText({
      "parentDiv":"consoleTabsHolder",
      "divid":"previousPageTab",
      "text":"Previous Page",
      "fontSize":"20px",
      "color":'white',
      "top":75+"px",
      "left":225+"px",
      "width":"200px",
      "height":"75px",
      "backgroundColor":"var(--w3-lightblue)"
    });


  placeText({
      "parentDiv":"consoleTabsHolder",
      "divid":"nextPageTab",
      "text":"Next Page",
      "fontSize":"20px",
      "color":'white',
      "top":75+"px",
      "left":425+"px",
      "width":"200px",
      "height":"75px",
      "backgroundColor":"var(--w3-lightblue)"
    });


  placeText({
      "parentDiv":"consoleTabsHolder",
      "divid":"lastPageTab",
      "text":"Last Page",
      "fontSize":"20px",
      "color":'white',
      "top":75+"px",
      "left":625+"px",
      "width":"200px",
      "height":"75px",
      "backgroundColor":"var(--w3-lightblue)"
    });

  if(window.consoleTabsInfo!=undefined){
  placeText({
      "zIndex":"11",
      "divid":"pagenumber",
      "text":"Page "+(window.consoleTabsInfo[0])+" out of "+window.consoleTabsInfo[1],
      "fontSize":"100%",
      "color":"white",
      "top":"50px",
      "left":"1200px",
      "width":"200px",
      "height":"25px",
      // "border":"1px solid rgba(0,0,0,.1)"
    });
    hoverDivChangeOtherDiv("pagenumber","consoleTabsHolder",{"top":"70px"});
    clickButton("many","pagenumber",changeMonitorPage,"console");
    }


    var nextTab=Math.min(window.currentTab+1,window.totalPages);
    var previousTab=Math.max(window.currentTab-1,1);
    clickButton("many","firstPageTab",changeConsoleTab,"first");
    clickButton("many","previousPageTab",changeConsoleTab,"previous");
    clickButton("many","nextPageTab",changeConsoleTab,"next");
    clickButton("many","lastPageTab",changeConsoleTab,"last");
  var hoverInfo={"backgroundColor":"white","color":"navy"};
    hoverDiv("firstPageTab",hoverInfo)
    hoverDiv("previousPageTab",hoverInfo)
    hoverDiv("nextPageTab",hoverInfo)
    hoverDiv("lastPageTab",hoverInfo)
    hoverDivChangeOtherDiv("consoleButton","consoleTabsHolder",{"top":"70px"});
    hoverDivChangeOtherDiv("consoleTabsHolder","consoleTabsHolder",{"top":"70px"});


}


function changeConsoleTab(args){
  sock.send(JSON.stringify({"type":"changeConsoleTab","tab":args[0]}));
}


function consoleLinesNoUpdate(msg){
  console.log("consoleLinesNoUpdate")
}

function consoleLinesUpdate(msg){
  deleteDiv("serverInfoContainer")
  deleteDiv("configInfoContainer")
  deleteDiv("monitorTableHolder");
  deleteDiv("taskTableHolder");
  deleteDiv("mainInfoHolder");
  getMonitorTablesInfo(msg)
  window.consoleLines=msg['consoleLines'];
  drawConsoleLines();
  document.getElementById("mainDivInside").scrollTop= (0,20000);
}


function drawServerInfo(){

  var incoming={
    "parentDiv":"mainDivInside",
    "divid":"serverInfoContainer",
    "fontSize":"300%",
    "color":"black",
    "height":"400px",
    "width":"750px",
    "left":"800px",
    "top":"275px",
    "backgroundColor":"white"
  };
  placeText(incoming);


  placeText({
    "parentDiv":"serverInfoContainer",
    "text":"Server Information",
    "color":"black",
    "height":"50px",
    "top":"0px",
  });


  placeText({
    "parentDiv":"serverInfoContainer",
    "text":"Python Version:",
    "fontSize":"70%",
    "color":"blue",
    "height":"50px",
    "width":"250px",
    "textAlign":"right",
    "top":"50px",
  });
  placeText({
    "parentDiv":"serverInfoContainer",
    "text":window.pythonVersion,
    "fontSize":"70%",
    "color":"black",
    "height":"50px",
    "left":"270px",
    "textAlign":"left",
    "top":"50px",
    "width":"unset",
  });

  placeText({
    "parentDiv":"serverInfoContainer",
    "text":"Python Executable:",
    "fontSize":"70%",
    "color":"blue",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":"100px",
  });

  placeText({
    "parentDiv":"serverInfoContainer",
    "text":window.pythonExecutable,
    "fontSize":"70%",
    "color":"black",
    "height":"50px",
    "width":"unset",
    "left":"270px",
    "textAlign":"left",
    "top":"100px",
  });

  placeText({
    "parentDiv":"serverInfoContainer",
    "text":"Server IP Address:",
    "fontSize":"70%",
    "color":"red",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":"150px",
  });


  var y=150;
  if(window.ipAddresses==undefined){window.ipAddresses=[["0","Error Getting IP (server is still running fine)"]];}
  for(var k=0;k&lt;window.ipAddresses.length;k++){
    placeText({
      "parentDiv":"serverInfoContainer",
      "text":window.ipAddresses[k][1],
      "fontSize":"70%",
      "color":"black",
      "height":"50px",
      "width":"unset",
      "left":"270px",
      "textAlign":"left",
      "top":(y)+"px",
    });
    y+=50;
  }

  placeText({
    "parentDiv":"serverInfoContainer",
    "text":"Config IP Address:",
    "fontSize":"70%",
    "color":"red",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":y+"px",
  });

  placeText({
    "parentDiv":"serverInfoContainer",
    "text":window.config['domain'],
    "fontSize":"70%",
    "color":"black",
    "height":"50px",
    "width":"unset",
    "left":"270px",
    "textAlign":"left",
    "top":(y)+"px",
  });

  y+=50;


  placeText({
    "parentDiv":"mainDivInside",
    "divid":"mainInfoHolder",
    "height":"250px",
    "width":"100%",
    "top":"0px",
    "left":"0px",
    "overflow":"hidden",
    "backgroundColor":"rgba(255,0,0,.1)",
    });

  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"Launcher String:",
    "fontSize":"20px",
    "color":"green",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":25+"px",
  });

  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe -kiosk --no-default-browser-check --disk-cache-size=1 --media-cache-size=1 "+window.config['domain']+"/client.html",
    "fontSize":"20px",
    "color":"black",
    "height":"50px",
    "left":"270px",
    "whiteSpace":"nowrap",
    "overflow":"none",
    "width":"calc(100% - 270px)",
    "textAlign":"left",
    "top":25+"px",
    "userSelect":"text",
    "zIndex":"5",
  });
  y+=50;

  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"Restart String:",
    "fontSize":"20px",
    "color":"green",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":75+"px",
  });


  placeText({
    "parentDiv":"mainInfoHolder",
    "text":config['restartString'],
    "fontSize":"20px",
    "color":"black",
    "height":"50px",
    "width":"1000px",
    "left":"270px",
    "textAlign":"left",
    "top":75+"px",
    "userSelect":"text",
  });



  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"New Client Link:",
    "fontSize":"20px",
    "color":"green",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":125+"px",
  });


  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"&lt;a href='"+config['domain']+"/client.html' target='_blank'>"+config['domain']+"/client.html&lt;/a>",
    "fontSize":"20px",
    "color":"black",
    "height":"50px",
    "width":"1000px",
    "left":"270px",
    "textAlign":"left",
    "top":125+"px",
    "userSelect":"text",
  });


  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"New Video Link:",
    "fontSize":"20px",
    "color":"green",
    "height":"50px",
    "width":"250px",
    "left":"0px",
    "textAlign":"right",
    "top":175+"px",
  });


  placeText({
    "parentDiv":"mainInfoHolder",
    "text":"&lt;a href='"+config['domain']+"/video.html'>"+config['domain']+"/video.html&lt;/a>",
    "fontSize":"20px",
    "color":"black",
    "height":"50px",
    "width":"1000px",
    "left":"270px",
    "textAlign":"left",
    "top":175+"px",
    "userSelect":"text",
  });



}



function Comparator(a, b) {
  if (a[0] &lt; b[0]) return -1;
  if (a[0] > b[0]) return 1;
  return 0;
}

function drawConfigInfo(){
  placeText({
    "parentDiv":"mainDivInside",
    "divid":"configInfoContainer",
    "fontSize":"300%",
    "color":"black",
    "height":"800px",
    "width":"800px",
    "left":"00px",
    "top":"275px",
  });


  placeText({
    "parentDiv":"configInfoContainer",
    "text":"Config File Information",
    "color":"black",
    "height":"50px",
    "top":"0px",
  });

  y=50

  myArray=[]
  for(k in window.config){
    myArray.push([window.config[k].length,k,window.config[k]]);
  }
  myArray = myArray.sort(Comparator);

  var first=["location","currentExperiment","packageFolder","domain","webServerRoot","dataFolder","serverType"]
  var second=[]
  for(var k in window.config){
      if(first.indexOf(k)==-1){
        second.push(k)
      }
  }
  var all=first.concat(second);
  for(var k in myArray){
    thisColor="black"
    if(first.indexOf(myArray[k][1])>-1){
      thisColor="red";
    } 
    placeText({
    "parentDiv":"configInfoContainer",
    "text":myArray[k][1]+":",
    "fontSize":"25px",
    "color":"green",
    "height":"50px",
    "width":"300px",
    "left":"0px",
    "textAlign":"right",
    "top":y+"px",
  });

  placeText({
    "parentDiv":"configInfoContainer",
    "text":myArray[k][2],
    "fontSize":"25px",
    "color":thisColor,
    "height":"50px",
    "width":"unset",
    "left":"320px",
    "textAlign":"left",
    "top":(y)+"px",
  });
  y+=50;
}
}




function showServerInfo(msg){
  deleteDiv("monitorTableHolder")
  deleteDiv("taskTableHolder")
  deleteDiv("consoleLinesHolder")
  getMonitorTablesInfo(msg)
  drawServerInfo();
  drawConfigInfo();
}








</code></pre>
</div>

<div class="header">/code/javascript/simulateMouse/simulateMouse.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">#cursorContainer {
    position:absolute;
    display:block;
    width:100px;
    height:100px;
    background-color:transparent;
    border:1px solid transparent;
    z-index: 999;
}
#cursorDiv {
    position:absolute;
    height:30px;
    top:50px;
    left:43px;
    z-index: 1000;
}

#cursorHighlight {
    position:absolute;
    width:70px;
    height:70px;
    top:30px;
    left:23px;
    border-radius: 35px;
    background-color: white;
/*    animation: toggleShow 2s infinite;
    animation-timing-function: ease-out;
*/    opacity: .1;
}
@keyframes toggleShow {
    0%      {background-color: white;}
    50%     {background-color: green;}
    100%    {background-color: white;}
}



#circleDiv {
    background-color: transparent;
    position:absolute;
    height:50px;
    width:50px;
    border-radius: 50px;
    border:3px solid red;
    top:25px;
    left:25px;
    transform:scale(0);
}

#cursorOverlay {
    position:absolute;
    display: block;
    background-color:rgba(0,0,0,0);
    z-index:200;
    left: 0px;
    top:0px;
    width:100%;    
    height:100%;    
    overflow-y:hidden;
    z-index:9999;
}



</code></pre>
</div>

<div class="header">/code/javascript/simulateMouse/simulateMouse.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">function placeCursor(incoming) {
    var x=incoming['x'];
    var y=incoming['y'];
    var cursorContainer = createAndAddDiv("cursorContainer","cursorOverlay");
    cursorContainer.style.left = (x - 50)+"px";
    cursorContainer.style.top = (y - 50)+"px";
    cursorContainer.style.transform = "scale(1)";
    var cursorDiv = createAndAddElement("img","cursorDiv","cursorContainer");
    cursorDiv.src=window.config['domain']+window.config['packageFolder']+"/javascript/simulateMouse/cursor-512.png"

    var cursorHighlight = createAndAddDiv("cursorHighlight","cursorContainer");
    var circleDiv = createAndAddDiv("circleDiv","cursorOverlay");

}



function placeCursorOnDiv(divName){
    theseCoords=getDivPosition(divName,"mainDiv","none");
    placeCursor(theseCoords[0],theseCoords[1]);

}


function moveCursor(incoming) {
    endX=incoming['endX'];
    endY=incoming['endY'];
    time=incoming['time']*1000;
    d=incoming['delay']*1000;
    $("#cursorContainer").velocity({top:incoming['endY']-50,left:incoming['endX']-50},{duration:time,delay:d,queue:false});
}


function cursorDown(incoming) {
    mouseClickCircle(incoming);
    time=150;
    d=incoming['delay']*1000;
    $("#cursorContainer").velocity({scale:".4"},{duration:time,delay:d,queue:false});
    $("#cursorContainer").velocity({scale:"1"},{duration:time,delay:d+time,queue:false});
}

function mouseClickCircle(incoming){
    console.log("mouseClickCircle!!!!!!!!!!!!!!");
    time=150;
    d=incoming['delay']*1000;
    var xVal=incoming['position'][0]
    var yVal=incoming['position'][1]
    $("#circleDiv").velocity({left:xVal-25,top:yVal-25,opacity:"1",scale:"0"},{duration:0,delay:d,queue:false});
    $("#circleDiv").velocity({left:xVal-25,top:yVal-25,opacity:"0",scale:"4"},{duration:8*time,delay:d+time,queue:false});
}


function cursorDownDiv(incoming) {
    mouseClickCircleDiv(incoming);
    time=150;
    d=incoming['delay']*1000;
    $("#cursorContainer").velocity({scale:".4"},{duration:time,delay:d,queue:false,complete: function(elements) {playClickSound();}});
    $("#cursorContainer").velocity({scale:"1"},{duration:time,delay:d+time,queue:false});
}


function mouseClickCircleDiv(incoming){
    console.log("mouseDIVClickCircle!!!!!!!!!!!!!!");
    time=150;
    d=incoming['delay']*1000;
    theseCoords=getDivPosition(incoming["divName"],"mainDiv",incoming["anchor"]);

    var xVal=theseCoords[0]
    var yVal=theseCoords[1]
    $("#circleDiv").velocity({left:xVal-25,top:yVal-25,opacity:"1",scale:"0"},{duration:0,delay:d,queue:false});
    $("#circleDiv").velocity({left:xVal-25,top:yVal-25,opacity:"0",scale:"4"},{duration:8*time,delay:d+time,queue:false});
}



function moveCursorToDiv(incoming){
    var anchor=incoming['anchor'];
    var divName=incoming['divName'];
    if(anchor==undefined){anchor="none";}
    theseCoords=getDivPosition(divName,"mainDiv",anchor);

    var msg={}
    msg['endX']=theseCoords[0];
    msg['endY']=theseCoords[1];
    msg['time']=incoming['time'];
    msg['delay']=incoming['delay'];
    moveCursor(msg);
}


// function cursorDown(partialFunction,time) {
//     cursorDiv=document.getElementById("cursorDiv");
//     cursorDiv.style.transform = null;
//     cursorDiv.style.transition = time+"s linear";
//     cursorDiv.style.transform = "scale(.7)";
//     circleDiv.style.border = "5px solid red";
//     circleDiv.style.transform = "scale(.6)";
//     circleDiv.style.transition = time+"s linear";
//     cursorContainer.addEventListener('webkitTransitionEnd', function () {
//         this.removeEventListener('webkitTransitionEnd', arguments.callee, false);
//         if(partialFunction!=0){partialFunction();}
//         var thisFunction=partial(cursorUp,time);
//         setTimeout(thisFunction,0);
//     }, false);
// }

function cursorUp(time) {
    cursorDiv.style.transform = null;
    cursorDiv.style.transition = time+"s ease";
    cursorDiv.style.transform = "scale(1)";
    circleDiv.style.transition = time+"s ease";
    circleDiv.style.border = "1px solid transparent";
    circleDiv.style.transform = "scale(1)";
    cursorContainer.addEventListener('webkitTransitionEnd', function () {
        this.removeEventListener('webkitTransitionEnd', arguments.callee, false);
        var event3 = new CustomEvent("simulatedMouseClickDone", { "detail": "Simulated Mouse Click is Done" });
        cursorContainer.dispatchEvent(event3);
    }, false);
}




function getDivPosition(divName,relativeDiv,anchor){
    var dc=$("#"+divName)[0].getBoundingClientRect();
    var rdc=$("#"+relativeDiv)[0].getBoundingClientRect();
    var divLeft=dc['left']-rdc['left'];
    var divTop=dc['top']-rdc['top'];
    var divHeight=dc['bottom']-dc['top'];
    var divWidth=dc['right']-dc['left'];
    if(anchor=="south"){
        x=divLeft+divWidth/2;
        y=divTop+divHeight;
    }
    else if(anchor=="north"){
        x=divLeft+divWidth/2;
        y=divTop;
    }
    else if(anchor=="west"){
        x=divLeft;
        y=divTop+divHeight/2;
    }
    else if(anchor=="east"){
        x=divLeft+divWidth;
        y=divTop+divHeight/2;
    }
    else{
        x=divLeft+divWidth/2;
        y=divTop+divHeight/2;
    }
    return [x,y]
}

function getCursorPosition(){
    thisTransform=cursorContainer.style.transform;
    x=parseFloat(cursorContainer.style.transform.substring(thisTransform.indexOf("(")+1,thisTransform.indexOf(",")-2))+50;
    y=parseFloat(cursorContainer.style.transform.substring(thisTransform.indexOf(",")+1,thisTransform.indexOf(")")-2))+50;
    return [x,y]
}

function moveCursorToDivOLD(divName,time,anchor){
    if(anchor==undefined){anchor="none";}
    theseCoords=getDivPosition(divName,"mainDiv",anchor);
    moveCursor(theseCoords[0],theseCoords[1],time);
}


function loadClickSound(incoming){
    deleteDiv("clickMp3Div");
    var video = document.createElement('video');
    video.id = 'clickMp3Div';
    video.src = window.config['packageFolder']+'/javascript/simulateMouse/mouseClick.mp3';
    video.playbackRate = 1;
    video.height='0px';
    video.preload='auto'
    document.body.appendChild(video);
}


function playClickSound(){
    console.log("PLAYCLICK SOUNDS")
    document.getElementById("clickMp3Div").play();    
}
function clickCursor(partialFunction){
    setTimeout(cursorDown,0,partialFunction);
}


function drawCursorOverlay(incoming){
    var cursorOverlay = createAndAddDiv("cursorOverlay","mainDiv")
    cursorOverlay.style.zIndex = "599900";
}
function deleteCursorOverlay(incoming){
    deleteDiv("cursorOverlay");
}



function startMouseSequence(sequence,timeIn){
    totalTime=sequence[0][1];
    window.mouseSequenceIndex=0;
    if(timeIn>0){
        while(totalTime&lt;=timeIn){
            if(sequence[window.mouseSequenceIndex][0]=="click"){
                sequence[window.mouseSequenceIndex][2]();
            }
            else if(sequence[window.mouseSequenceIndex][0]=="moveToDiv"){
                moveCursorToDiv(sequence[window.mouseSequenceIndex][2],0);
            }
            else if(sequence[window.mouseSequenceIndex][0]=="moveToPoint"){
                moveCursor(sequence[window.mouseSequenceIndex][2][0],sequence[window.mouseSequenceIndex][2][1],0);
            }
            window.mouseSequenceIndex=window.mouseSequenceIndex+1;    
            if(window.mouseSequenceIndex==sequence.length){
                break;
            }
            else{
                totalTime=totalTime+sequence[window.mouseSequenceIndex][1];
            }
        }
    }
    //console.log(totalTime);
    if(window.mouseSequenceIndex&lt;sequence.length){
        denominator=sequence[window.mouseSequenceIndex][1]
        sequence[window.mouseSequenceIndex][1]=totalTime-timeIn;
        fraction=sequence[window.mouseSequenceIndex][1]/denominator;
        start=getCursorPosition();
        if(sequence[window.mouseSequenceIndex][0]=="moveToDiv"){
            end=getDivPosition(sequence[window.mouseSequenceIndex][2],"mainDiv");
            intermediateX=fraction*start[0]+(1-fraction)*end[0]
            intermediateY=fraction*start[1]+(1-fraction)*end[1]
            moveCursor(intermediateX,intermediateY,0);
        }
        else if(sequence[window.mouseSequenceIndex][0]=="moveToPoint"){
            end=sequence[window.mouseSequenceIndex][2];
            intermediateX=fraction*start[0]+(1-fraction)*end[0]
            intermediateY=fraction*start[1]+(1-fraction)*end[1]
            moveCursor(intermediateX,intermediateY,0);
        }
        performMouseSequenceEntry(sequence[window.mouseSequenceIndex],sequence)
    }
}


function nextMouseSequenceItem(sequence){
    window.mouseSequenceIndex=window.mouseSequenceIndex+1;
    if(window.mouseSequenceIndex&lt;sequence.length){
        performMouseSequenceEntry(sequence[window.mouseSequenceIndex],sequence)
    }
}



function performMouseSequenceEntry(entry,sequence){
    if(entry[0]=="moveToPoint"){
        //[type,time,point]
        pf=partial(moveCursor,entry[2][0],entry[2][1],entry[1]/1000);
        setTimeout(pf,0);
        cursorContainer.addEventListener('simulatedMouseMoveDone', function () {
            this.removeEventListener('simulatedMouseMoveDone', arguments.callee, false);
            pf=partial(nextMouseSequenceItem,sequence);
            setTimeout(pf,0);
        }, false);
    }
    else if(entry[0]=="wait"){
        //[type,waitTime]
        pf=partial(nextMouseSequenceItem,sequence);
        setTimeout(pf,entry[1]);
    }
    else if(entry[0]=="click"){
        //[type,time,partialFunction]
        cursorDown(entry[2],entry[1]/2000);
        cursorContainer.addEventListener('simulatedMouseClickDone', function () {
            this.removeEventListener('simulatedMouseClickDone', arguments.callee, false);
            pf=partial(nextMouseSequenceItem,sequence);
            setTimeout(pf,0);
        }, false);
    }
    else if(entry[0]=="moveToDiv"){
        //[type,time,div]
        moveCursorToDiv(entry[2],entry[1]/1000);
        cursorContainer.addEventListener('simulatedMouseMoveDone', function () {
            this.removeEventListener('simulatedMouseMoveDone', arguments.callee, false);
            pf=partial(nextMouseSequenceItem,sequence);
            setTimeout(pf,0);
        }, false);
    }
}


function test(pin){
    console.log(pin);
}



</code></pre>
</div>

<div class="header">/code/javascript/velocity.min.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">/*! VelocityJS.org (1.3.2). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License */
/*! VelocityJS.org jQuery Shim (1.0.1). (C) 2014 The jQuery Foundation. MIT @license: en.wikipedia.org/wiki/MIT_License. */
!function(a){"use strict";function b(a){var b=a.length,d=c.type(a);return"function"!==d&&!c.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a))}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return a&&a===a.window},c.type=function(a){return a?"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a:a+""},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;f&lt;g&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(a.hasOwnProperty(f)&&(e=c.apply(a[f],d),e===!1))break}else if(h)for(;f&lt;g&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(a.hasOwnProperty(f)&&(e=c.call(a[f],f,a[f]),e===!1))break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var h=a[c.expando]||(a[c.expando]=++c.uuid);return d[h]=d[h]||{},d[h][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&(b?c.each(b,function(a,b){delete f[b]}):delete d[e])},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);i&lt;j;i++)if(f=arguments[i])for(e in f)f.hasOwnProperty(e)&&(a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d)));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return a&&(b(Object(a))?!function(a,b){for(var c=+b.length,d=0,e=a.length;d&lt;c;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(a){for(var b=a.offsetParent;b&&"html"!==b.nodeName.toLowerCase()&&b.style&&"static"===b.style.position;)b=b.offsetParent;return b||document}var b=this[0],d=a(b),e=this.offset(),f=/^(?:body|html)$/i.test(d.nodeName)?{top:0,left:0}:c(d).offset();return e.top-=parseFloat(b.style.marginTop)||0,e.left-=parseFloat(b.style.marginLeft)||0,d.style&&(f.top+=parseFloat(d.style.borderTopWidth)||0,f.left+=parseFloat(d.style.borderLeftWidth)||0),{top:e.top-f.top,left:e.left-f.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i&lt;h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof define&&define.amd?define(a):a()}(function(){"use strict";return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b&lt;c;){var e=a[b];e&&d.push(e)}return d}function f(a){return q.isWrapped(a)?a=[].slice.call(a):q.isNode(a)&&(a=[a]),a}function g(a){var b=m.data(a,"velocity");return null===b?d:b}function h(a){return function(b){return Math.round(b*a)*(1/a)}}function i(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;e&lt;p;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;b&lt;t;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h&lt;s);return g}function n(b){for(var c=0,e=1,f=t-1;e!==f&&x[e]&lt;=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0===i?h:m(b,c,c+u)}function o(){y=!0,a===c&&d===e||l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;w&lt;4;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function j(a,b){var c=a;return q.isString(a)?u.Easings[a]||(c=!1):c=q.isArray(a)&&1===a.length?h.apply(null,a):q.isArray(a)&&2===a.length?v.apply(null,a.concat([b])):!(!q.isArray(a)||4!==a.length)&&i.apply(null,a),c===!1&&(c=u.Easings[u.defaults.easing]?u.defaults.easing:t),c}function k(a){if(a){var b=u.timestamp&&a!==!0?a:p.now(),c=u.State.calls.length;c>1e4&&(u.State.calls=e(u.State.calls),c=u.State.calls.length);for(var f=0;f&lt;c;f++)if(u.State.calls[f]){var h=u.State.calls[f],i=h[0],j=h[2],o=h[3],r=!!o,s=null;o||(o=u.State.calls[f][3]=b-16);for(var t=Math.min((b-o)/j.duration,1),v=0,x=i.length;v&lt;x;v++){var z=i[v],A=z.element;if(g(A)){var B=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var C=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];m.each(C,function(a,b){w.setPropertyValue(A,"display",b)})}w.setPropertyValue(A,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&w.setPropertyValue(A,"visibility",j.visibility);for(var D in z)if(z.hasOwnProperty(D)&&"element"!==D){var E,F=z[D],G=q.isString(F.easing)?u.Easings[F.easing]:F.easing;if(q.isString(F.pattern)){var H=1===t?function(a,b){return F.endValue[b]}:function(a,b){var c=F.startValue[b],d=F.endValue[b]-c;return c+d*G(t,j,d)};E=F.pattern.replace(/{(\d+)}/g,H)}else if(1===t)E=F.endValue;else{var I=F.endValue-F.startValue;E=F.startValue+I*G(t,j,I)}if(!r&&E===F.currentValue)continue;if(F.currentValue=E,"tween"===D)s=E;else{var J;if(w.Hooks.registered[D]){J=w.Hooks.getRoot(D);var K=g(A).rootPropertyValueCache[J];K&&(F.rootPropertyValue=K)}var L=w.setPropertyValue(A,D,F.currentValue+(n&lt;9&&0===parseFloat(E)?"":F.unitType),F.rootPropertyValue,F.scrollData);w.Hooks.registered[D]&&(w.Normalizations.registered[J]?g(A).rootPropertyValueCache[J]=w.Normalizations.registered[J]("extract",null,L[1]):g(A).rootPropertyValueCache[J]=L[1]),"transform"===L[0]&&(B=!0)}}j.mobileHA&&g(A).transformCache.translate3d===d&&(g(A).transformCache.translate3d="(0px, 0px, 0px)",B=!0),B&&w.flushTransformCache(A)}}j.display!==d&&"none"!==j.display&&(u.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(u.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],t,Math.max(0,o+j.duration-b),o,s),1===t&&l(f)}}u.State.isTicking&&y(k)}function l(a,b){if(!u.State.calls[a])return!1;for(var c=u.State.calls[a][0],e=u.State.calls[a][1],f=u.State.calls[a][2],h=u.State.calls[a][4],i=!1,j=0,k=c.length;j&lt;k;j++){var l=c[j].element;b||f.loop||("none"===f.display&&w.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&w.setPropertyValue(l,"visibility",f.visibility));var n=g(l);if(f.loop!==!0&&(m.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(m.queue(l)[1]))&&n){n.isAnimating=!1,n.rootPropertyValueCache={};var o=!1;m.each(w.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=n.transformCache[b];n.transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(o=!0,delete n.transformCache[b])}),f.mobileHA&&(o=!0,delete n.transformCache.translate3d),o&&w.flushTransformCache(l),w.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(p){setTimeout(function(){throw p},1)}h&&f.loop!==!0&&h(e),n&&f.loop===!0&&!b&&(m.each(n.tweensContainer,function(a,b){if(/^rotate/.test(a)&&(parseFloat(b.startValue)-parseFloat(b.endValue))%360===0){var c=b.startValue;b.startValue=b.endValue,b.endValue=c}/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),u(l,"reverse",{loop:!0,delay:f.delay})),f.queue!==!1&&m.dequeue(l,f.queue)}u.State.calls[a]=!1;for(var q=0,r=u.State.calls.length;q&lt;r;q++)if(u.State.calls[q]!==!1){i=!0;break}i===!1&&(u.State.isTicking=!1,delete u.State.calls,u.State.calls=[])}var m,n=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="&lt;!--[if IE "+a+"]>&lt;span>&lt;/span>&lt;![endif]-->",b.getElementsByTagName("span").length)return b=null,a}return d}(),o=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),p=function(){var a=b.performance||{};if(!a.hasOwnProperty("now")){var c=a.timing&&a.timing.domComplete?a.timing.domComplete:(new Date).getTime();a.now=function(){return(new Date).getTime()-c}}return a}(),q={isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isNodeList:function(a){return"object"==typeof a&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(a))&&a.length!==d&&(0===a.length||"object"==typeof a[0]&&a[0].nodeType>0)},isWrapped:function(a){return a&&(q.isArray(a)||q.isNumber(a.length)&&!q.isString(a)&&!q.isFunction(a))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},r=!1;if(a.fn&&a.fn.jquery?(m=a,r=!0):m=b.Velocity.Utilities,n&lt;=8&&!r)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(n&lt;=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var s=400,t="swing",u={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:m,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:s,easing:t,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0,promiseRejectEmpty:!0},init:function(a){m.data(a,"velocity",{isSVG:q.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:3,patch:2},debug:!1,timestamp:!0};b.pageYOffset!==d?(u.State.scrollAnchor=b,u.State.scrollPropertyLeft="pageXOffset",u.State.scrollPropertyTop="pageYOffset"):(u.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,u.State.scrollPropertyLeft="scrollLeft",u.State.scrollPropertyTop="scrollTop");var v=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function d(a,b,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(a=parseFloat(a)||500,b=parseFloat(b)||20,e=e||null,i.tension=a,i.friction=b,f=null!==e,f?(k=d(a,b),g=k/e*m):g=m;;)if(h=c(h||i,g),j.push(1+h.x),k+=16,!(Math.abs(h.x)>l&&Math.abs(h.v)>l))break;return f?function(a){return j[a*(j.length-1)|0]}:k}}();u.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},m.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){u.Easings[b[0]]=i.apply(null,b[1])});var w=u.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a&lt;w.Lists.colors.length;a++){var b="color"===w.Lists.colors[a]?"0 0 0 1":"255 255 255 1";w.Hooks.templates[w.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(n)for(c in w.Hooks.templates)if(w.Hooks.templates.hasOwnProperty(c)){d=w.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(w.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),w.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in w.Hooks.templates)if(w.Hooks.templates.hasOwnProperty(c)){d=w.Hooks.templates[c],e=d[0].split(" ");for(var g in e)if(e.hasOwnProperty(g)){var h=c+e[g],i=g;w.Hooks.registered[h]=[c,i]}}},getRoot:function(a){var b=w.Hooks.registered[a];return b?b[0]:a},cleanRootPropertyValue:function(a,b){return w.RegEx.valueUnwrap.test(b)&&(b=b.match(w.RegEx.valueUnwrap)[1]),w.Values.isCSSNullValue(b)&&(b=w.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=w.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=w.Hooks.cleanRootPropertyValue(d,b),b.toString().match(w.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=w.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=w.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(w.RegEx.valueSplit),e[h]=b,f=e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return w.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(w.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return u.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(n&lt;=8)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":return c;case"inject":return c}}},register:function(){function a(a,b,c){var d="border-box"===w.getPropertyValue(b,"boxSizing").toString().toLowerCase();if(d===(c||!1)){var e,f,g=0,h="width"===a?["Left","Right"]:["Top","Bottom"],i=["padding"+h[0],"padding"+h[1],"border"+h[0]+"Width","border"+h[1]+"Width"];for(e=0;e&lt;i.length;e++)f=parseFloat(w.getPropertyValue(b,i[e])),isNaN(f)||(g+=f);return c?-g:g}return 0}function b(b,c){return function(d,e,f){switch(d){case"name":return b;case"extract":return parseFloat(f)+a(b,e,c);case"inject":return parseFloat(f)-a(b,e,c)+"px"}}}n&&!(n>9)||u.State.isGingerbread||(w.Lists.transformsBase=w.Lists.transformsBase.concat(w.Lists.transforms3D));for(var c=0;c&lt;w.Lists.transformsBase.length;c++)!function(){var a=w.Lists.transformsBase[c];w.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[a]===d?/^scale/i.test(a)?1:0:g(c).transformCache[a].replace(/[()]/g,"");case"inject":var f=!1;switch(a.substr(0,a.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":u.State.isAndroid&&g(c).transformCache[a]===d&&e&lt;1&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":f=!/(deg|\d)$/i.test(e);break;case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[a]="("+e+")"),g(c).transformCache[a]}}}();for(var e=0;e&lt;w.Lists.colors.length;e++)!function(){var a=w.Lists.colors[e];w.Normalizations.registered[a]=function(b,c,e){switch(b){case"name":return a;case"extract":var f;if(w.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:w.RegEx.isHex.test(e)?g="rgb("+w.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(w.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return(!n||n>8)&&3===f.split(" ").length&&(f+=" 1"),f;case"inject":return/^rgb/.test(e)?e:(n&lt;=8?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(n&lt;=8?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")")}}}();w.Normalizations.registered.innerWidth=b("width",!0),w.Normalizations.registered.innerHeight=b("height",!0),w.Normalizations.registered.outerWidth=b("width"),w.Normalizations.registered.outerHeight=b("height")}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(n||u.State.isAndroid&&!u.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(u.State.prefixMatches[a])return[u.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;c&lt;d;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),q.isString(u.State.prefixElement.style[e]))return u.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return!a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){if(a)if(a.classList)a.classList.add(b);else if(q.isString(a.className))a.className+=(a.className.length?" ":"")+b;else{var c=a.getAttribute(n&lt;=7?"className":"class")||"";a.setAttribute("class",c+(c?" ":"")+b)}},removeClass:function(a,b){if(a)if(a.classList)a.classList.remove(b);else if(q.isString(a.className))a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ");else{var c=a.getAttribute(n&lt;=7?"className":"class")||"";a.setAttribute("class",c.replace(new RegExp("(^|s)"+b.split(" ").join("|")+"(s|$)","gi")," "))}}},getPropertyValue:function(a,c,e,f){function h(a,c){var e=0;if(n&lt;=8)e=m.css(a,c);else{var i=!1;/^(width|height)$/.test(c)&&0===w.getPropertyValue(a,"display")&&(i=!0,w.setPropertyValue(a,"display",w.Values.getDisplayType(a)));var j=function(){i&&w.setPropertyValue(a,"display","none")};if(!f){if("height"===c&&"border-box"!==w.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(w.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(w.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(w.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(w.getPropertyValue(a,"paddingBottom"))||0);return j(),k}if("width"===c&&"border-box"!==w.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(w.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(w.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(w.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(w.getPropertyValue(a,"paddingRight"))||0);return j(),l}}var o;o=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),e=9===n&&"filter"===c?o.getPropertyValue(c):o[c],""!==e&&null!==e||(e=a.style[c]),j()}if("auto"===e&&/^(top|right|bottom|left)$/i.test(c)){var p=h(a,"position");("fixed"===p||"absolute"===p&&/top|left/i.test(c))&&(e=m(a).position()[c]+"px")}return e}var i;if(w.Hooks.registered[c]){var j=c,k=w.Hooks.getRoot(j);e===d&&(e=w.getPropertyValue(a,w.Names.prefixCheck(k)[0])),w.Normalizations.registered[k]&&(e=w.Normalizations.registered[k]("extract",a,e)),i=w.Hooks.extractValue(j,e)}else if(w.Normalizations.registered[c]){var l,o;l=w.Normalizations.registered[c]("name",a),"transform"!==l&&(o=h(a,w.Names.prefixCheck(l)[0]),w.Values.isCSSNullValue(o)&&w.Hooks.templates[c]&&(o=w.Hooks.templates[c][1])),i=w.Normalizations.registered[c]("extract",a,o)}if(!/^[\d-]/.test(i)){var p=g(a);if(p&&p.isSVG&&w.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(q){i=0}else i=a.getAttribute(c);else i=h(a,w.Names.prefixCheck(c)[0])}return w.Values.isCSSNullValue(i)&&(i=0),u.debug>=2&&console.log("Get "+c+": "+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(w.Normalizations.registered[c]&&"transform"===w.Normalizations.registered[c]("name",a))w.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(w.Hooks.registered[c]){var i=c,j=w.Hooks.getRoot(c);e=e||w.getPropertyValue(a,j),d=w.Hooks.injectValue(i,d,e),c=j}if(w.Normalizations.registered[c]&&(d=w.Normalizations.registered[c]("inject",a,d),c=w.Normalizations.registered[c]("name",a)),h=w.Names.prefixCheck(c)[0],n&lt;=8)try{a.style[h]=d}catch(k){u.debug&&console.log("Browser does not support ["+d+"] for ["+h+"]")}else{var l=g(a);l&&l.isSVG&&w.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d}u.debug>=2&&console.log("Set "+c+" ("+h+"): "+d)}return[h,d]},flushTransformCache:function(a){var b="",c=g(a);if((n||u.State.isAndroid&&!u.State.isChrome)&&c&&c.isSVG){var d=function(b){return parseFloat(w.getPropertyValue(a,b))},e={translate:[d("translateX"),d("translateY")],skewX:[d("skewX")],skewY:[d("skewY")],scale:1!==d("scale")?[d("scale"),d("scale")]:[d("scaleX"),d("scaleY")],rotate:[d("rotateZ"),0,0]};m.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),e[a]&&(b+=a+"("+e[a].join(" ")+") ",delete e[a])})}else{var f,h;m.each(g(a).transformCache,function(c){return f=g(a).transformCache[c],"transformPerspective"===c?(h=f,!0):(9===n&&"rotateZ"===c&&(c="rotate"),void(b+=c+f+" "))}),h&&(b="perspective"+h+" "+b)}w.setPropertyValue(a,"transform",b)}};w.Hooks.register(),w.Normalizations.register(),u.hook=function(a,b,c){var e;return a=f(a),m.each(a,function(a,f){if(g(f)===d&&u.init(f),c===d)e===d&&(e=w.getPropertyValue(f,b));else{var h=w.setPropertyValue(f,b,c);"transform"===h[0]&&u.CSS.flushTransformCache(f),e=h}}),e};var x=function(){function a(){return i?y.promise||null:n}function e(a,e){function f(f){var n,o;if(i.begin&&0===A)try{i.begin.call(p,p)}catch(s){setTimeout(function(){throw s},1)}if("scroll"===D){var v,x,B,C=/^x$/i.test(i.axis)?"Left":"Top",E=parseFloat(i.offset)||0;i.container?q.isWrapped(i.container)||q.isNode(i.container)?(i.container=i.container[0]||i.container,v=i.container["scroll"+C],B=v+m(a).position()[C.toLowerCase()]+E):i.container=null:(v=u.State.scrollAnchor[u.State["scrollProperty"+C]],x=u.State.scrollAnchor[u.State["scrollProperty"+("Left"===C?"Top":"Left")]],B=m(a).offset()[C.toLowerCase()]+E),l={scroll:{rootPropertyValue:!1,startValue:v,currentValue:v,endValue:B,unitType:"",easing:i.easing,scrollData:{container:i.container,direction:C,alternateValue:x}},element:a},u.debug&&console.log("tweensContainer (scroll): ",l.scroll,a)}else if("reverse"===D){if(n=g(a),!n)return;if(!n.tweensContainer)return void m.dequeue(a,i.queue);"none"===n.opts.display&&(n.opts.display="auto"),"hidden"===n.opts.visibility&&(n.opts.visibility="visible"),n.opts.loop=!1,n.opts.begin=null,n.opts.complete=null,t.easing||delete i.easing,t.duration||delete i.duration,i=m.extend({},n.opts,i),o=m.extend(!0,{},n?n.tweensContainer:null);for(var F in o)if(o.hasOwnProperty(F)&&"element"!==F){var G=o[F].startValue;o[F].startValue=o[F].currentValue=o[F].endValue,o[F].endValue=G,q.isEmptyObject(t)||(o[F].easing=i.easing),u.debug&&console.log("reverse tweensContainer ("+F+"): "+JSON.stringify(o[F]),a)}l=o}else if("start"===D){n=g(a),n&&n.tweensContainer&&n.isAnimating===!0&&(o=n.tweensContainer);var H=function(b,c){var d,f,g;return q.isFunction(b)&&(b=b.call(a,e,z)),q.isArray(b)?(d=b[0],!q.isArray(b[1])&&/^[\d-]/.test(b[1])||q.isFunction(b[1])||w.RegEx.isHex.test(b[1])?g=b[1]:q.isString(b[1])&&!w.RegEx.isHex.test(b[1])&&u.Easings[b[1]]||q.isArray(b[1])?(f=c?b[1]:j(b[1],i.duration),g=b[2]):g=b[1]||b[2]):d=b,c||(f=f||i.easing),q.isFunction(d)&&(d=d.call(a,e,z)),q.isFunction(g)&&(g=g.call(a,e,z)),[d||0,f,g]},K=function(e,f){var g,j=w.Hooks.getRoot(e),k=!1,p=f[0],r=f[1],s=f[2];if(!(n&&n.isSVG||"tween"===j||w.Names.prefixCheck(j)[1]!==!1||w.Normalizations.registered[j]!==d))return void(u.debug&&console.log("Skipping ["+j+"] due to a lack of browser support."));(i.display!==d&&null!==i.display&&"none"!==i.display||i.visibility!==d&&"hidden"!==i.visibility)&&/opacity|filter/.test(e)&&!s&&0!==p&&(s=0),i._cacheValues&&o&&o[e]?(s===d&&(s=o[e].endValue+o[e].unitType),k=n.rootPropertyValueCache[j]):w.Hooks.registered[e]?s===d?(k=w.getPropertyValue(a,j),s=w.getPropertyValue(a,e,k)):k=w.Hooks.templates[j][1]:s===d&&(s=w.getPropertyValue(a,e));var t,v,x,y=!1,z=function(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=w.Values.getUnitType(a)),[d,c]};if(q.isString(s)&&q.isString(p)){g="";for(var A=0,B=0,C=[],D=[];A&lt;s.length&&B&lt;p.length;){var E=s[A],F=p[B];if(/[\d\.]/.test(E)&&/[\d\.]/.test(F)){for(var G=E,H=F,J=".",K=".";++A&lt;s.length;){if(E=s[A],E===J)J="..";else if(!/\d/.test(E))break;G+=E}for(;++B&lt;p.length;){if(F=p[B],F===K)K="..";else if(!/\d/.test(F))break;H+=F}G===H?g+=G:(g+="{"+C.length+"}",C.push(parseFloat(G)),D.push(parseFloat(H)))}else{if(E!==F)break;g+=E,A++,B++}}A===s.length&&B===p.length||(u.debug&&console.error('Trying to pattern match mis-matched strings ["'+p+'", "'+s+'"]'),g=d),g&&(C.length?(u.debug&&console.log('Pattern found "'+g+'" -> ',C,D,s,p),s=C,p=D,v=x=""):g=d)}g||(t=z(e,s),s=t[0],x=t[1],t=z(e,p),p=t[0].replace(/^([+-\/*])=/,function(a,b){return y=b,""}),v=t[1],s=parseFloat(s)||0,p=parseFloat(p)||0,"%"===v&&(/^(fontSize|lineHeight)$/.test(e)?(p/=100,v="em"):/^scale/.test(e)?(p/=100,v=""):/(Red|Green|Blue)$/i.test(e)&&(p=p/100*255,v="")));var L=function(){var d={myParent:a.parentNode||c.body,position:w.getPropertyValue(a,"position"),fontSize:w.getPropertyValue(a,"fontSize")},e=d.position===I.lastPosition&&d.myParent===I.lastParent,f=d.fontSize===I.lastFontSize;I.lastParent=d.myParent,I.lastPosition=d.position,I.lastFontSize=d.fontSize;var g=100,h={};if(f&&e)h.emToPx=I.lastEmToPx,h.percentToPxWidth=I.lastPercentToPxWidth,h.percentToPxHeight=I.lastPercentToPxHeight;else{var i=n&&n.isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");u.init(i),d.myParent.appendChild(i),m.each(["overflow","overflowX","overflowY"],function(a,b){u.CSS.setPropertyValue(i,b,"hidden")}),u.CSS.setPropertyValue(i,"position",d.position),u.CSS.setPropertyValue(i,"fontSize",d.fontSize),u.CSS.setPropertyValue(i,"boxSizing","content-box"),m.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){u.CSS.setPropertyValue(i,b,g+"%")}),u.CSS.setPropertyValue(i,"paddingLeft",g+"em"),h.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(w.getPropertyValue(i,"width",null,!0))||1)/g,h.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(w.getPropertyValue(i,"height",null,!0))||1)/g,h.emToPx=I.lastEmToPx=(parseFloat(w.getPropertyValue(i,"paddingLeft"))||1)/g,d.myParent.removeChild(i)}return null===I.remToPx&&(I.remToPx=parseFloat(w.getPropertyValue(c.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(b.innerWidth)/100,I.vhToPx=parseFloat(b.innerHeight)/100),h.remToPx=I.remToPx,h.vwToPx=I.vwToPx,h.vhToPx=I.vhToPx,u.debug>=1&&console.log("Unit ratios: "+JSON.stringify(h),a),h};if(/[\/*]/.test(y))v=x;else if(x!==v&&0!==s)if(0===p)v=x;else{h=h||L();var M=/margin|padding|left|right|width|text|word|letter/i.test(e)||/X$/.test(e)||"x"===e?"x":"y";switch(x){case"%":s*="x"===M?h.percentToPxWidth:h.percentToPxHeight;break;case"px":break;default:s*=h[x+"ToPx"]}switch(v){case"%":s*=1/("x"===M?h.percentToPxWidth:h.percentToPxHeight);break;case"px":break;default:s*=1/h[v+"ToPx"]}}switch(y){case"+":p=s+p;break;case"-":p=s-p;break;case"*":p=s*p;break;case"/":p=s/p}l[e]={rootPropertyValue:k,startValue:s,currentValue:s,endValue:p,unitType:v,easing:r},g&&(l[e].pattern=g),u.debug&&console.log("tweensContainer ("+e+"): "+JSON.stringify(l[e]),a)};for(var L in r)if(r.hasOwnProperty(L)){var M=w.Names.camelCase(L),N=H(r[L]);if(w.Lists.colors.indexOf(M)>=0){var O=N[0],P=N[1],Q=N[2];if(w.RegEx.isHex.test(O)){for(var R=["Red","Green","Blue"],S=w.Values.hexToRgb(O),T=Q?w.Values.hexToRgb(Q):d,U=0;U&lt;R.length;U++){var V=[S[U]];P&&V.push(P),T!==d&&V.push(T[U]),K(M+R[U],V)}continue}}K(M,N)}l.element=a}l.element&&(w.Values.addClass(a,"velocity-animating"),J.push(l),n=g(a),n&&(""===i.queue&&(n.tweensContainer=l,n.opts=i),n.isAnimating=!0),A===z-1?(u.State.calls.push([J,p,i,null,y.resolver]),u.State.isTicking===!1&&(u.State.isTicking=!0,k())):A++)}var h,i=m.extend({},u.defaults,t),l={};switch(g(a)===d&&u.init(a),parseFloat(i.delay)&&i.queue!==!1&&m.queue(a,i.queue,function(b){
u.velocityQueueEntryFlag=!0,g(a).delayTimer={setTimeout:setTimeout(b,parseFloat(i.delay)),next:b}}),i.duration.toString().toLowerCase()){case"fast":i.duration=200;break;case"normal":i.duration=s;break;case"slow":i.duration=600;break;default:i.duration=parseFloat(i.duration)||1}u.mock!==!1&&(u.mock===!0?i.duration=i.delay=1:(i.duration*=parseFloat(u.mock)||1,i.delay*=parseFloat(u.mock)||1)),i.easing=j(i.easing,i.duration),i.begin&&!q.isFunction(i.begin)&&(i.begin=null),i.progress&&!q.isFunction(i.progress)&&(i.progress=null),i.complete&&!q.isFunction(i.complete)&&(i.complete=null),i.display!==d&&null!==i.display&&(i.display=i.display.toString().toLowerCase(),"auto"===i.display&&(i.display=u.CSS.Values.getDisplayType(a))),i.visibility!==d&&null!==i.visibility&&(i.visibility=i.visibility.toString().toLowerCase()),i.mobileHA=i.mobileHA&&u.State.isMobile&&!u.State.isGingerbread,i.queue===!1?i.delay?setTimeout(f,i.delay):f():m.queue(a,i.queue,function(a,b){return b===!0?(y.promise&&y.resolver(p),!0):(u.velocityQueueEntryFlag=!0,void f(a))}),""!==i.queue&&"fx"!==i.queue||"inprogress"===m.queue(a)[0]||m.dequeue(a)}var h,i,n,o,p,r,t,v=arguments[0]&&(arguments[0].p||m.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||q.isString(arguments[0].properties));q.isWrapped(this)?(i=!1,o=0,p=this,n=this):(i=!0,o=1,p=v?arguments[0].elements||arguments[0].e:arguments[0]);var y={promise:null,resolver:null,rejecter:null};if(i&&u.Promise&&(y.promise=new u.Promise(function(a,b){y.resolver=a,y.rejecter=b})),v?(r=arguments[0].properties||arguments[0].p,t=arguments[0].options||arguments[0].o):(r=arguments[o],t=arguments[o+1]),p=f(p),!p)return void(y.promise&&(r&&t&&t.promiseRejectEmpty===!1?y.resolver():y.rejecter()));var z=p.length,A=0;if(!/^(stop|finish|finishAll)$/i.test(r)&&!m.isPlainObject(t)){var B=o+1;t={};for(var C=B;C&lt;arguments.length;C++)q.isArray(arguments[C])||!/^(fast|normal|slow)$/i.test(arguments[C])&&!/^\d/.test(arguments[C])?q.isString(arguments[C])||q.isArray(arguments[C])?t.easing=arguments[C]:q.isFunction(arguments[C])&&(t.complete=arguments[C]):t.duration=arguments[C]}var D;switch(r){case"scroll":D="scroll";break;case"reverse":D="reverse";break;case"finish":case"finishAll":case"stop":m.each(p,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer),"finishAll"!==r||t!==!0&&!q.isString(t)||(m.each(m.queue(b,q.isString(t)?t:""),function(a,b){q.isFunction(b)&&b()}),m.queue(b,q.isString(t)?t:"",[]))});var E=[];return m.each(u.State.calls,function(a,b){b&&m.each(b[1],function(c,e){var f=t===d?"":t;return f!==!0&&b[2].queue!==f&&(t!==d||b[2].queue!==!1)||void m.each(p,function(c,d){if(d===e)if((t===!0||q.isString(t))&&(m.each(m.queue(d,q.isString(t)?t:""),function(a,b){q.isFunction(b)&&b(null,!0)}),m.queue(d,q.isString(t)?t:"",[])),"stop"===r){var h=g(d);h&&h.tweensContainer&&f!==!1&&m.each(h.tweensContainer,function(a,b){b.endValue=b.currentValue}),E.push(a)}else"finish"!==r&&"finishAll"!==r||(b[2].duration=1)})})}),"stop"===r&&(m.each(E,function(a,b){l(b,!0)}),y.promise&&y.resolver(p)),a();default:if(!m.isPlainObject(r)||q.isEmptyObject(r)){if(q.isString(r)&&u.Redirects[r]){h=m.extend({},t);var F=h.duration,G=h.delay||0;return h.backwards===!0&&(p=m.extend(!0,[],p).reverse()),m.each(p,function(a,b){parseFloat(h.stagger)?h.delay=G+parseFloat(h.stagger)*a:q.isFunction(h.stagger)&&(h.delay=G+h.stagger.call(b,a,z)),h.drag&&(h.duration=parseFloat(F)||(/^(callout|transition)/.test(r)?1e3:s),h.duration=Math.max(h.duration*(h.backwards?1-a/z:(a+1)/z),.75*h.duration,200)),u.Redirects[r].call(b,b,h||{},a,z,p,y.promise?y:d)}),a()}var H="Velocity: First argument ("+r+") was not a property map, a known action, or a registered redirect. Aborting.";return y.promise?y.rejecter(new Error(H)):console.log(H),a()}D="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},J=[];m.each(p,function(a,b){q.isNode(b)&&e(b,a)}),h=m.extend({},u.defaults,t),h.loop=parseInt(h.loop,10);var K=2*h.loop-1;if(h.loop)for(var L=0;L&lt;K;L++){var M={delay:h.delay,progress:h.progress};L===K-1&&(M.display=h.display,M.visibility=h.visibility,M.complete=h.complete),x(p,"reverse",M)}return a()};u=m.extend(x,u),u.animate=x;var y=b.requestAnimationFrame||o;if(!u.State.isMobile&&c.hidden!==d){var z=function(){c.hidden?(y=function(a){return setTimeout(function(){a(!0)},16)},k()):y=b.requestAnimationFrame||o};z(),c.addEventListener("visibilitychange",z)}return a.Velocity=u,a!==b&&(a.fn.velocity=x,a.fn.velocity.defaults=u.defaults),m.each(["Down","Up"],function(a,b){u.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.begin,k=i.complete,l={},n={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""};i.display===d&&(i.display="Down"===b?"inline"===u.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){0===e&&j&&j.call(g,g);for(var c in n)if(n.hasOwnProperty(c)){l[c]=a.style[c];var d=w.getPropertyValue(a,c);n[c]="Down"===b?[d,0]:[0,d]}l.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in l)l.hasOwnProperty(b)&&(a.style[b]=l[b]);e===f-1&&(k&&k.call(g,g),h&&h.resolver(g))},u(a,n,i)}}),m.each(["In","Out"],function(a,b){u.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.complete,k={opacity:"In"===b?1:0};0!==e&&(i.begin=null),e!==f-1?i.complete=null:i.complete=function(){j&&j.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),u(this,k,i)}}),u}(window.jQuery||window.Zepto||window,window,window?window.document:void 0)});
</code></pre>
</div>

<div class="header">/code/javascript/video.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">var myVideo ={
  source:'http://techslides.com/demos/sample-videos/small.mp4',
  videoCreated:false,
  videoRunning:false,
  videoTime:0,
  create:function (source){
    var videoDiv = document.getElementById("videoDiv");
    if(videoDiv!=null){ 
      document.getElementsByTagName('body')[0].removeChild(videoDiv);
    }
    var videoDiv = document.createElement('div');
    videoDiv.id = 'videoDiv';
    document.getElementsByTagName('body')[0].appendChild(videoDiv);

    var video = document.createElement('video');
    video.id = 'videoHolder';
    video.src = myVideo.source;
    video.preload='auto'

    var videoTime = document.createElement('h1');
    videoTime.id="videoTime";



    videoDiv.appendChild(video);
    videoDiv.appendChild(videoTime);



    document.getElementById('videoTime').style.backgroundColor='transparent';    
    document.getElementById('videoTime').style.position='absolute';    
    document.getElementById('videoTime').style.bottom='0';    
    document.getElementById('videoTime').style.left='0';    
    document.getElementById('videoTime').style.color='red';    
    document.getElementById('videoTime').style.fontSize='200%';    

  // width: 100%;
  // height:100%;
  // position: absolute;
  // top: 0;
  // left: 0;
  // background-color:rgba(0,0,0,.7);
    document.getElementById('videoHolder').style.width='100%';    
    document.getElementById('videoHolder').style.height='100%';    
    document.getElementById('videoHolder').style.position='absolute';    
    document.getElementById('videoHolder').style.top='0';    
    document.getElementById('videoHolder').style.left='0';    



    myVideo.videoCreated=true;
  },
  show: function (){
    document.getElementById('mainDiv').style.visibility='hidden';
    document.getElementById('videoDiv').style.visibility='visible';    
  },
  start: function (timein){
    //document.getElementById('videoHolder').currentTime = timein+((new Date()).getTime()-window.pressedTimeStart)/1000;
    document.getElementById('videoHolder').play();
    //document.getElementById('videoHolder').currentTime=timein;
    //document.getElementById('videoHolder').currentTime = timein+((new Date()).getTime()-window.pressedTimeStart)/1000;
    // document.getElementById('videoHolder').addEventListener("canplay",function() {
    //   console.log("function runn2");
    //   console.log((new Date()).getTime());
    //   document.getElementById('videoHolder').currentTime = timein+((new Date()).getTime()-window.pressedTimeStart)/1000;
    //   console.log('video ready');
    //   console.log(window.pressedTimeStart-(new Date()).getTime());
    //   console.log(timein+((new Date()).getTime()-window.pressedTimeStart)/1000)
    // });
    //document.getElementById('videoHolder').addEventListener("canplay",function() {alert((new Date()).getTime()-window.pressedTimeStart)/1000;});
    myVideo.videoRunning=true;
    myVideo.timer();
  },
  pause: function (){
    myVideo.videoRunning=true;
    document.getElementById('videoHolder').pause();
  },
  end: function (){
    myVideo.videoRunning=false;
    document.getElementById('videoHolder').pause();
    document.getElementById('mainDiv').style.visibility='visible';
    document.getElementById('videoDiv').style.visibility='hidden';
  },
  timer: function (){
    if(myVideo.videoRunning){
      var vid = document.getElementById("videoHolder");
      document.getElementById('videoTime').innerHTML=document.getElementById('videoHolder').currentTime.toFixed(2);
      setTimeout(myVideo.timer,50);
    } 
  }
}



function loadVideoMessage(msg){
  myVideo.source=msg['source'];
  myVideo.create();
  myVideo.show();
}

function startVideoMessage(msg){
  myVideo.show();
  myVideo.start(msg['time']);
}

function endVideoMessage(msg){
  myVideo.end();
}

function reconnectVideoMessage(msg){
  window.messageReceivedTime=(new Date()).getTime();
  myVideo.source=msg['source'];
  myVideo.create();
  myVideo.show();
  document.getElementById('videoHolder').addEventListener("canplay",function() {
    document.getElementById('videoHolder').currentTime = msg['time']+((new Date()).getTime()-window.messageReceivedTime)/1000;
    document.getElementById('videoHolder').play();
    myVideo.videoRunning=true;
    myVideo.timer();
  });
}

// myVideo.source="instructions.mp4"
// myVideo.create();
// myVideo.source="http://techslides.com/demos/sample-videos/small.mp4"
// myVideo.create();
// myVideo.start(0);


</code></pre>
</div>

<div class="header">/code/javascript/websocketConnect.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">var sock = null;
var pageName=location.pathname.substring(location.pathname.lastIndexOf("/") + 1);

window.onload = function() {
  wsuri=window.config['websocketURL'];
  if ("WebSocket" in window) {
    sock = new WebSocket(wsuri);
  } else if ("MozWebSocket" in window) {
    sock = new MozWebSocket(wsuri);
  } else {
    window.location = "http://autobahn.ws/unsupportedbrowser";
  }

  if (sock) {
    sock.onopen = function() {
      var message={"type":"newConnection","url":window.location};
      sendMessage(message);
    }
    sock.onclose = function(e) {
      console.log("disconnected");
      placeText({"divid":"disconnectedDiv","width":"100%","height":"100%","fontSize":"125%","top":'0px',"zIndex":'16777271',"backgroundColor":"rgba(255,200,200,.8)",});
      placeText({"parentDiv":"disconnectedDiv","text":'Connection to server lost.  &lt;br>  &lt;input type="button" value="Reconnect" onClick="window.location.href=window.location.href">',"top":"25%","height":"250%","fontSize":"225%","backgroundColor":"rgba(255,0,0,0)",});
    }
    sock.onmessage = function(e) {
      messageManager(e.data)
    }  
    sock.onerror = function(){
      genericScreen('Failed to connect to server.  &lt;br>  &lt;input type="button" value="Reconnect" onClick="window.location.href=window.location.href">');
    }
  }
};


function getUserName(){
  $.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if(results==null){return null;}
    else{return results[1] || 0;}
  }
  var username=$.urlParam('user');
}


function makeid(){
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    for( var i=0; i &lt; 8; i++ )
        text += possible.charAt(Math.floor(Math.random() * possible.length));
    return text;
}

function connectAnotherBrowser(message){
    clearAll();
    genericScreen('Connected Somewhere Else.  &lt;br>  &lt;input type="button" value="Reconnect" onClick="window.location.href=window.location.href">');
    console.log(sock);
    sock=null;
    console.log(sock);
}

function notAccepting(message){
  subjectIDs=message['subjectIDs'];
  document.write("&lt;ol id='clients'>&lt;ol>");
  for(k=0;k&lt;subjectIDs.length;k++){
    newLI = document.createElement("li");
    newLI.innerHTML="&lt;a href='"+window.location.pathname+"?subjectID="+subjectIDs[k][0]+"'>"+subjectIDs[k][0]+" - "+subjectIDs[k][1]+"&lt;/a>";
    document.getElementById("clients").appendChild(newLI);
  }
}

function sendMessage(message){
  if(sock!=null){
    sock.send(JSON.stringify(message));
  }
  else{
    console.log("can't sent,not connected",message);
  }
}

</code></pre>
</div>

<div class="header">/code/locations/esl.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config):
	config['webServerRoot']="/Users/jnr/Dropbox/Sites/jnromero.com/Experiments/"
	config['serverType']="regularExperiment"	
	config['serverPort']=24921
	config['webSocketPort']=13557
	ip="10.128.228.70"
	config["domain"]="http://"+ip+":"+str(config['serverPort'])
	config["websocketURL"]="ws://"+ip+":"+str(config['webSocketPort'])
	config["screenServer"]="http://"+ip+":"+str(config['screenServerPort'])	
	return config
</code></pre>
</div>

<div class="header">/code/locations/example.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config):
	config['serverType']="regularExperiment"	
	config['serverPort']=2345
	config['webSocketPort']=3456
	ip="localhost"
	config["domain"]="http://"+ip+":"+str(config['serverPort'])
	config["websocketURL"]="ws://"+ip+":"+str(config['webSocketPort'])
	return config
</code></pre>
</div>

<div class="header">/code/locations/labComputer.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config):
	config['serverType']="regularExperiment"	
	config['serverPort']=4567
	config['webSocketPort']=5678
	ip="12.345.67.89"
	config["domain"]="http://"+ip+":"+str(config['serverPort'])
	config["websocketURL"]="ws://"+ip+":"+str(config['webSocketPort'])
	return config
</code></pre>
</div>

<div class="header">/code/locations/local.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config,ip="localhost"):
	config['serverType']="regularExperiment"	
	config['serverPort']=23456
	config['webSocketPort']=34567
	config["domain"]="http://"+ip+":"+str(config['serverPort'])
	config["websocketURL"]="ws://"+ip+":"+str(config['webSocketPort'])
	return config
</code></pre>
</div>

<div class="header">/code/locations/localTesting.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config,ip="localhost"):
	config['webServerRoot']="/Users/jnr/Dropbox/Sites/jnromero.com/Experiments/"
	config['serverType']="regularExperiment"	
	config['serverPort']=24921
	config['webSocketPort']=13557
	config["domain"]="http://jnromero.com/testing"
	config["websocketURL"]="ws://jnromero.com/testingWS"
	return config
</code></pre>
</div>

<div class="header">/code/locations/webf.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config):
	config['serverType']="regularExperiment"	
	config['serverPort']=17721
	config['webSocketPort']=27450
	config["domain"]="http://jnromero.com/experiment"
	config["websocketURL"]='ws://jnromero.com/webSockets/experiment'
	return config
</code></pre>
</div>

<div class="header">/code/locations/webf2.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">def getLocation(config):
	config['webServerRoot']="/home/jnromero/Sites/jnromero.com/Experiments/"
	config['serverType']="regularExperiment"	
	config['serverPort']=18267
	config['webSocketPort']=30211
	config["domain"]="http://jnromero.com/experiment2"
	config["websocketURL"]='ws://jnromero.com/webSockets/experiment2'
	config["screenServer"]="http://jnromero.com/screenServer/"
	return config
</code></pre>
</div>

<div class="header">/code/python/modules/configFunctions.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import os

def setOtherFileLocations(config):
	config['dataFolder']=config['currentExperiment']+"/data/"+config['serverStartString']+"/"

	config['configJsURL']=config['domain']+config['dataFolder']+"/config.js"
	config['configJsRelative']=config['dataFolder']+"/config.js"
	config['configJsPath']=config['webServerRoot']+config['dataFolder']+"/config.js"

	config['dataFileRelativePath']=config['dataFolder']+"/%s.pickle"%(config['serverStartString'])
	config['dataFolderURL']=config['domain']+config['currentExperiment']+"/data/"+config['serverStartString']+".zip"
	config['dataFilePath']=config['webServerRoot']+config['dataFileRelativePath']
	config['dataFileURL']=config['domain']+config['dataFileRelativePath']

	config['fullDataFolder']=config['webServerRoot']+config['dataFolder']
	config['logFolder']=config['fullDataFolder']+"/logs/"
	config['messageLogFile']=config['logFolder']+"/messages/messagesLog.pickle"
	config['twistedLogFile']=config['logFolder']+"/twistedLog.log"
	config['fullLogFile']=config['logFolder']+"/fullLog.pickle"

	makeFolderIfNeeded(config['fullDataFolder'])
	makeFolderIfNeeded(config['logFolder'])
	makeFolderIfNeeded(config['logFolder']+"messages/")
	makeFolderIfNeeded(config['logFolder']+"txt/")
	makeFolderIfNeeded(config['logFolder']+"pickle/")


	string="""import pickle 
filename='messagesLog.pickle'
with open(filename,'rb') as f:
	while True:
		try:
			data=pickle.load(f)
			print data
			print data[0],data[1],data[2]['type'],data[2]['sid']
			raw_input() 
		except Exception,e: 
			print str(e)
			break
"""

	filename=config['logFolder']+"/messages/messagesLogViewer.py"
	file = open(filename,'w')
	file.writelines(string)
	file.close() 





	return config

def writeJavascriptConfigFile(config):
	string="window.config=%s;"%(config)
	string=string.replace(",",",\n\t")
	file = open(config['webServerRoot']+config['configJsRelative'],'w')
	file.writelines(string)
	file.close() 

def makeFolderIfNeeded(folder):
	if not os.path.exists(folder):
		os.makedirs(folder)

</code></pre>
</div>

<div class="header">/code/python/modules/functions.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">

def printColor(string,color='black',highlights=[]):
   attr = ['0','30']
   if color=="green":
      # green
      attr.append('32')
   elif color=="red":
      # red
      attr.append('31')
   elif color=="gold":
      # red
      attr.append('33')
   elif color=="blue":
      # red
      attr.append('34')
   elif color=="pink":
      # red
      attr.append('35')
   elif color=="turquoise":
      # red
      attr.append('36')
   elif color=="grey":
      # red
      attr.append('37')
   else:
      attr.append('30')

   for highlight in highlights:
      if highlight=='bold':
         attr.append('1')
      elif highlight=='italic':
         attr.append('3')
      elif highlight=='underline':
         attr.append('4')
      elif highlight=='flash':
         attr.append('5')
      elif highlight=='background':
         attr.append('7')

   print('\x1b[%sm%s\x1b[0m' % (';'.join(attr), string)),


</code></pre>
</div>

<div class="header">/code/python/modules/instructions.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import pickle
import json
import time
from twisted.internet import reactor
import random

class SteepInstructions():
   def __init__(self):
      "self.doNothering=1"
      self.instructionsAudioFile=self.config['domain']+self.config['currentExperiment']+self.config['instructionsFolder']+"/generatedFiles/output.m4a"
      self.instructionsFinishedCaption="Instructions Finished. Please wait patiently for experiment to continue."
      #so video can be like a regular subject with a status
      self.instructionsPlaybackSpeed=1
      self.createSubject("video")
      self.getInstructionsDuration()
      self.getInstructionsTasks()
      self.getInstructionsCaptions()
      self.taskCalls={}
      self.captionCalls={}



   def toggleInsructionsPauseOnClient(self,message,client):
      sid=client.subjectID
      if self.data[sid].instructionsPlaying==1:
         timeIN=time.time()-self.data[sid].instructionsStartTime
         params={}
         params['startTime']="%.02f"%(timeIN)
         self.cancelInstructionsCalls(sid)
         self.setURLParameters(params,sid,"send")
         self.runJavascriptFunction("pauseInstructions",sid,"send")
         self.data[sid].instructionsPlaying=0
      else:
         timeIN=self.data[sid].queryParameters["startTime"][0]
         self.instructionsDemo(sid,float(timeIN))


   def changeInstructionsTime(self,message,client):
      sid=client.subjectID
      if sid=="monitor":
         sid="allPlusVideo"

      if "amount" in message:
         print(sid)
         timeIN=min(self.instructionsLength-30,max(0,time.time()-self.data[sid].instructionsStartTime+message['amount']))
         self.setURLParameters(params,sid,"send")
      elif "percentage" in message:
         timeIN=self.instructionsLength*message['percentage']
      params={}
      params['startTime']="%.02f"%(timeIN)
      self.cancelInstructionsCalls(sid)
      self.instructionsDemo(sid,timeIN)

   def changeInstructionsTimeFromMonitor(self,message,client):
      sid="allPlusVideo"
      self.stopInstructions({},{})
      timeIN=self.instructionsLength*message['percentage']
      self.data['instructionsTime']=timeIN
      self.playInstructions()


   def instructionsDemo(self,sid,timeIN=0):
      if timeIN==0 and "startTime" in self.data[sid].queryParameters:
         timeIN=float(self.data[sid].queryParameters["startTime"][0])

      if timeIN>self.instructionsLength:
         timeIN=0

      print("DMO");
      msgs=[]

      msgList=self.loadInstructionsOnClient(sid,"return")
      msgs+=msgList

      #draw cursor overlay
      msgList=self.runJavascriptFunction("drawCursorOverlay",sid,"return")
      msgs+=msgList

      #draw caption overlay
      msgList=self.runJavascriptFunction("drawCaptionOverlay",sid,"return")
      msgs+=msgList
      
      #draw instructions timer
      msgList=self.drawInstructionsTimer(sid,"return")
      msgs+=msgList

      for s in self.getSubjectIDList(sid):
         self.data[s].instructionsPlaying=1   
      msgList=self.runJavascriptFunction("clearAllInstructions",sid,"return")
      msgs+=msgList

      #dont end instructions for demo
      #      self.initializeTimer(sid,self.instructionsLength,self.endInstructions)

      self.initializeTimer(sid,self.instructionsLength,self.endInstructions)
      self.data['timers'][sid]=[time.time(),time.time()-timeIN,self.instructionsLength]
      # self.data[sid].timer=[time.time(),time.time()-timeIN,self.instructionsLength]
      print(self.data['timers'][sid])
      kwargs={"sid":sid}

      [taskMsgs,index,timeToNext]=self.catchUpTasks(sid,timeIN)
      for s in self.getSubjectIDList(sid):
         self.data[s].taskIndex=index
      self.taskCalls[sid]=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.runAnotherTask,**kwargs)
      msgs+=taskMsgs

      [msgList,index,timeToNext]=self.catchUpCaptions(sid,timeIN)
      for s in self.getSubjectIDList(sid):
         self.data[s].captionIndex=index
      self.captionCalls[sid]=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.displayCaption,**kwargs)
      msgs+=msgList

      msgList=self.startAudio(sid,"return",timeIN)
      msgs+=msgList

      msgList=self.runJavascriptFunction("drawInstructionsControls",sid,"return")
      msgs+=msgList

      self.sendListOfMessages(msgs)

   def getInstructionsTasks(self):
      filename=self.config['webServerRoot']+self.config['currentExperiment']+self.config['instructionsFolder']+"/generatedFiles/taskTimes.pickle"
      file = open(filename,'rb')
      self.taskTimes=pickle.load(file)
      file.close() 
      self.data['taskIndex']=-1

      filename=self.config['webServerRoot']+self.config['currentExperiment']+self.config['instructionsFolder']+"/generatedFiles/tasks2.pickle"
      file = open(filename,'rb')
      self.tasks2=pickle.load(file)
      file.close() 

   def getInstructionsCaptions(self):
      #is a list of lists with [caption,time to next,total time at end of this caption display]
      filename=self.config['webServerRoot']+self.config['currentExperiment']+self.config['instructionsFolder']+"/generatedFiles/captions.pickle"
      file = open(filename,'rb')
      self.captions=pickle.load(file)
      self.captions.append([self.instructionsFinishedCaption,100000,100000])
      file.close() 
      self.data['captionIndex']=-1

   def getInstructionsDuration(self):
      filename=self.config['webServerRoot']+self.config['currentExperiment']+self.config['instructionsFolder']+"/generatedFiles/output.duration"
      file = open(filename,'r')
      self.instructionsLength=float(file.read())/self.instructionsPlaybackSpeed
      file.close() 


   def getCurrentInstructionsTime(self):
      #sets self.instructionsTime
      if self.data['serverStatus']['instructions']['playing']==1:   
         self.data['instructionsTime']=time.time()-self.data['instructionsStartTime']

   def setInstructionsStartTime(self):
      #sets self.instructionsStartTime
      if self.data['serverStatus']['instructions']['playing']==1:   
         self.data['instructionsStartTime']=time.time()-self.data['instructionsTime']

   def reconnectInstructions(self,sid="all",output="send",timeIN="none"):
      print("reconnecting 2l43kj23l4kj23 4lkj"+sid)
      msgs=[]
      msgList=self.loadInstructionsOnClient(sid,"return")
      msgs+=msgList

      #draw cursor overlay
      msgList=self.runJavascriptFunction("drawCursorOverlay",sid,"return")
      msgs+=msgList

      #draw caption overlay
      msgList=self.runJavascriptFunction("drawCaptionOverlay",sid,"return")
      msgs+=msgList
      
      #draw instructions timer
      msgList=self.drawInstructionsTimer(sid,"return")
      msgList=self.drawInstructionsTimer("allPlusVideo","return")
      msgs+=msgList



      [taskMsgs,index,timeToNext]=self.catchUpTasks(sid,timeIN)
      msgs+=taskMsgs
      
      [msgList,index,timeToNext]=self.catchUpCaptions(sid,timeIN)
      msgs+=msgList

      if self.data['serverStatus']['instructions']['playing']==1:   
         msgList=self.startAudio(sid,"return")
         msgs+=msgList
      else:
         # self.initializeTimer("all",self.instructionsLength,self.endInstructions)
         self.data['timer']=[time.time(),time.time()-self.data['instructionsTime'],self.instructionsLength]
         msgList=self.runJavascriptFunction("pauseInstructions",sid,"return")
         msgs+=msgList

      self.sendListOfMessages(msgs)

   def loadInstructions(self,message,client):
      #this ensures that the server knows that the instructions are loaded
      print("Loading Instructions....")
      self.data['serverStatus']['page']="instructions"
      self.data['instructionsTime']=0
      self.data['instructionsStartTime']=0


      self.data['serverStatus']['instructions']['lastCaption']=self.captions[0][0]
      self.data['serverStatus']['instructions']['loaded']=1
      self.loadInstructionsOnClient("allPlusVideo")
      self.monitorMessage()
      self.updateTaskTable()

   def loadInstructionsOnClient(self,sid="all",output="send"):
      print(len(self.data['subjectIDs']))
      print("Loading Instructions on client....",sid)
      messages=[]

      # def sendListOfMessages(self,messages):
      # def messageToId(self,msg,sid="all",output="send"):



      #update status message
      for s in self.getSubjectIDList(sid):
         self.data[s].status['page']="generic"
         self.data[s].status['message']=["The instruction video will start shortly...."]
      msgList=self.updateStatus(sid,"return")
      messages+=msgList

      #load Instructions message
      msg={}
      msg['type']="loadInstructions"
      msg['source']=self.instructionsAudioFile
      msg['length']=self.instructionsLength
      msgList=self.messageToId(msg,sid,"return")
      messages+=msgList

      # #Load Click moved to load instructions
      # msgList=self.runJavascriptFunction("loadClickSound",sid,"return")
      # messages+=msgList


      if output=="send":
         self.sendListOfMessages(messages)
      elif output=="return":
         return messages

   def runJavascriptFunction(self,functionName,sid="all",output="send"):
      msg={}
      msg['type']=functionName
      return self.messageToId(msg,sid,output)



   def placeCursor(self,x,y,sid="all",output="send"):
      msg={}
      msg['type']='placeCursor'
      msg['x']=x
      msg['y']=y
      return self.messageToId(msg,sid,output)

   def changeCaptionBottom(self,y,sid="all",output="send"):
      msg={}
      msg['type']='changeCaptionBottom'
      msg['y']=y
      return self.messageToId(msg,sid,output)

   def moveCursor(self,endX,endY,time=0.5,delay=0,sid="all",output="send"):
      msg={}
      msg['type']='moveCursor'
      msg['endX']=endX
      msg['endY']=endY
      msg['time']=time
      msg['delay']=delay
      return self.messageToId(msg,sid,output)


   def moveCursorToDiv(self,divName,time=0.5,delay=0,anchor="none",sid="all",output="send"):
      msg={}
      msg['type']='moveCursorToDiv'
      msg['anchor']=anchor
      msg['divName']=divName
      msg['time']=time
      msg['delay']=delay
      return self.messageToId(msg,sid,output)


   def cursorDown(self,delay,position,sid="all",output="send"):
      msg={}
      msg['type']='cursorDown'
      msg['position']=position
      msg['delay']=delay
      return self.messageToId(msg,sid,output)

   def cursorDownDiv(self,delay,divName,anchor="none",sid="all",output="send"):
      msg={}
      msg['type']='cursorDownDiv'
      msg['divName']=divName
      msg['anchor']=anchor
      msg['delay']=delay
      print(sid,output)
      print("Cursordown")
      return self.messageToId(msg,sid,output)

   def mouseSequence(self,sequence,sid="all",output="send"):
      kwargs={"sid":sid,"output":"return"}
      msgs=[]
      sequenceTime=0
      currentPosition=[0,0]
      for s in sequence:
         if s[0]=="place":
            msgList=self.placeCursor(s[1],s[2],**kwargs)
            msgs+=msgList
            currentPosition=[s[1],s[2]]
         elif s[0]=="toPoint":
            msgList=self.moveCursor(s[1],s[2],s[3],sequenceTime,**kwargs)
            msgs+=msgList
            sequenceTime+=s[3]
            currentPosition=[s[1],s[2]]
         elif s[0]=="toDiv":
            for kw in kwargs:
               s[1][kw]=kwargs[kw]
            s[1]['delay']=sequenceTime
            msgList=self.moveCursorToDiv(**s[1])
            msgs+=msgList
            if "time" not in s[1]:
               thisTime=0.5
            else:
               thisTime=s[1]['time']

            sequenceTime+=thisTime
         elif s[0]=="click" or s[0]=="clickDiv":
            if s[0]=="click":
               msgList=self.cursorDown(sequenceTime,currentPosition,**kwargs)
               msgs+=msgList
            elif s[0]=="clickDiv":
               theseArgs={}
               for kw in ['divName','anchor']:
                  if kw in s[1]:
                     theseArgs[kw]=s[1][kw]
               for kw in ['sid','output']:
                  theseArgs[kw]=kwargs[kw]
               theseArgs['delay']=sequenceTime
               msgList=self.cursorDownDiv(**theseArgs)
               msgs+=msgList

            clickArgs={}
            clickArgs['func']=s[1]['func']
            clickArgs['args']=s[1]['args']
            clickArgs['sid']=sid
            clickArgs['output']="send"
            self.taskCalls[sid]=reactor.callLater(float(sequenceTime+.15)/self.instructionsPlaybackSpeed,self.runSingleTask,**clickArgs)
            sequenceTime+=.65

      if output=="send":
         self.sendListOfMessages(msgs)
      else:
         return msgs

   def startAudio(self,sid="all",output="send",timeIN="none"):
      #self.instructionsTime should be set before this is run
      if timeIN=="none" or sid in ["all","allPlusVideo"]:
         timeIN=self.data['instructionsTime']
         self.data['instructionsStartTime']=time.time()-timeIN
      else:
         self.data[sid].instructionsStartTime=time.time()-timeIN

      msg={}
      msg['currentTime']=timeIN
      msg['playbackRate']=self.instructionsPlaybackSpeed
      msg['type']='startAudio'
      return self.messageToId(msg,sid,output)

   def changeBackgroundColor(self,color,sid="all",output="send"):
      msg={}
      msg['type']='changeBackgroundColor'
      msg['color']=color
      return self.messageToId(msg,sid,output)

   def highlightDiv(self,divName,sid="all",output="send"):
      msg={}
      msg['type']='highlightDiv'
      msg['divName']=divName
      return self.messageToId(msg,sid,output)


   def unHighlightDiv(self,divName,sid="all",output="send"):
      msg={}
      msg['type']='unHighlightDiv'
      msg['divName']=divName
      return self.messageToId(msg,sid,output)


   def placeText(self,divID,text,left,top,fontSize,color,fadeTime,textAlign,sid="all",output="send"):
      msg={}
      msg['type']='placeText'
      msg['divid']=divID
      msg['text']=text
      msg['left']=left
      msg['top']=top
      msg['fontSize']=fontSize
      msg['color']=color
      msg['fadeTime']=fadeTime
      msg['textAlign']=textAlign
      return self.messageToId(msg,sid,output)

   def playInstructions(self):
      msgs=[]
      self.data['serverStatus']['instructions']['playing']=1
      # if self.data['serverStatus']['instructions']['loaded']==0   
      self.data['serverStatus']['instructions']['started']=1
      self.data['serverStatus']['instructions']['time']=float(self.data['instructionsTime'])/self.instructionsLength


      #draw cursor overlay
      msgList=self.runJavascriptFunction("drawCursorOverlay","allPlusVideo","return")
      msgs+=msgList

      #draw caption overlay
      msgList=self.runJavascriptFunction("drawCaptionOverlay","allPlusVideo","return")
      msgs+=msgList
      
      #draw instructions timer
      msgList=self.drawInstructionsTimer("allPlusVideo","return")
      msgs+=msgList


      msgList=self.startAudio("allPlusVideo","return")
      msgs+=msgList
      msgList=self.runJavascriptFunction("clearAllInstructions","allPlusVideo","return")
      msgs+=msgList

      # self.initializeTimer("all",self.instructionsLength,self.endInstructions)
      self.initializeTimer("all",self.instructionsLength-self.data['instructionsTime'],self.endInstructions)
      # self.data['timer']=[time.time(),time.time()-self.data['instructionsTime'],self.instructionsLength]

      [taskMsgs,index,timeToNext]=self.catchUpTasks()
      self.data['taskIndex']=index
      kwargs={"sid":"allPlusVideo"}
      self.taskCalls['allPlusVideo']=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.runAnotherTask,**kwargs)
      msgs+=taskMsgs
      [msgList,index,timeToNext]=self.catchUpCaptions()
      self.data['captionIndex']=index

      kwargs={"sid":"allPlusVideo"}
      self.captionCalls['allPlusVideo']=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.displayCaption,**kwargs)
      msgs+=msgList

      self.sendListOfMessages(msgs)
      self.monitorMessage()
      self.updateTaskTable()



   def resumeInstructions(self,message,client):
      self.playInstructions()

   def restartInstructions(self,message,client):
      if self.data['serverStatus']['instructions']['playing']==1:
         self.stopInstructions({},{})
      for sid in ['video']+self.data['subjectIDs']:
         self.data[sid].status['page']="generic"
         self.data[sid].status['message']=["The instruction video will start shortly...."]
         self.updateStatus(sid)


      self.data['instructionsTime']=0
      self.data['serverStatus']['instructions']['time']=float(self.data['instructionsTime'])/self.instructionsLength
      self.data['serverStatus']['instructions']['playing']=0   
      self.monitorMessage()
      self.updateTaskTable()

   def cancelInstructionsCalls(self,sid):
      if sid in self.taskCalls:
         if self.taskCalls[sid].cancelled==0:
            if self.taskCalls[sid].called==0:
               self.taskCalls[sid].cancel()
            else:
               print("trying to cancel already called Task",sid)
      if sid in self.captionCalls:
         if self.captionCalls[sid].cancelled==0:
            if self.captionCalls[sid].called==0:
               self.captionCalls[sid].cancel()
            else:
               print("trying to cancel already called Caption",sid)

   def stopInstructions(self,message,client):
      self.cancelInstructionsCalls("allPlusVideo")
      self.runJavascriptFunction("pauseInstructions","allPlusVideo","send")
      self.data['instructionsTime']=time.time()-self.data['instructionsStartTime']
      self.data['serverStatus']['instructions']['time']=float(self.data['instructionsTime'])/self.instructionsLength
      self.data['serverStatus']['instructions']['playing']=0   
      self.monitorMessage()
      self.updateTaskTable()


   def runSingleTask(self,func,args,sid="all",output="send"):
      args['sid']=sid
      args['output']="return"
      thisFunction = getattr(self,func)
      msgList=thisFunction(**args)
      if output=="send":
         self.sendListOfMessages(msgList)
      else:
         return msgList

   def catchUpTasks(self,sid="all",timeIN="none"):
      if timeIN=="none":
         self.getCurrentInstructionsTime()
         timeIN=self.data['instructionsTime']
      toBeRun=[{"func":"runJavascriptFunction","args":{"functionName":"clearAllInstructions"}}]
      lastPosition=[-23,-23]
      for index in range(len(self.taskTimes)):
         taskTime=self.taskTimes[index][-1]
         thisTask=self.tasks2[index]
         if taskTime&lt;timeIN:
            if "args" in thisTask:
               if "functionName" in thisTask['args']:
                  if thisTask['args']['functionName']=="clearAllInstructions":
                     toBeRun=[]
                     lastPosition=[-23,-23]
            if thisTask['func']=="mouseSequence":
               thisSequence= thisTask['args']['sequence']
               for k in thisSequence:
                  if k[0]=="place":
                     lastPosition=[k[1],k[2]]
                  elif k[0]=="place":
                     lastPosition=[k[1],k[2]]
                  elif k[0]=="toDiv":
                     lastPosition=["div",k[1]["divName"]]
                  elif k[0]=="click" or k[0]=="clickDiv":
                     clickArgs={}
                     clickArgs['func']=k[1]['func']
                     clickArgs['args']=k[1]['args']
                     clickArgs['args']['sid']=sid
                     toBeRun.append(clickArgs)
            else:
               toBeRun.append(thisTask)
         else:
            #all tasks after time don't need to be looked at
            break
            #index is the index of the next task to be run.

      #place cursor:
      if lastPosition==[-23,-23]:
         "do nothing"
      elif lastPosition[0]=="div":
         this={"func":"mouseSequence","args":{"sequence":[["toDiv",{"divName":lastPosition[1],"time":0}]]}}
         toBeRun.append(this)
      else:
         this={"func":"placeCursor","args":{"x":lastPosition[0],"y":lastPosition[1]}}
         toBeRun.append(this)


      messages=[]
      for task in toBeRun:
         msgList=self.runSingleTask(task['func'],task['args'],sid,"return")
         messages+=msgList

      timeToNextTask=self.taskTimes[index][-1]-timeIN
      return [messages,index-1,timeToNextTask]

   def runAnotherTask(self,sid="all"):
      runTask=0
      if self.config['serverType']=="regularExperiment":
         self.data['taskIndex']+=1
         thisIndex=self.data['taskIndex']
         sendToWho="allPlusVideo"
         runTask=1
      elif self.config['serverType']=="demoExperiment":
         if sid in self.data:
            self.data[sid].taskIndex+=1
            thisIndex=self.data[sid].taskIndex
            sendToWho=sid
            runTask=1
      if runTask==1:
         timeForThisTask=float(self.taskTimes[thisIndex][1])
         task=self.tasks2[thisIndex]
         msgList=self.runSingleTask(task['func'],task['args'],sendToWho,"send")
         # self.getCurrentInstructionsTime()

         if thisIndex&lt;len(self.taskTimes)-1:
            timeForNextThisTask=float(self.taskTimes[thisIndex+1][1])
            timeToNext=timeForNextThisTask-timeForThisTask
            kwargs={"sid":sid}
            self.taskCalls[sid]=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.runAnotherTask,**kwargs)
         self.updateInstructionTimeToMonitor(sid)

   def catchUpCaptions(self,sid="all",timeIN="none"):
      if timeIN=="none":
         self.getCurrentInstructionsTime()
         timeIN=self.data['instructionsTime']
      for index in range(len(self.captions)):
         caption=self.captions[index]
         if caption[-1]>timeIN:
            break
      currentCaption=self.captions[index][0]
      timeToNext=self.captions[index][-1]-timeIN
      msgList=self.setCaption(currentCaption,sid,"return")
      return [msgList,index,timeToNext]

   def updateInstructionTimeToMonitor(self,sid="all"):
      if sid=="all" or sid=="allPlusVideo":
         self.data['instructionsTime']=time.time()-self.data['instructionsStartTime']
         self.data['serverStatus']['instructions']['time']=float(self.data['instructionsTime'])/self.instructionsLength
      else:
         self.data[sid].instructionsTime=time.time()-self.data[sid].instructionsStartTime
         self.data['serverStatus']['instructions']['time']=float(self.data[sid].instructionsTime)/self.instructionsLength

      self.monitorMessage()
      self.updateTaskTable()



   def drawInstructionsTimer(self,sid="all",output="send"):
      msg={}
      msg['type']='drawInstructionsTimer'
      if sid=="allPlusVideo":
         msg['whichTimer']="all"      
      else:
         msg['whichTimer']=sid      
      # if self.config['serverType']=="regularExperiment":
      #    msg['whichTimer']="all"         
      # elif self.config['serverType']=="demoExperiment":
      #    msg['whichTimer']="selfTimer"
      return self.messageToId(msg,sid,output)


   def setCaption(self,caption,sid="all",output="send"):
      msg={}
      msg['type']='setCaptions'
      msg['caption']=caption
      msg['length']=self.instructionsLength
      if sid=="allPlusVideo":
         msg['whichTimer']="all"      
      else:
         msg['whichTimer']=sid      
      # if self.config['serverType']=="regularExperiment":
      #    msg['whichTimer']="all"         
      # elif self.config['serverType']=="demoExperiment":
      #    msg['whichTimer']="selfTimer"
      return self.messageToId(msg,sid,output)

   def displayCaption(self,sid="all"):
      setCaption=0
      if self.config['serverType']=="regularExperiment":
         self.data['captionIndex']+=1
         thisIndex=self.data['captionIndex']
         sendToWho="allPlusVideo"
         setCaption=1
      elif self.config['serverType']=="demoExperiment":
         if sid in self.data:
            self.data[sid].captionIndex+=1
            thisIndex=self.data[sid].captionIndex
            sendToWho=sid
            setCaption=1
      if setCaption==1:
         thisCaption=self.captions[thisIndex][0]
         timeToNext=float(self.captions[thisIndex][1])
         self.setCaption(thisCaption,sendToWho,"send")

         if self.captions[thisIndex][0]==self.instructionsFinishedCaption:
            'do nothing'
         else:      
            kwargs={"sid":sid}
            self.captionCalls[sid]=reactor.callLater(float(timeToNext)/self.instructionsPlaybackSpeed,self.displayCaption,**kwargs)
         self.data['serverStatus']['instructions']['lastCaption']=thisCaption
         self.updateInstructionTimeToMonitor(sid)


   def endInstructionsMessage(self,message,client):
      self.stopInstructions({},{})
      self.endInstructions()
   
   def endInstructions(self):
      print("Instructions Finished")
      self.data['serverStatus']['instructions']['started']=0
      self.data['serverStatus']['instructions']['loaded']=0
      self.data['serverStatus']['instructions']['playing']=0
      self.data['serverStatus']['instructions']['finished']=1
      self.data['serverStatus']['page']="none"
      self.monitorMessage()
      self.updateTaskTable()
      msg={}
      msg['type']="endInstructions"
      # for sid in self.getSubjectIDList("allPlusVideo"):
      #    self.data[sid].status["page"]="generic"
      #    self.data[sid].status["message"]=["The Instructions Have Ended. &lt;br> Plese wait for experiment to continue."]
      return self.messageToId(msg,"allPlusVideo","send")


</code></pre>
</div>

<div class="header">/code/python/modules/logger.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import os
from twisted.python import log
import time
import sys
import pickle 
from builtins import bytes


class logCounter():
   def __init__(self):
      self.counter=0
      self.fileCount=1
      self.totalCounter=0
      self.currentTab=1

   def increment(self):
      self.counter+=1
      self.totalCounter+=1
      out=False
      if self.counter>500:
         self.fileCount+=1
         self.counter=0
         out=True
      return out

def createBlankFile(filename):
   file = open(filename,'wb')
   file.close() 


def getFilenames(config,fileCount):
   txtFile=config['logFolder']+"/txt/%s.txt"%(fileCount)
   pickleFile=config['logFolder']+"/pickle/%s.pickle"%(fileCount)
   return [txtFile,pickleFile]

def newFiles(config,fileCount):
   [txtFile,pickleFile]=getFilenames(config,fileCount)
   createBlankFile(txtFile)
   createBlankFile(pickleFile)
   return [txtFile,pickleFile]

class SteepLogger(object):
   def __init__(self,stream,streamType,config,thisCounter,consoleMessage):
      self.stream=stream
      self.config=config
      self.counter=thisCounter
      self.type=streamType#stdErr or stdOut
      self.consoleMessage=consoleMessage
      [self.txtLogFilename,self.pickleLogFilename]=newFiles(self.config,self.counter.fileCount)
      self.newLine()

   def newLine(self):
      self.currentLine=""

   def write(self,obj,**kwargs):
      #open files for appending
      #split into lines
      lines=obj.split("\n")
      if "type" in kwargs:
         thisType=kwargs['type']
      else:
         thisType=self.type
      for k in range(len(lines)):
         self.currentLine+=lines[k]
         if k&lt;len(lines)-1:
            #write to text file
            with open(self.txtLogFilename,'ab') as f:
               f.write(bytes(self.currentLine+"\n", encoding="UTF-8"))
            #write to pickle file ([type,line,linecounter,kwargs])
            with open(self.pickleLogFilename,'ab') as f:
               pickle.dump([thisType,self.currentLine.replace(" ","&nbsp;&nbsp;"),self.counter.totalCounter,kwargs],f,protocol=2)
            #write to console
            self.stream.write(thisType+" "*(15-len(thisType))+"   "+self.currentLine+"\n")
            self.stream.flush()
            self.currentLine=""
            if self.counter.increment():
               print("Incrementing, and Creating New Log Files")
               [self.txtLogFilename,self.pickleLogFilename]=newFiles(self.config,self.counter.fileCount)
      self.consoleMessage()

   def flush(self):
      self.stream.flush()


def twistedObserver(eventDict):
   kwargs={"type":"twisted"}
   if 'log_namespace' not in eventDict:
      sys.stdout.write(eventDict+"\n",**kwargs)
   elif eventDict['isError']==1:
      kwargs={"type":"twistedError"}
      if 'log_text' in eventDict:
         for k in eventDict['log_text'].split("\n"):
            sys.stdout.write(k+"\n",**kwargs)
      elif 'log_io' in eventDict:
         sys.stdout.write(eventDict['log_io']+"\n",**kwargs)
      else:
         sys.stdout.write(str(eventDict)+"\n",**kwargs)
   elif eventDict['log_namespace']=='stdout':
      sys.stdout.write(eventDict['log_io']+"\n",**kwargs)
   elif eventDict['log_namespace']=='twisted.python.log' and 'log_io' in eventDict:
      if eventDict['log_io'].find("\"GET")==-1:
         sys.stdout.write(eventDict['log_io']+"\n",**kwargs)

   else:
      if "log_text" in eventDict:
         sys.stdout.write(eventDict['log_text']+"\n",**kwargs)
      elif "log_format" in eventDict:
         sys.stdout.write(eventDict['log_format']+"\n",**kwargs)
      else:
         sys.stdout.write(eventDict['message']+"\n",**kwargs)




def log(text,**kwargs):
   print(text)


</code></pre>
</div>

<div class="header">/code/python/modules/loggerOld.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import os
from twisted.python import log
import time
import sys
import pickle 

#start the logger
class TwistedLogger:
   def __init__(self,config):
      self.fileCount=1
      self.entries=0
      self.fullLogFile=config['fullLogFile']
      self.currentLogFile=config['logFolder']+"/log!!!NUMBERHERE!!!.pickle"
      # log.startLogging(open(self.fullLogFile,'ab'))#,setStdout=False)
      log.startLogging(sys.stdout,setStdout=True)
      log.addObserver(self.writeToFile)

   def addLine(self,thisType,thisLine):
      toAdd=(time.time(),thisType,thisLine)
      self.entries+=1

      file = open(self.fullLogFile,'ab')
      #protocol for python 3 compatibility
      pickle.dump(toAdd,file,protocol=2)
      file.close() 

      thisFile=self.currentLogFile.replace("!!!NUMBERHERE!!!",str(self.fileCount))
      file = open(thisFile,'ab')
      #protocol for python 3 compatibility
      pickle.dump(toAdd,file,protocol=2)
      file.close() 
      
      if self.entries>500:
         self.entries=0
         self.fileCount+=1

   def writeToFile(self,this):
      if 'log_namespace' not in this:
         self.addLine("regular",str(this))
      elif this['isError']==1:
         if 'log_text' in this:
            for k in this['log_text'].split("\n"):
               self.addLine("stdErr",k)
         else:
            self.addLine("stdErr",str(this['log_io']))
      elif this['log_namespace']=='stdout':
         self.addLine("stdOut",str(this['log_io']))
      elif this['log_namespace']=='twisted.python.log':
         if this['log_io'].find("\"GET")>-1:
            thisLine=""
         else:
            self.addLine("stdTwisted",str(this['log_io']))
            self.addLine("stdTwisted",str(this))
      else:
         if "log_text" in this:
            self.addLine("stdOther",str(this['log_text']))
         elif "log_format" in this:
            self.addLine("stdOther",str(this['log_format']))
         else:
            self.addLine("stdOther",str(this['message']))


</code></pre>
</div>

<div class="header">/code/python/modules/mainServer.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import pickle
import string
import random
import time
import json
import copy
from twisted.internet import reactor
from twisted.internet import task
import sys
import os
#compatibility for python 2 and and 3
if sys.version_info >= (3,0):
   import urllib.parse as theURLparse
else:
   import urlparse as theURLparse


class SteepMainServer():
   def __init__(self):
      self.setPreliminaries()
      self.lastConsoleMessageTime=time.time()
      self.nextConsoleCall=0
      self.lastMonitorMessageSent=time.time()
      self.nextMonitorCall=0
   def setPreliminaries(self):
      #All Clients 
      self.clients=[]
      self.videoClients=[]
      self.monitorClients=[]
      self.consoleClients=[]
      self.clientsById={}
      if self.options.restart=="False":
         #store all data here
         self.data={}
         self.data['config']=self.config
         self.data['subjectIDs']=[]
         self.data['sessionTimeStamp']=self.config['serverStartString']
         self.data['timer']=[0,0,0]


         self.data['serverStatus']={}
         self.data['serverStatus']['page']="none"
         self.data['serverStatus']['status']="none"
         self.data['serverStatus']['acceptingClients']=1
         self.data['serverStatus']['instructions']={}
         self.data['serverStatus']['instructions']['loaded']=0
         self.data['serverStatus']['instructions']['started']=0
         self.data['serverStatus']['instructions']['playing']=0
         self.data['serverStatus']['instructions']['time']=0
         self.data['serverStatus']['instructions']['finished']=0


      else:
         file = open(self.config['dataFilePath'],'rb')
         self.data=pickle.load(file)
         file.close() 
         print("Data file reloaded! %s"%(self.config['dataFilePath']))
      #save the data to the file every 10 seconds
      self.savingCall = task.LoopingCall(self.saveData)
      self.savingCall.start(10)

      #Send wake up message to client every 2 minutes to avoid timeout
      self.wakingCall = task.LoopingCall(self.wakeUp)
      self.wakingCall.start(120,now=False)#now=false doesn't run now, but starts after 120 seconds

   def blank(self):
      pass
   def saveData(self):
      with open(self.config['dataFilePath'],'wb') as f:
         #protocol for python 3 compatibility
         pickle.dump(self.data,f,protocol=2)
         
   def wakeUp(self):
      msg={}
      msg['type']='wakeUp'
      return self.messageToId(msg,"all","send")


   def notAcceptingClientsAnymoreDefault(self):
      print("define function notAcceptingClientsAnymore in experiments.py to perform matching after this button has been pressed.")


   def generateRandomString(self,size=8):
      chars=string.ascii_uppercase + string.digits
      return ''.join(random.choice(chars) for _ in range(size))



   def getViewTypeAndSubjectID(self,message):
      fullURL=message['url']['href']
      pathName=message['url']['pathname']
      queryParameters=theURLparse.parse_qs(message['url']['search'][1:])#1: to eliminate ?
      urlParamsToAdd={}
      #always generate new subjectID in demo
      if self.config['serverType']=="demoExperiment":
         if "subjectID" in queryParameters:
            del queryParameters['subjectID']
      print(pathName)
      if pathName.split("/")[-1]=="video.html":
         viewType="video"
         subjectID="video"
      elif pathName.split("/")[-1]=="monitor.html" or pathName=="/":
         viewType="monitor"
         subjectID="monitor"
      elif pathName.split("/")[-1]=="console.html":
         viewType="console"
         subjectID="console"
      elif pathName.split("/")[-1]=="tester.html":
         viewType="tester"
         subjectID="tester"
      elif pathName.split("/")[-1]=="client.html":
         viewType="regular"
         for k in range(1,1000):
            subjectID="subject%s"%(k)
            if subjectID not in self.data['subjectIDs']:
               break
      else:
         viewType="unknown"
         subjectID="unknown"

      if "subjectID" in queryParameters:#always generate new subjectID for demo
         subjectID=queryParameters["subjectID"][0]
      else:
         urlParamsToAdd["subjectID"]=subjectID
      if "viewType" in queryParameters:
         viewType=queryParameters["viewType"][0]
      else:
         urlParamsToAdd["viewType"]=viewType
      return [subjectID,viewType,urlParamsToAdd,queryParameters]

   def setURLParameters(self,params,sid="all",output="send"):
      for k in params:
         self.data[sid].queryParameters[k]=[params[k]]

      queryString="?"
      queryString+="%s=%s"%("subjectID",self.data[sid].queryParameters["subjectID"][0])
      queryString+="&%s=%s"%("viewType",self.data[sid].queryParameters["viewType"][0])

      for k in self.data[sid].queryParameters:
         if k!="subjectID" and k!="viewType":
            queryString+="&%s=%s"%(k,self.data[sid].queryParameters[k][0])
      msg={}
      msg['type']='setQueryString'
      msg['queryString']=queryString
      return self.messageToId(msg,sid,output)



   def newConnection(self,message,client):
      [subjectID,viewType,urlParamsToAdd,queryParameters]=self.getViewTypeAndSubjectID(message)
      #set subject ID for client
      client.subjectID=subjectID
      if self.config['serverType']=="regularExperiment":
         if viewType=="monitor":
            print("New monitor client")
            client.currentMonitorTable=self.currentMonitorTable
            client.monitorTableSortColumn=[[0,"reg","clientInfo"],[0,"reg","clientInfo"],[0,"reg","clientInfo"],[0,"reg","clientInfo"],[0,"reg","clientInfo"],[0,"reg","clientInfo"]]
            client.page="monitor"
            client.consoleTab=1
            print("New monitor client SET!!!!!!!!!")
            self.monitorClients.append(client)
            self.updateMonitorPage(client)
         elif viewType=="tester":
            print("New tester client")
         elif viewType=="console":
            print("New console client")
            self.consoleClients.append(client)
            self.lastConsoleMessageTime=time.time()-10#this ensures a page refresh
            self.consoleMessage()
         elif viewType=="video":
            print("New video client")
            self.videoClients.append(client)
            self.updateStatus("video")
            if self.data['serverStatus']['page']=="instructions":
               self.reconnectInstructions("video")
         elif viewType=="regular":
            if subjectID not in self.data['subjectIDs']: 
               if self.data['serverStatus']['acceptingClients']==1:
                  self.clientsById[subjectID]=client
                  self.createSubject(subjectID)
                  self.data[subjectID].ipAddress=client.peer
                  self.data[subjectID].connectionStatus='connected'
                  self.data[subjectID].queryParameters=queryParameters
                  self.setURLParameters(urlParamsToAdd,subjectID,output="send")

               elif self.data['serverStatus']['acceptingClients']==0:
                  #IF not accepting send a list of clients
                  msg={}
                  msg['type']="notAccepting"
                  msg["subjectIDs"]=[[x,self.data[x].connectionStatus] for x in self.data["subjectIDs"]]
                  self.messagePythonToJavascript(msg,client)

                  print("New Client Trying to Join: %s, not accepting anymore"%(subjectID))
            elif subjectID in self.data['subjectIDs']:
               print("reconnecting subject %s, %s"%(subjectID,self.data['serverStatus']['page']))
               if subjectID in self.clientsById:
                  #IF a client with that ID is currently connected
                  print("connectAnotherBrowser",subjectID)
                  msg={}
                  msg['type']="connectAnotherBrowser"
                  self.messagePythonToJavascript(msg,self.clientsById[subjectID])
               else:
                  self.clientsById[subjectID]=client
                  reconnectMethod = getattr(self,"reconnectingClient",None)
                  if callable(reconnectMethod):
                     self.reconnectingClient(client)
                  else:
                     self.updateStatus(subjectID)

               self.data[subjectID].ipAddress=client.peer
               self.data[subjectID].connectionStatus='connected'
               self.data[subjectID].queryParameters=queryParameters
               self.setURLParameters(urlParamsToAdd,subjectID,output="send")

      elif self.config['serverType']=="demoExperiment":
         # if subjectID in self.data['subjectIDs']: 
         #    self.deleteSubject(subjectID)
         print("new demo client: %s"%(subjectID))
         self.clientsById[subjectID]=client
         self.createSubject(subjectID)
         self.data[subjectID].ipAddress=client.peer
         self.data[subjectID].queryParameters=queryParameters
         self.data[subjectID].connectionStatus='connected'
         self.displayDemo(viewType,subjectID)
         self.data[subjectID].viewType=viewType
         self.setURLParameters(urlParamsToAdd,subjectID,output="send")
      self.monitorMessage()


   def displayDemo(self,viewType,sid):
      if viewType=="quiz":
         self.quizDemo(sid)
      elif viewType=="instructions":
         self.instructionsDemo(sid)
      else:
         self.experimentDemo(sid,viewType)

   def createSubject(self,subjectID):
      print("new regular client: %s"%(subjectID))
      #This sets self.data[subjectID] to the Subject class which is defined in experiment.py
      thisSubject=self.subjectClass()
      if subjectID!="video":
         self.data['subjectIDs'].append(subjectID)
      thisSubject.subjectID=subjectID
      thisSubject.ipAddress=""
      thisSubject.timer=[0,0,0]
      thisSubject.connectionStatus=""
      self.data[subjectID]=thisSubject
      self.updateStatus(subjectID)

   def deleteSubject(self,subjectID):
      print("Deleteing subject "+subjectID)
      self.data['subjectIDs'].remove(subjectID)
      if subjectID in self.data:
         del self.data[subjectID]
      else:
         print("Trying to delete %s from self.data, but not there"%(subjectID))
      if subjectID in self.clientsById:
         self.clientsById[subjectID].sendClose()
      else:
         print("Trying to delete %s from self.clientsById, but not there"%(subjectID))

   def updateStatus(self,sid="all",output="send"):
      msg={}
      msg['type']='updateStatus'
      return self.messageToId(msg,sid,output)

   def getSubjectIDList(self,sid="all"):
      if isinstance(sid,list):#list of subjectIds
         sids=sid
      elif sid=="video":
         sids=['video']
      elif sid=="all":
         sids=self.data['subjectIDs']
      elif sid=="allPlusVideo":
         sids=self.data['subjectIDs']+["video"]
      else:
         sids=[sid]
      return sids

   def sendListOfMessages(self,messages):
      toSend={}
      for m in messages:
         sid=m["sid"]
         msg=m["msg"]
         if sid not in toSend:
            toSend[sid]=[]
         toSend[sid].append(msg)

      for sid in toSend:
         msg={}
         msg['type']='multipleMessages'
         msg['messages']=toSend[sid]
         self.messageToId(msg,sid,"send")

   def messageToId(self,msg,sid="all",output="send"):
      msg['timers']={}
      for timer in self.data["timers"]:
         msg['timers'][timer]=self.updateTimer(self.data['timers'][timer])
      sids=self.getSubjectIDList(sid)
      msgs=[]
      for s in sids:
         #msg['selfTimer']=self.updateTimer(self.data[s].timer)
         if "subjectID" not in self.data[s].status:
            self.data[s].status['subjectID']=s
         msg['status']=self.data[s].status
         if output=="send":
            self.sendMessageToClientByID(msg,s)
         elif output=="return":
            msgs.append({"msg":msg,"sid":s})
      if output=="return":
         msgs=copy.deepcopy(msgs)
         return msgs

   def sendMessageToClientByID(self,msg,sid):
      if sid=="video":
         try:
            for client in self.videoClients:
               self.messagePythonToJavascript(msg,client)

         except Exception as thisExept: 
            print(thisExept)
            print("can't send %s message to %s"%(msg['type'],sid))
      else:
         try:
            self.messagePythonToJavascript(msg,self.clientsById[sid])
         except Exception as thisExept: 
            print(thisExept)
            print("can't send %s message to %s"%(msg['type'],sid))


   def customMessage(self,subjectID,msg,output="send"):
      #print "send message %s - %s"%(subjectID,msg['type'])
      msg['timers']={}
      for timer in self.data["timers"]:
         msg['timers'][timer]=self.updateTimer(self.data['timers'][timer])
      if subjectID=="video":
         if output=="send":
            try:
               for client in self.videoClients:
                  self.messagePythonToJavascript(msg,client)
            except:
               print("can't send %s message to %s"%(msg['type'],subjectID))
      else:
         #msg['selfTimer']=self.updateTimer(self.data[subjectID].timer)
         msg['status']=self.data[subjectID].status
         if output=="send":
            try:
               self.messagePythonToJavascript(msg,self.clientsById[subjectID])
            except:
               print("can't send %s message to %s"%(msg['type'],subjectID))
      if output=="return":
         msg=copy.deepcopy(msg)
         return msg
   def runCommand(self,message,client):
      try:
         exec(message['command'])
      except Exception as thisExept: 
         print(thisExept)

   def refreshMyPage(self,message,client):
      msg={}
      msg['type']="refreshMyPage"
      return self.messageToId(msg,message['subjectIDIncoming'],"send")

   def deleteThisClient(self,message,client):
      self.deleteSubject(message['subjectIDIncoming'])
      self.monitorMessage()


   def stopPythonServer(self,message,client):
      self.saveData()
      print("To Restart Use:\n")
      print(self.restartString)
      reactor.stop()

   def restartPythonServer(self,message,client):
      reactor.stop()
      print("Starting a new python server")
      string=sys.executable+" "+" ".join(sys.argv)
      # print string
      # os.system(string)
      os.execv(sys.executable,[sys.executable.split("/")[-1]]+sys.argv)

   def consoleMessage(self):
      #this ensures that we won't get memory leak from too many console messages
      if time.time()-self.lastConsoleMessageTime>.1:
         if self.nextConsoleCall!=0:
            if self.nextConsoleCall.cancelled==0 and self.nextConsoleCall.called==0:
               self.nextConsoleCall.cancel()
         self.nextConsoleCall=0
         self.lastConsoleMessageTime=time.time()
         try:
            # for client in self.consoleClients:
            for client in self.monitorClients:
               if client.page=="console":
                  msg={"type":"consoleLinesUpdate"}   
                  msg['monitorTables']=[x for x in self.data['monitorTableInfo']]
                  msg['consoleLines']=self.getCurrentConsoleLines(client.consoleTab)
                  msg=self.getExtraMonitorPageInfo(msg,client)
                  client.sendMessage(json.dumps(msg).encode('utf8'))
         except Exception as thisExept: 
            # print("can't send message to console"+thisExept)
            pass
      else:
         if self.nextConsoleCall==0:
            self.nextConsoleCall=reactor.callLater(.1,self.consoleMessage)
   def getCurrentConsoleLines(self,tab):
      currentTab=tab
      thisFile=self.config['logFolder']+"/pickle/%s.pickle"%(currentTab)
      with open(thisFile,'rb') as file:
         out=[]
         while 3&lt;4:
            try:
               data=pickle.load(file)
               out.append(data)
            except:
               # print(sys.exc_info()[0])
               break

      return out#json.dumps(out).encode('utf8')

   def monitorMessage(self):
      #update at most 10 times per second
      if time.time()-self.lastMonitorMessageSent>.1:
         if self.nextMonitorCall!=0:
            if self.nextMonitorCall.cancelled==0 and self.nextMonitorCall.called==0:
               self.nextMonitorCall.cancel()
         self.nextMonitorCall=0
         self.lastMonitorMessageSent=time.time()
         self.updateMonitorTable()
      else:
         #this ensures that there will be one last monitor message if a lot are received all at the same time
         if self.nextMonitorCall==0:
            try:
               self.nextMonitorCall=reactor.callLater(.1,self.monitorMessage)
            except Exception as e:
               self.nextMonitorCall=0



</code></pre>
</div>

<div class="header">/code/python/modules/monitor.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import json
import pickle
import time
class monitorClass():
   def __init__(self):
      #This should be set in experiment.py
      #self.monitorTaskList=['loadInstructions','startQuiz','startExperiment']
      # self.data['taskList']=self.monitorTaskList
      self.monitorTasks()
      self.data['taskDoneTime']=[]
      self.data['monitorTableInfo']={}
      self.clientInfoSpecificMonitorTableEntries()

   def sendMessageToMonitorClients(self,msg):
      try:
         for client in self.monitorClients:
            if client.page=="monitor":
               msg=self.getExtraMonitorPageInfo(msg,client)
               client.sendMessage(json.dumps(msg).encode('utf8'))
      except Exception as thisExept: 
         print(thisExept)
         print("can't send message to monitor, from sendMessageToMonitorClients")


   #def monitorMessage(self): in mainServer.py so that it can use reactor.


   def updateMonitorPage(self,client):
      self.updateMonitorHeader(client)
      if client.page=="monitor":
         self.updateMonitorTable()
         self.updateTaskTable()
      elif client.page=="console":
         self.lastConsoleMessageTime=time.time()-10#this ensures a page refresh
         self.consoleMessage()
      elif client.page=="serverInfo":
         self.showServerInfo(client)

   def showServerInfo(self,client):
      try:
         msg={'type':"showServerInfo"}
         msg=self.getExtraMonitorPageInfo(msg,client)
         client.sendMessage(json.dumps(msg).encode('utf8'))
      except Exception as thisExept: 
         print(thisExept)
         print("can't send message to monitor, from showServerInfo")


   def updateMonitorHeader(self,client):
      msg={"type":"updateMonitorHeader"}
      msg['currentPage']=client.page
      msg['serverStatus']=self.data['serverStatus']
      msg=self.getExtraMonitorPageInfo(msg,client)
      client.sendMessage(json.dumps(msg).encode('utf8'))

   def newMonitorTable(self):
      for client in self.monitorClients:
         client.currentMonitorTable=self.currentMonitorTable
         self.updateMonitorHeader(client)
      self.updateMonitorTable()
      self.updateTaskTable()

   def updateMonitorTable(self):
      try:
         for client in self.monitorClients:
            if client.page=="monitor":
               msg={"type":"updateMonitorTable"}
               msg['table']=self.getMonitorTable(client)
               msg['serverStatus']=self.data['serverStatus']
               msg=self.getExtraMonitorPageInfo(msg,client)
               client.sendMessage(json.dumps(msg).encode('utf8'))
      except Exception as thisExept: 
         print(thisExept)
         print("can't send message to monitor, from updateMonitorTable")
      
   def updateTaskTable(self):
      msg={"type":"updateTaskTable"}
      msg['taskList']=self.monitorTaskList
      msg['taskStatus']=self.data['taskStatus']
      msg['serverStatus']=self.data['serverStatus']
      msg['dataFile']=self.config['dataFilePath']
      msg['dataFileURL']=self.config['dataFileURL']
      msg['dataFolderURL']=self.config['dataFolderURL']
      self.sendMessageToMonitorClients(msg)

   def toggleAcceptingSwitch(self,message,client):
      self.data['serverStatus']['acceptingClients']=1-self.data['serverStatus']['acceptingClients']
      if self.data['serverStatus']['acceptingClients']==0:
         print("Done Accepting Clients!")
         print("%s Clients Connected"%(len(self.data['subjectIDs'])))
         
         #check to see if notAcceptingClientsAnymore is defined in experiment
         notAcceptingClientsAnymore = getattr(self,"notAcceptingClientsAnymore",None)
         if callable(notAcceptingClientsAnymore):
            self.notAcceptingClientsAnymore()
         else:
            self.notAcceptingClientsAnymoreDefault()
      else:
         print("Accepting Clients Now!")
      self.finalPayoffsSpecificMonitorTableEntries()
      self.monitorMessage()
      self.updateTaskTable()



   def clientInfoSpecificMonitorTableEntries(self):
      self.currentMonitorTable="clientInfo"
      self.data['monitorTableInfo']['clientInfo']=[
         ['Refresh'      ,'"&lt;a href=\'javascript:void(0)\' onclick=\'refreshClient([\\\"%s\\\"]);\'>%s&lt;/a>"%(sid,sid)'],
         ['Connection'     ,'self.data[sid].connectionStatus'],
         ['IP Address'     ,'self.clientsById[sid].peer'],
         ['Delete','"&lt;a href=\'javascript:void(0)\' onclick=\'deleteClient([\\\"%s\\\"]);\'>%s&lt;/a>"%(sid,sid)']         
      ]

   def finalPayoffsSpecificMonitorTableEntries(self):
      try:
         self.currentMonitorTable="finalPayoffs"
         sid=self.data['subjectIDs'][0]
         thisTable=[]
         for k in self.data[sid].finalPayoffs:
            thisTable.append([k,"'$%%.02f'%%(self.data[sid].finalPayoffs['%s'])"%(k)])
         self.data['monitorTableInfo']['finalPayoffs']=thisTable
      except Exception,e: 
         print("can't set final payoffs monitor table",str(e))

   def getMonitorTableValue(self,sid,item):
      try:
         out=eval(item[1])
      except:
         out="NA"
      return out

   def getMonitorTable(self,client):
      thisMonitorTable=[["subjectID","sid"]]+self.data['monitorTableInfo'][client.currentMonitorTable]
      tableData={}
      tableData['subjectIDs']=self.data['subjectIDs']
      tableData['connected']={}
      for sid in self.data['subjectIDs']:
         tableData['connected'][sid]=self.data[sid].connectionStatus
      tableData['titles']=[x[0] for x in thisMonitorTable]
      k=0
      for sid in tableData['subjectIDs']:
         k+=1
         tableData[sid]={}
         for item in thisMonitorTable:
            string=item[0]
            tableData[sid][string]=self.getMonitorTableValue(sid,item)

      tableData=self.sortMonitorTable(tableData,client.monitorTableSortColumn)
      return tableData

   def sortMonitorTable(self,tableData,sortColumns):
      toBeSorted=[]
      for sid in tableData['subjectIDs']:
         thisList=[sid]
         for c in sortColumns:
            index=c[0]
            sortTyep=c[1]
            table=c[2]
            item=self.data['monitorTableInfo'][table][index-1]
            if index==0:
               thisList.append(sid)
            else:
               thisList.append(self.getMonitorTableValue(sid,item))
         toBeSorted.append(thisList)
      index=0
      for c in sortColumns:
         index+=1
         if c[1]=="reg":
            toBeSorted.sort(key=lambda x: x[index])#reverse=True)
         else:
            toBeSorted.sort(key=lambda x: x[index],reverse=True)
         tableData['subjectIDs']=[x[0] for x in toBeSorted]
      return tableData

   def sortMonitorTableMessage(self,message,client):
      if client.monitorTableSortColumn[-1][0]==int(message['col']) and client.monitorTableSortColumn[-1][2]==client.currentMonitorTable:
         if client.monitorTableSortColumn[-1][1]=="rev":
            client.monitorTableSortColumn[-1][1]="reg"
         elif client.monitorTableSortColumn[-1][1]=="reg":
            client.monitorTableSortColumn[-1][1]="rev"
      else:
         client.monitorTableSortColumn.append([int(message['col']),"reg",client.currentMonitorTable])
         client.monitorTableSortColumn=client.monitorTableSortColumn[1:]
      self.monitorMessage()

   def changeMonitorTable(self,message,client):
      client.currentMonitorTable=message["table"]
      client.page="monitor"
      self.updateMonitorPage(client)

   def changeMonitorPage(self,message,client):
      client.page=message["page"]
      self.updateMonitorPage(client)

   def changeConsoleTab(self,message,client):
      if message["tab"]=="first":
         client.consoleTab=1
      elif message["tab"]=="next":
         client.consoleTab+=1
         client.consoleTab=min(client.consoleTab,self.logCounter.fileCount)
      elif message["tab"]=="previous":
         client.consoleTab-=1
         client.consoleTab=max(client.consoleTab,1)
      elif message["tab"]=="last":
         client.consoleTab=self.logCounter.fileCount
      client.page="console"
      self.updateMonitorPage(client)


   def getExtraMonitorPageInfo(self,msg,client):
      msg['consoleTabs']=[client.consoleTab,self.logCounter.fileCount]
      msg['monitorTables']=[x for x in self.data['monitorTableInfo']]
      msg['currentMonitorTable']=client.currentMonitorTable
      return msg

   def taskDone(self,message):
      task=message['type']
      self.data['taskDoneTime'].append([task,time.time()])
      self.data['taskStatus'][task]['status']="Done"
      self.saveData()
      self.newMonitorTable()


   def taskDoneMany(self,message):
      task=message['type']
      self.data['taskDoneTime'].append([task,time.time()])
      self.data['taskStatus'][task]['status']=""
      self.saveData()
      self.newMonitorTable()



   def taskToTitle(self,taskName):
      title=""
      for l in taskName:
         if l.isupper():
            title+=" "
         title+=l
      title=title.title()
      return title

   def monitorTasks(self):
      self.data['taskStatus']={}
      for task in self.monitorTaskList:
         self.data['taskStatus'][task]={}
         self.data['taskStatus'][task]['status']=""
         self.data['taskStatus'][task]['title']=self.taskToTitle(task)

</code></pre>
</div>

<div class="header">/code/python/modules/optionsCommands.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
from optparse import OptionParser
import time
import os,sys,imp

def getOptions():
   #options for running the server
   parser = OptionParser()
   parser.add_option("-l", "--location", dest="location", default="NONE",
                     help="the location where the server is being run, specifics are defined in the config file.")
   parser.add_option("-i", "--ipAddress", dest="ipAddress", default="localhost",
                     help="the server ip address.")
   parser.add_option("-o", "--openBrowser", dest="openBrowser", default="False",
                     help="set to True to open the browser on start.")
   parser.add_option("-r", "--restart", dest="restart", default="False",
                     help="set to the string %Y%m%d-%H%M%S to restart the server.")
   parser.add_option("-d", "--debug", dest="debug", default="False",
                     help="set to True to write to console rather than to the console webpage.")
   parser.add_option("-s", "--saveData", dest="saveData", default="True",
                     help="set to False to write data to tmp folder, rather than unique folder.  This should NEVER be used when you run an experiment in the lab.")
   (options, args) = parser.parse_args()

   if options.location=="NONE":
      sys.exit("ERROR: You must set a location to run the server.  You can see all options by running 'python server.py -h'")


   return options


def getRestartString(config):
   serverStartString=config['serverStartString']
   #Print the restart server string
   if "-r" in sys.argv:
      this=sys.argv
      i=this.index("-r")
      del this[i]
      del this[i]
   restartString="python "+" ".join(sys.argv)+" -r %s"%(serverStartString)
   return restartString 
</code></pre>
</div>

<div class="header">/code/python/modules/questionnaire.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   

class SteepQuestionnaire():
   def __init__(self):
      "no init"

   def startQuestionnaire(self):
      for sid in self.data['subjectIDs']:
         self.data[sid].status['page']="questionnaire"
         self.data[sid].status['subjectID']=sid
         self.updateStatus(sid)

   def startQuestionnaireSubject(self,sid):
      self.data[sid].status['page']="questionnaire"
      self.data[sid].status['payment']=""
      self.data[sid].status['subjectID']=sid
      self.updateStatus(sid)

   def questionnaireAnswers(self,message,client):
      sid=client.subjectID
      self.data[sid].questionnaireAnswers=message['answers']
      self.data[sid].status['doneWithEverything']="True"
      for s in self.data['subjectIDs']:
         self.calculateFinalPayoffs(s)
      self.displayFinalSummary(sid)
      self.monitorMessage()

</code></pre>
</div>

<div class="header">/code/python/modules/timer.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import time
from twisted.internet import reactor
import datetime
class SteepTimerManager():
   def __init__(self):
      self.data['timers']={}
      #Cannot Pickle these!!
      self.timerFunctions={}

   def cancelTimer(self,timerName):
      self.initializeTimer(timerName,0)

   # self.initializeTimer("all",self.data['preStageLengths'][self.data['currentMatch']],self.startMatch)
   # #self.initializeTimer(sid,5,self.pleaseMakeChoice,sid)

   def initializeTimer(self,*args):
      timerName=args[0]
      duration=args[1]
      args2=args[1:]

      self.data['timers'][timerName]=[time.time(),time.time(),duration]
      if timerName in self.timerFunctions:
         if self.timerFunctions[timerName].cancelled==0 and self.timerFunctions[timerName].called==0:
            self.timerFunctions[timerName].cancel()
      if len(args2)>1:
         self.timerFunctions[timerName]=reactor.callLater(*args2)

   def updateTimer(self,timer):
      #timer=currentTime,startTime,totalTime
      timer[0]=time.time()
      remaining=timer[2]-(timer[0]-timer[1])
      return remaining

   def updateTimerPretty(self,timer):
      #timer=currentTime,startTime,totalTime
      timer[0]=time.time()
      remaining=int(timer[2]-(timer[0]-timer[1]))
      return str(datetime.timedelta(seconds=remaining))

</code></pre>
</div>

<div class="header">/code/python/modules/webServer.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import sys
import os
import imp
import pickle
import shutil
if sys.version_info >= (3,0):
   import urllib.parse as theURLparse
else:
   import urlparse as theURLparse

from twisted.web.resource import Resource
from twisted.web.static import File

#Get value from url key function
def getValueFromQueryKey(query,key):
   number=""
   for k in query.split("&"):
      this=k.split("=")
      if this[0]==key:
         number=this[1]
   return number

#Handle HTTP requests
class RequestHandler(Resource):
   isLeaf = True
   def __init__(self,config,debug,restartString,thisLogCounter):
      self.thisCounter=thisLogCounter
      self.config=config

   def render_GET(self, request):
      parsedURL=theURLparse.urlparse(request.uri.decode().replace("//","/"))#scheme,netloc,path,query
      thisPath=parsedURL.path.replace("//","/")
      root,ext=os.path.splitext(thisPath)
      if thisPath=="/" or thisPath=="":
         ext=".py"
         filename="/monitor.py"
         fileFolder=self.config['packageFolder']+"/html/"
         fullPath=self.config['webServerRoot']+fileFolder+filename
      elif thisPath in ["/client.html","/monitor.html","/instructions.html","/video.html","/questionnaire.html","/quiz.html","/serverInfo.html","/tester.html"]:
         ext=".py"
         filename=thisPath.replace(".html",".py").replace("/","")
         fileFolder=self.config['packageFolder']+"/html/"
         fullPath=self.config['webServerRoot']+fileFolder+filename
      elif thisPath in ["/experiment.js","/experiment.py","/experiment.css"]:
         ext="showFiles"
      else:
         root,ext=os.path.splitext(thisPath)
         filename=os.path.basename(thisPath)
         if filename=="":
            filename="index.py"
            ext=".py"
         fileFolder=thisPath.replace(filename,"")
         fullPath=self.config['webServerRoot']+fileFolder+filename
         if filename=="favicon.ico":
            fullPath=self.config['webServerRoot']+self.config['packageFolder']+"/html/triangle.png"
      if ext==".zip":
         #will download the data file for ANY zip extension.
         dataFolder=self.config['webServerRoot']+self.config['dataFolder']
         outputName=self.config['webServerRoot']+self.config['currentExperiment']+"/data/"+self.config['serverStartString']
         fullPath=outputName+".zip"
         print("creating zip file ",fullPath," for data folder ",dataFolder)
         shutil.make_archive(outputName,'zip',dataFolder)
         filename=self.config['serverStartString']+".zip"
         #this causes file to be downloaded automatically rather than being opened in the browser.   
         request.setHeader("Content-Disposition","attachment")
         thisFile=File(fullPath)
         # os.remove(fullPath)
         return File.render_GET(thisFile,request)
      elif ext=="showFiles":
         prismFolder=self.config['packageFolder']+"/css/prism/"
         filename=self.config['webServerRoot']+self.config['currentExperiment']+"/files/"+thisPath
         file = open(filename,'rb')
         fileContent=file.read()
         if thisPath=="/experiment.py":
            extension="python"
         elif thisPath=="/experiment.js":
            extension="js"
         elif thisPath=="/experiment.css":
            extension="css"
         file.close() 
         output="""&lt;html>

&lt;head>
    &lt;link href="%s/prism.css" rel="stylesheet" type="text/css" />
&lt;/head>

&lt;body>
&lt;script src="%s/prism.js">&lt;/script>

&lt;h1>%s&lt;/h1>
&lt;pre class="line-numbers">&lt;code class="language-%s">%s
&lt;/code>&lt;/pre>

&lt;/body>
"""%(prismFolder,prismFolder,thisPath,extension,fileContent)
         return output.encode('utf-8')
      elif os.path.isfile(fullPath):
         if ext==".py":
            print("running %s from %s"%(filename,self.config['webServerRoot']+fileFolder))            
            thisPage = imp.load_source('thisPage',self.config['webServerRoot']+fileFolder+filename)
            output=thisPage.getPage(self.config)
            return output.encode('utf-8')
         elif ext==".m4a":
            request.setHeader("Content-Type","audio/mp4")
            thisFile=File(self.config['webServerRoot']+thisPath)
            return File.render_GET(thisFile,request)
         elif ext==".pickle":         
            #this causes file to be downloaded automatically rather than being opened in the browser.   
            request.setHeader("Content-Disposition","attachment")
            thisFile=File(self.config['webServerRoot']+thisPath)
            return File.render_GET(thisFile,request)
         else:
            #print "getting file: "+self.config['webServerRoot']+fileFolder+filename
            thisFile=File(self.config['webServerRoot']+fileFolder+filename)
            return File.render_GET(thisFile,request)
      else:
         print(request)
         print("ErrorLine: File NOT found: %s"%(fullPath), file=sys.stderr)
         #print >> sys.stderr, "ErrorLine: File NOT found: %s"%(fullPath)
         return "&lt;html>&lt;h1>File Not Found - %s&lt;/h1>&lt;/html>"%(fullPath)






</code></pre>
</div>

<div class="header">/code/python/modules/webSockets.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import json
from autobahn.twisted.websocket import WebSocketServerFactory,WebSocketServerProtocol,listenWS
import time
import pickle 

class SteepWebSocketProtocol(WebSocketServerProtocol):
   def onOpen(self):
      self.factory.register(self)
   def connectionLost(self, reason):
      WebSocketServerProtocol.connectionLost(self, reason)
      self.factory.unregister(self)
   def onMessage(self, payload, isBinary):
      if not isBinary:
         msg = json.loads(payload.decode('utf8'))
         self.factory.messageJavascriptToPython(msg,self)

class SteepWebSocketFactory(WebSocketServerFactory,):
   def __init__(self):
      WebSocketServerFactory.__init__(self)
      self.port=self.config["webSocketPort"]
      self.protocol = SteepWebSocketProtocol
      self.messageLogFile = open(self.config['messageLogFile'],'wb')
      self.messageLogFile.close()
      self.messageLogFile = open(self.config['messageLogFile'],'ab')
      self.messagesFromPythonToJavascript=True
   def messageJavascriptToPython(self,message,client):
      #automatically run the function self.message['type'](message,client) when that message is received
      try:
         sid=client.subjectID
      except:
         sid="sidNotSet"
      message["sid"]=sid
      self.writeToMessageLog(message,"from")
      eval("self.%s(%s,%s)"%(message['type'],'message','client'))

   def messagePythonToJavascript(self,message,client):
      if self.messagesFromPythonToJavascript:
         try:
            sid=client.subjectID
         except:
            sid="sidNotSet"
         message['sid']=sid
         self.writeToMessageLog(message,"to")
         client.sendMessage(json.dumps(message).encode('utf8'))

   def writeToMessageLog(self,message,direction):
      dataToWrite=[direction,time.time(),message]
      # file = open(self.config['messageLogFile'],'ab')
      #protocol for python 3 compatibility
      pickle.dump(dataToWrite,self.messageLogFile,protocol=2)
      # file.close() 

   def register(self, client):
      if client not in self.clients:
         self.clients.append(client)
      # try:
      #    self.data[client.subjectID].connectionStatus='connected'
      #    self.monitorMessage()
      # except:
      #    "do nothing"
   def unregister(self, client):
      if client in self.clients:
         self.clients.remove(client)
         if self.config['serverType']=="demoExperiment":
            if client.subjectID in self.data['subjectIDs']:
               print("DELETING SUBJECT !!!!!",client.subjectID) 
               self.deleteSubject(client.subjectID)
            self.cancelInstructionsCalls(client.subjectID)
         else:
            toDelete=[]
            for k in self.clientsById:
               if self.clientsById[k]==client:
                  toDelete.append(k)
            for k in toDelete:
               del self.clientsById[k]
            try:
               self.data[client.subjectID].connectionStatus='disconnected'
               self.monitorMessage()
            except:
               "do nothing"
            
      if client in self.videoClients:
         self.videoClients.remove(client)
      elif client in self.monitorClients:
         self.monitorClients.remove(client)
      elif client in self.consoleClients:
         self.consoleClients.remove(client)


</code></pre>
</div>

<div class="header">/code/python/server.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">from __future__ import print_function,division,absolute_import   
import sys
import imp
import time
import shutil
import os
import webbrowser
import pathlib
#This is the name of the directory of the module that imported this module
experimentDirectory = pathlib.Path(sys.modules['__main__'].__file__).absolute().parents[1]
#this is the name of the directory that contains the folder containgin this file, in other words: ../
steepDirectory = pathlib.Path(__file__).absolute().parents[1]
#this is the first path that both the steepDirectory and experimentDirectory have in common
for x in steepDirectory.parents:
   if x in experimentDirectory.parents:
      webServerRoot=x
      break
functions = imp.load_source('functions',str(steepDirectory.joinpath('python', 'modules','functions.py')))
from twisted.internet import reactor
from twisted.web.server import Site
from autobahn.twisted.websocket import listenWS


#load options module
optionsCommands = imp.load_source('optionsCommands',str(steepDirectory.joinpath('python', 'modules','optionsCommands.py')))
options=optionsCommands.getOptions()

#get server Start Time String.  This is used for log and data files
if options.restart=="False":
   serverStartString=time.strftime("%Y%m%d-%H%M%S",time.localtime(time.time()))
else:
   serverStartString=options.restart

#Save data to temporary file.  This avoids clutter
if options.saveData=="False":
   serverStartString="tmp"

#set Location for config
config={}
config['location']=options.location
config['webServerRoot']=str(webServerRoot)+"/"
config['currentExperiment']="/"+str((experimentDirectory.relative_to(webServerRoot)))+"/"
config['packageFolder']="/"+str((steepDirectory.relative_to(webServerRoot)))+"/"
try:
   locationSettings = imp.load_source('locationSettings',str(steepDirectory.joinpath('locations','%s.py'%(options.location))))
   if options.location=="local":
      config=locationSettings.getLocation(config,options.ipAddress)#can add ip address if running local.
   else:
      config=locationSettings.getLocation(config)
except Exception as ex:
   functions.printColor("Warning:","red",["background","flash"])
   functions.printColor("Can't load location file %s/locations/%s.py.\n"%(steepDirectory,options.location),"red")
   functions.printColor("Exception was: "+str(ex),"red")
config['location']=options.location

#Add serverStartString to config file
config['serverStartString']=serverStartString

#Add server reStartString to config file
restartString=optionsCommands.getRestartString(config)
config['restartString']=restartString

configFunctions = imp.load_source('configFunctions',str(steepDirectory.joinpath('python', 'modules','configFunctions.py')))
config=configFunctions.setOtherFileLocations(config)

#blank function place holder for furutre monitor message that will be used to update console page on demand
def testFunction():
   pass
logger = imp.load_source('logger',str(steepDirectory.joinpath('python', 'modules','logger.py')))
thisLogCounter= logger.logCounter()
sys.stdout = logger.SteepLogger(sys.stdout,"stdout",config,thisLogCounter,testFunction)
sys.stderr = logger.SteepLogger(sys.stderr,"stderr",config,thisLogCounter,testFunction)

from twisted.python.log import startLogging,addObserver
#This removes regular twisted messages from the console
startLogging(open(config['twistedLogFile'], 'w'),setStdout=False)
#this send all those twisted messages to the logger.twistedObserver function to be parsed and sent to stdout.
addObserver(logger.twistedObserver)
log=sys.stdout.write


#Print TMP data file warning
if options.saveData=="False":
   kwargs={"color":"rgba(150,0,0,1)","backgroundColor":"rgba(255,0,0,.1)","left":"0px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right"}   
   log("Warning:\n",**kwargs)
   kwargs={"color":"rgba(150,0,0,1)","backgroundColor":"rgba(255,0,0,.1)","left":"320px","width":"1100px","fontSize":"200%","textAlign":"left","height":"40px","sameLine":"True"}   
   log("Saving Data to TMP file, and potentially rewriting old tmp data.\n",**kwargs)
   kwargs['sameLine']='False'
   log("This is fine if you are just testing.\n",**kwargs)
   log("Use '-s True' or remove '-s False' to save data to new folder.\n",**kwargs)


#python version
kwargs={"color":"blue","backgroundColor":"rgba(0,0,255,.1)","textAlign":"center","fontSize":"300%","height":"100px"}
log("Running STEEP server.\n",**kwargs)
kwargs={"color":"black","backgroundColor":"rgba(255,255,0,.1)","left":"0px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right"}   
log("Python info:\n",**kwargs)
kwargs={"color":"black","backgroundColor":"rgba(255,255,0,.1)","left":"300px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right","sameLine":"True"}   
log("\tPython version:\n",**kwargs)
kwargs={"color":"orange","backgroundColor":"rgba(255,255,0,.1)","left":"620px","width":"780px","height":"40px","fontSize":"200%","textAlign":"left","sameLine":"True"}   
log(sys.version.split("\n")[0]+"\n",**kwargs)
kwargs={"color":"black","backgroundColor":"rgba(255,255,0,.1)","left":"300px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right","sameLine":"False"}   
log("\tPython executable:\n",**kwargs)
kwargs={"color":"orange","backgroundColor":"rgba(255,255,0,.1)","left":"620px","width":"780px","height":"40px","fontSize":"200%","textAlign":"left","sameLine":"True"}   
log(sys.executable+"\n\n",**kwargs)
kwargs={"color":"black","backgroundColor":"rgba(255,0,255,.1)","left":"0px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right"}   
log("Current IP Addresses:\n",**kwargs)
import netifaces as ni
sameLine="True"
for k in ni.interfaces():
   ni.ifaddresses(k)
   try:  
      # print(ni.ifaddresses(k))
      ip = ni.ifaddresses(k)[2][0]['addr']
      kwargs={"color":"black","backgroundColor":"rgba(255,0,255,.1)","left":"200px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right","sameLine":sameLine}   
      log("%s:\n"%(k),**kwargs)
      kwargs={"color":"red","backgroundColor":"rgba(255,0,255,.1)","left":"520px","width":"780px","height":"40px","fontSize":"200%","textAlign":"left","sameLine":"True"}   
      log("%s\n"%(ip),**kwargs)
      sameLine='False'
   except:# Exception,e: 
      "do nothing"
      #print("no address",str(e))
      

#print restart script
kwargs={"color":"black","backgroundColor":"rgba(0,255,0,.1)","left":"0px","width":"300px","height":"50px","fontSize":"200%","textAlign":"right"}   
log("To restart the server use:\n",**kwargs)
kwargs={"color":"black","backgroundColor":"rgba(0,255,0,.1)","left":"0px","width":"100%","height":"50px","fontSize":"200%","textAlign":"center","userSelect":"all"}   
log(restartString+"\n",**kwargs)

#Print server starting message
if options.restart!="False":
   log("\nSERVER RESTARTING - %s!!!\n\n"%(serverStartString),**kwargs)


kwargs={"color":"blue","backgroundColor":"rgba(0,0,255,.1)","left":"0px","width":"300px","height":"40px","fontSize":"200%","textAlign":"right"}   
log("Config File Info:\n",**kwargs)
firstList=["currentExperiment","location","domain","serverPort","dataFileURL","serverType"]
for k in firstList:
   kwargs={"color":"black","backgroundColor":"rgba(0,0,255,.1)","left":"0px","width":"200px","fontSize":"150%","textAlign":"right"}   
   log("%s:  \n"%(k),**kwargs)
   kwargs={"color":"blue","backgroundColor":"rgba(0,0,255,.1)","left":"200px","width":"1200px","fontSize":"150%","textAlign":"left","sameLine":"True"}   
   log("%s\n"%(config[k]),**kwargs)

for k in config:
   if k not in firstList:
      kwargs={"color":"black","backgroundColor":"rgba(0,0,255,.1)","left":"0px","width":"200px","fontSize":"150%","textAlign":"right"}   
      log("%s:  \n"%(k),**kwargs)
      kwargs={"color":"blue","backgroundColor":"rgba(0,0,255,.1)","left":"200px","width":"1200px","fontSize":"150%","textAlign":"left","sameLine":"True"}   
      log("%s\n"%(config[k]),**kwargs)


#load the experiment file
experimentFile = str(experimentDirectory.joinpath('files','experiment.py'))
experiment = imp.load_source('experiment', experimentFile)
from experiment import experimentClass as experimentClassRaw
from experiment import subjectClass as subjectClassRaw

#add to config if needed:
try:
   experiment.addToConfig(config)
except:
   "addToConfig not included in experiment.py.  Use this function to modify config"
configFunctions.writeJavascriptConfigFile(config)


#add plugins from config
#in order for plugins to work ALL experiment.py files must have super function in __init__
if "plugins" in config:
   experimentClasses=[experimentClassRaw]
   subjectClasses=[subjectClassRaw]
   for plugin in config['plugins']:
      j=config['plugins'].index(plugin)
      path=plugin[0]
      pluginLocation=plugin[1]
      if pluginLocation=="relative":
         pluginFile = str(experimentDirectory.joinpath('files',path))
      elif pluginLocation=="absolute":
         pluginFile = str(experimentDirectory.joinpath(path))
      imp.load_source('pluginExperimentModules%s'%(j),pluginFile)
      exec("from pluginExperimentModules%s import experimentClass as pluginExperimentClass"%(j))
      exec("from pluginExperimentModules%s import subjectClass as pluginSubjectClass"%(j))
      experimentClasses.append(pluginExperimentClass)
      subjectClasses.append(pluginSubjectClass)
   experimentClass = type('experimentClass',tuple(experimentClasses), {})
   subjectClass = type('subjectClass',tuple(subjectClasses), {})
else:
   experimentClass=experimentClassRaw
   subjectClass=subjectClassRaw


# if "plugins" in config:
#    subjectClasses=[subjectClassRaw]
#    for plugin in config['plugins']:
#       j=100+config['plugins'].index(plugin)
#       path=plugin[0]
#       pluginLocation=plugin[1]
#       if pluginLocation=="relative":
#          pluginFile = str(experimentDirectory.joinpath('files',path))
#          imp.load_source('pluginSubjectModules%s'%(j),pluginFile)
#          exec("from pluginSubjectModules%s import subjectClass as thisSubjectClass"%(j))
#          x=thisSubjectClass()
#          print(dir(x))
#       elif pluginLocation=="absolute":
#          pluginFile = str(experimentDirectory.joinpath(path))
#          imp.load_source('pluginSubjectModules%s'%(j),pluginFile)
#          exec("from pluginSubjectModules%s import subjectClass as thisSubjectClass"%(j))
#       subjectClasses.append(thisSubjectClass)
#    print("!!!!!!!!!!!!!!",len(subjectClasses))
#    for k in subjectClasses:
#       print("24234234234234",k)
#       print(dir(k))
#    subjectClass = type('subjectClass',tuple(subjectClasses), {})
# else:
#    subjectClass=subjectClassRaw





#copy experiment file for later viewing
dataFolderFiles=config['webServerRoot']+config['dataFolder']+"/files/"
if not os.path.exists(dataFolderFiles):
   os.makedirs(dataFolderFiles)
shutil.copyfile(experimentFile,dataFolderFiles+"/experiment.py")
shutil.copyfile(experimentFile.replace(".py",".js"),dataFolderFiles+"/experiment.js")
shutil.copyfile(experimentFile.replace(".py",".css"),dataFolderFiles+"/experiment.css")

#load webServer module
steepWebServer = imp.load_source('steepWebServer',str(steepDirectory.joinpath('python', 'modules','webServer.py')))

#load websockets module
steepWebSockets = imp.load_source('steepWebSockets',str(steepDirectory.joinpath('python', 'modules','webSockets.py')))
from steepWebSockets import SteepWebSocketFactory

#load mainServer module
steepMainServer = imp.load_source('steepMainServer',str(steepDirectory.joinpath('python', 'modules','mainServer.py')))
from steepMainServer import SteepMainServer


class ExperimentInstructions():
   def __init__(self):
      "defin blank class in case not importing other"
class SteepInstructions():
   def __init__(self):
      "defin blank class in case not importing other"
if 'instructions' in config:
   #load experiment specific quiz module
   experimentInstructionsFile=config['webServerRoot']+config['currentExperiment']+"/files/instructions.py"
   experimentInstructions = imp.load_source('experimentInstructions',experimentInstructionsFile)
   shutil.copyfile(experimentInstructionsFile,dataFolderFiles+"/instructions.py")
   from experimentInstructions import ExperimentInstructions
   
   #load instructions module
   steepInstructions = imp.load_source('steepInstructions',str(steepDirectory.joinpath('python', 'modules','instructions.py')))
   from steepInstructions import SteepInstructions


#load monitor module
steepMonitor = imp.load_source('steepMonitor',str(steepDirectory.joinpath('python', 'modules','monitor.py')))
from steepMonitor import monitorClass

#load timer module
steepTimer = imp.load_source('steepTimer',str(steepDirectory.joinpath('python', 'modules','timer.py')))
from steepTimer import SteepTimerManager

class SteepServerClass(SteepMainServer,SteepWebSocketFactory,experimentClass,monitorClass,subjectClass,SteepInstructions,SteepTimerManager,ExperimentInstructions):
   def __init__(self,config,options,log,thisLogCounter):
      self.subjectClass=subjectClass
      self.logCounter=thisLogCounter
      self.log=log
      self.config=config
      self.options=options
      self.restartString=optionsCommands.getRestartString(self.config)
      SteepWebSocketFactory.__init__(self)
      SteepMainServer.__init__(self)
      SteepTimerManager.__init__(self)
      experimentClass.__init__(self)
      SteepInstructions.__init__(self)
      monitorClass.__init__(self)
      ExperimentInstructions.__init__(self)
      sys.stdout.consoleMessage=self.consoleMessage
      sys.stderr.consoleMessage=self.consoleMessage


#websockets
factory = SteepServerClass(config,options,log,thisLogCounter)
listenWS(factory)

#webserver
resource = steepWebServer.RequestHandler(config,options.debug,restartString,thisLogCounter)
factory = Site(resource)
reactor.listenTCP(resource.config['serverPort'], factory)

if options.openBrowser=="True":
   url = 'http://localhost:%s'%(resource.config['serverPort'])
   webbrowser.open(url)

reactor.run()


</code></pre>
</div>

<div class="header">/examples/memoryLeakTest/analyze/messageLog.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 

filename='../data/tmp/logs/messagesLog.pickle'
with open(filename,'rb') as f:
	while True:
		try:
			data=pickle.load(f)
			print data[0],data[1],data[2]['type'],data[2]['sid']
		except Exception,e: 
			print str(e)
			break

</code></pre>
</div>

<div class="header">/examples/memoryLeakTest/analyze/readData.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 


filename='../data/tmp/tmp.pickle'
file = open(filename,'rb')
data=pickle.load(file)
file.close() 

for sid in data['subjectIDs']:
   print sid,data[sid].choices
</code></pre>
</div>

<div class="header">/examples/memoryLeakTest/files/experiment.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">#makeChoiceButton {
    position: absolute;
    top: 400px;
    left: 700px;
    width: 200px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    background-color: rgba(255, 0, 0, .11);
}

#matchText {
    color: black;
    position: absolute;
    top: 200px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}

#numberClicks {
    position: absolute;
    top: 700px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}
</code></pre>
</div>

<div class="header">/examples/memoryLeakTest/files/experiment.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Message // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function sendParameters(msg){
    window.payoffVariable=msg['payoffVariable'];
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Draw Interface // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function drawButton() {
    placeText({"divid":"makeChoiceButton","text":"Click Here to Submit","top":"400px","left":"700px","width":"200px","height":"100px","backgroundColor":"rgba(255,0,0,.11)",'border':'5px solid transparent'})
    clickButton("many","makeChoiceButton",makeChoiceButtonClicked,27);
    hoverDivChangeOtherDiv("makeChoiceButton","makeChoiceButton",{'border':'5px solid red'});
}

function drawMatch(currentMatch) {
    var matchText = createAndAddDiv("matchText","mainDiv");
    var thisText = "Match #" + currentMatch + "  Time: &lt;time id='everyoneTimer'>0&lt;/time>";
    placeText({"divid":"matchText","text":thisText,"top":"200px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});

    if(window.state['warning']=="yes"){
        var thisColor="red";
        var thisText = "Please make choice!!!";
    }
    else{
        var thisColor="black";
        var personalTimer="myTimeCanBeLabledAnything"+window.state['subjectID']
        var thisText = "My Personal Timer That is Subject Specific: &lt;time id='"+personalTimer+"'>0&lt;/time>";
        moveTimer(personalTimer);
    }

    placeText({"divid":"myMatchText","color":thisColor,"text":thisText,"top":"600px","height":"100px","fontSize":"25px","lineHeight":"50px","width":"100%"});

    moveTimer("everyoneTimer");
}

function drawStatus(number) {
    var thisText = "There have been " + number + " clicks so far.";
    placeText({"divid":"numberClicks","text":thisText,"top":"700px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Actions // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function makeChoiceButtonClicked(someVariable) {
    var message = { "type": "makeChoice", "variable": someVariable };
    sendMessage(message);
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Pages // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function game(){
    clearAll();
    drawButton();
    drawMatch(thisStatus['currentMatch']);
    drawStatus(thisStatus['numberClicks']);
}

function postMatch(){
    clearAll();
    genericScreen("That match is over.  The next match will start in &lt;time id='timer'>0&lt;/time>");
    moveTimer("timer");
}
</code></pre>
</div>

<div class="header">/examples/memoryLeakTest/files/experiment.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#file: experiment.py
#this is where you will define the experimentClass class, subjectClass class, and monitorClass class
from __future__ import print_function
import os

class experimentClass():
   # - the dictionary self.data will be stored automatically every 10 seconds.
   # - store data in self.data[subjectID] which is a Subject class (defined below)
   # - send messages like self.customMessage(subjectID,msg)
   # - list of all subjects at self.data['subjectIDs']
   def __init__(self):
      # initialize the class
      self.setParameters()
      #these are function that can be run by clicking a button on the monitor page
      self.monitorTaskList=['startExperiment']
   def setParameters(self):
      self.data['exchangeRate']=.1
      self.currentMatch=-1
      self.currentClicks=-1
 
   def sendParameters(self,sid):
      msg={}
      msg['payoffVariable']=2
      msg['type']="sendParameters"
      self.customMessage(sid,msg)

   def notAcceptingClientsAnymore(self):
      #This is run when you stop accepting clients.  This is where you might want to do your random matching, or randomly determine parameters for the experiment.
      print(self.data['subjectIDs'])
   
   def reconnectingClient(self,client):
      #This function is needed, DO NOT DELETE
      sid=client.subjectID
      self.sendParameters(sid)
      for k in range(150):
         self.updateStatus(sid)

   def startExperiment(self,message,client):
      #this is run when you click the "start Experiment" button on the monitor page.
      self.taskDone(message)
      
      #this sets the monitor table as defined in the function below
      self.experimentSpecificMonitorTableEntries()
      #this updates the monitor table
      self.monitorMessage()

      self.startMatch()
      print("Starting Experiment!")

   def startMatch(self):
      #add 1 to self.currentMatch
      self.currentMatch+=1
      #set current clicks for this match to 0
      self.currentClicks=0
      #this starts a timer for all subject that lasts 120 seconds and runs the function self.endMatch after it expires. 
      self.initializeTimer("everyoneTimer",120,self.endMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].matchClicks=0
         self.data[sid].status={"page":"game","numberClicks":0,"currentMatch":self.currentMatch,"warning":"no"}
         self.updateStatus(sid)
      #update monitor screen:
      self.monitorMessage()

   def makeChoice(self,message,client):
      #this function is run when the sever receives a message from a client such that message['type']="makeChoice"
      #get subjectID
      sid=client.subjectID
      #Add 1 to the number of currentClicks for self.currentMatch
      self.currentClicks+=1
      self.data[sid].matchClicks+=1
      #Record the data to self.data to be saved. This adds a list [currentMatch,#clicks] to self.data[sid].choices     
      self.data[sid].choices.append([self.currentMatch,self.currentClicks])
      #start a self timer "can be called anything"
      self.initializeTimer("myTimeCanBeLabledAnything"+sid,5,self.highlightMakeChoice,sid)

      #Check if there are more than 10 clicks, if so run self.endMatch, otherwise, run self.updateClicks      
      if self.currentClicks>10:
         self.endMatch()
      else:
         self.updateClicks()

      #update monitor screen:
      self.monitorMessage()


   def highlightMakeChoice(self,sid):
      self.data[sid].status['warning']="yes"
      self.updateStatus(sid)

   def updateClicks(self):
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"game","numberClicks":self.currentClicks,"currentMatch":self.currentMatch}
         self.updateStatus(sid)

   def endMatch(self):
      #wait 10 seconds, and then run self.startMatch to start the next match
      self.initializeTimer("timer",10,self.startMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"postMatch","stage":"noChoices"}
         self.updateStatus(sid)
      

   def experimentSpecificMonitorTableEntries(self):
      self.data['monitorTableInfo']=[
      ['page'           ,'self.data[sid].status["page"]'],
      ['stage'          ,'self.data[sid].status["stage"]'],
      ['Match#'          ,'self.currentMatch'],
      ['My Clicks'         ,'self.data[sid].matchClicks'],
      ['Total Clicks'            ,'self.currentClicks'],
      ]
      self.updateMonitorTableEntries()


class subjectClass():
   def __init__(self):
      #the subjectID is automatically defined in server.py, and can be accessed with self.subjectID
      #every time the client clicks the button will be recorded here.
      self.choices=[]
      #the total payoffs are recorded here
      self.totalPayoffs=0
      #the subject status is initialized here.  Any time this is changed, you can update the client with self.updateStatus(subjectID)
      self.status={}
      self.status['page']="generic"
      self.status['message']=["Please read, sign, and date your consent form. &lt;br> You may read over the instructions as we wait to begin."]

      #number of clicks this match
      self.matchClicks=0



if __name__ == "__main__":
   import imp
   filename="../../../code/python/server.py"
   completePathToServerDotPyFile=os.path.abspath(filename) 
   server = imp.load_source('server',completePathToServerDotPyFile)
   #python experiment.py -l local -o True -s False



</code></pre>
</div>

<div class="header">/examples/simple/analyze/messageLog.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 

filename='../data/tmp/logs/messagesLog.pickle'
with open(filename,'rb') as f:
	while True:
		try:
			data=pickle.load(f)
			print data[0],data[1],data[2]['type'],data[2]['sid']
		except Exception,e: 
			print str(e)
			break

</code></pre>
</div>

<div class="header">/examples/simple/analyze/readData.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 


filename='../data/tmp/tmp.pickle'
file = open(filename,'rb')
data=pickle.load(file)
file.close() 

for sid in data['subjectIDs']:
   print sid,data[sid].choices
</code></pre>
</div>

<div class="header">/examples/simple/files/experiment.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">#makeChoiceButton {
    position: absolute;
    top: 400px;
    left: 700px;
    width: 200px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    background-color: rgba(255, 0, 0, .11);
}

#matchText {
    color: black;
    position: absolute;
    top: 200px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}

#numberClicks {
    position: absolute;
    top: 700px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}
</code></pre>
</div>

<div class="header">/examples/simple/files/experiment.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Message // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function sendParameters(msg){
    window.payoffVariable=msg['payoffVariable'];
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Draw Interface // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function drawButton() {
    placeText({"divid":"makeChoiceButton","text":"Click Here to Submit","top":"400px","left":"700px","width":"200px","height":"100px","backgroundColor":"rgba(255,0,0,.11)",'border':'5px solid transparent'})
    clickButton("many","makeChoiceButton",makeChoiceButtonClicked,27);
    hoverDivChangeOtherDiv("makeChoiceButton","makeChoiceButton",{'border':'5px solid red'});
}

function drawMatch(currentMatch) {
    var matchText = createAndAddDiv("matchText","mainDiv");
    var thisText = "Match #" + currentMatch + "  Time: &lt;time id='everyoneTimer'>0&lt;/time>";
    placeText({"divid":"matchText","text":thisText,"top":"200px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});

    if(window.state['warning']=="yes"){
        var thisColor="red";
        var thisText = "Please make choice!!!";
    }
    else{
        var thisColor="black";
        var personalTimer="myTimeCanBeLabledAnything"+window.state['subjectID']
        var thisText = "My Personal Timer That is Subject Specific: &lt;time id='"+personalTimer+"'>0&lt;/time>";
        moveTimer(personalTimer);
    }

    placeText({"divid":"myMatchText","color":thisColor,"text":thisText,"top":"600px","height":"100px","fontSize":"25px","lineHeight":"50px","width":"100%"});

    moveTimer("everyoneTimer");
}

function drawStatus(number) {
    var thisText = "There have been " + number + " clicks so far.";
    placeText({"divid":"numberClicks","text":thisText,"top":"700px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Actions // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function makeChoiceButtonClicked(someVariable) {
    var message = { "type": "makeChoice", "variable": someVariable };
    sendMessage(message);
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Pages // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function game(){
    clearAll();
    drawButton();
    drawMatch(thisStatus['currentMatch']);
    drawStatus(thisStatus['numberClicks']);
}

function postMatch(){
    clearAll();
    genericScreen("That match is over.  The next match will start in &lt;time id='timer'>0&lt;/time>");
    moveTimer("timer");
}
</code></pre>
</div>

<div class="header">/examples/simple/files/experiment.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#file: experiment.py
#this is where you will define the experimentClass class, subjectClass class, and monitorClass class
from __future__ import print_function
import os

class experimentClass():
   # - the dictionary self.data will be stored automatically every 10 seconds.
   # - store data in self.data[subjectID] which is a Subject class (defined below)
   # - send messages like self.messageToId(msg,subjectID)
   # - list of all subjects at self.data['subjectIDs']
   def __init__(self):
      # initialize the class
      self.setParameters()
      #these are function that can be run by clicking a button on the monitor page
      self.monitorTaskList=['startExperiment']
   def setParameters(self):
      self.data['exchangeRate']=.1
      self.currentMatch=-1
      self.currentClicks=-1
 
   def sendParameters(self,sid):
      msg={}
      msg['payoffVariable']=2
      msg['type']="sendParameters"
      self.messageToId(msg,sid)

   def notAcceptingClientsAnymore(self):
      #This is run when you stop accepting clients.  This is where you might want to do your random matching, or randomly determine parameters for the experiment.
      print(self.data['subjectIDs'])
   
   def reconnectingClient(self,client):
      #This function is needed, DO NOT DELETE
      sid=client.subjectID
      self.sendParameters(sid)
      self.updateStatus(sid)

   def startExperiment(self,message,client):
      #this is run when you click the "start Experiment" button on the monitor page.
      self.taskDone(message)
      
      #this sets the monitor table as defined in the function below
      self.experimentSpecificMonitorTableEntries()
      #this updates the monitor table
      self.monitorMessage()

      self.startMatch()
      print("Starting Experiment!")

   def startMatch(self):
      #add 1 to self.currentMatch
      self.currentMatch+=1
      #set current clicks for this match to 0
      self.currentClicks=0
      #this starts a timer for all subject that lasts 120 seconds and runs the function self.endMatch after it expires. 
      self.initializeTimer("everyoneTimer",120,self.endMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].matchClicks=0
         self.data[sid].status={"page":"game","numberClicks":0,"currentMatch":self.currentMatch,"warning":"no"}
         self.updateStatus(sid)
      #update monitor screen:
      self.monitorMessage()

   def makeChoice(self,message,client):
      #this function is run when the sever receives a message from a client such that message['type']="makeChoice"
      #get subjectID
      sid=client.subjectID
      #Add 1 to the number of currentClicks for self.currentMatch
      self.currentClicks+=1
      self.data[sid].matchClicks+=1
      #Record the data to self.data to be saved. This adds a list [currentMatch,#clicks] to self.data[sid].choices     
      self.data[sid].choices.append([self.currentMatch,self.currentClicks])
      #start a self timer "can be called anything"
      self.initializeTimer("myTimeCanBeLabledAnything"+sid,5,self.highlightMakeChoice,sid)

      #Check if there are more than 10 clicks, if so run self.endMatch, otherwise, run self.updateClicks      
      if self.currentClicks>10:
         self.endMatch()
      else:
         self.updateClicks()

      #update monitor screen:
      self.monitorMessage()


   def highlightMakeChoice(self,sid):
      self.data[sid].status['warning']="yes"
      self.updateStatus(sid)

   def updateClicks(self):
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"game","numberClicks":self.currentClicks,"currentMatch":self.currentMatch}
         self.updateStatus(sid)

   def endMatch(self):
      #wait 10 seconds, and then run self.startMatch to start the next match
      self.initializeTimer("timer",10,self.startMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"postMatch","stage":"noChoices"}
         self.updateStatus(sid)
      

   def experimentSpecificMonitorTableEntries(self):
      self.currentMonitorTable="experiment"
      self.data['monitorTableInfo']['experiment']=[
      ['page'           ,'self.data[sid].status["page"]'],
      ['stage'          ,'self.data[sid].status["stage"]'],
      ['Match#'          ,'self.currentMatch'],
      ['My Clicks'         ,'self.data[sid].matchClicks'],
      ['Total Clicks'            ,'self.currentClicks'],
      ]
      self.newMonitorTable()


class subjectClass():
   def __init__(self):
      #the subjectID is automatically defined in server.py, and can be accessed with self.subjectID
      #every time the client clicks the button will be recorded here.
      self.choices=[]
      #the total payoffs are recorded here
      self.totalPayoffs=0
      #the subject status is initialized here.  Any time this is changed, you can update the client with self.updateStatus(subjectID)
      self.status={}
      self.status['page']="generic"
      self.status['message']=["Please read, sign, and date your consent form. &lt;br> You may read over the instructions as we wait to begin."]

      #number of clicks this match
      self.matchClicks=0



if __name__ == "__main__":
   import imp
   filename="../../../code/python/server.py"
   completePathToServerDotPyFile=os.path.abspath(filename) 
   server = imp.load_source('server',completePathToServerDotPyFile)
   #python experiment.py -l local -o True -s False



</code></pre>
</div>

<div class="header">/examples/speedTest/analyze/messageLog.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 

filename='../data/tmp/logs/messagesLog.pickle'
with open(filename,'rb') as f:
	while True:
		try:
			data=pickle.load(f)
			print data[0],data[1],data[2]['type'],data[2]['sid']
		except Exception,e: 
			print str(e)
			break

</code></pre>
</div>

<div class="header">/examples/speedTest/analyze/readData.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 


filename='../data/tmp/tmp.pickle'
file = open(filename,'rb')
data=pickle.load(file)
file.close() 

for sid in data['subjectIDs']:
   print sid,data[sid].choices
</code></pre>
</div>

<div class="header">/examples/speedTest/files/experiment.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">#makeChoiceButton {
    position: absolute;
    top: 400px;
    left: 700px;
    width: 200px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    background-color: rgba(255, 0, 0, .11);
}

#matchText {
    color: black;
    position: absolute;
    top: 200px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}

#numberClicks {
    position: absolute;
    top: 700px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}
</code></pre>
</div>

<div class="header">/examples/speedTest/files/experiment.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Message // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function sendParameters(msg){
    window.payoffVariable=msg['payoffVariable'];
}

function updateNumberClicks(msg){
    console.log(msg['number'],new Date().getTime());
    document.getElementById("numberClicks").innerHTML="There have been " + msg['number'] + " clicks so far.";
}
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Draw Interface // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function drawButton() {
    placeText({"divid":"makeChoiceButton","text":"Click Here to Submit","top":"400px","left":"700px","width":"200px","height":"100px","backgroundColor":"rgba(255,0,0,.11)",'border':'5px solid transparent'})
    clickButton("many","makeChoiceButton",makeChoiceButtonClicked,27);
    hoverDivChangeOtherDiv("makeChoiceButton","makeChoiceButton",{'border':'5px solid red'});
}

function drawMatch(currentMatch) {
    var matchText = createAndAddDiv("matchText","mainDiv");
    var thisText = "Match #" + currentMatch + "  Time: &lt;time id='everyoneTimer'>0&lt;/time>";
    placeText({"divid":"matchText","text":thisText,"top":"200px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});

    if(window.state['warning']=="yes"){
        var thisColor="red";
        var thisText = "Please make choice!!!";
    }
    else{
        var thisColor="black";
        var personalTimer="myTimeCanBeLabledAnything"+window.state['subjectID']
        var thisText = "My Personal Timer That is Subject Specific: &lt;time id='"+personalTimer+"'>0&lt;/time>";
        moveTimer(personalTimer);
    }

    placeText({"divid":"myMatchText","color":thisColor,"text":thisText,"top":"600px","height":"100px","fontSize":"25px","lineHeight":"50px","width":"100%"});

    moveTimer("everyoneTimer");
}

function drawStatus(number) {
    var thisText = "There have been " + number + " clicks so far.";
    placeText({"divid":"numberClicks","text":thisText,"top":"700px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Actions // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function makeChoiceButtonClicked(someVariable) {
    var message = { "type": "makeChoice", "variable": someVariable };
    for(k=0;k&lt;1000;k++){
        window.setTimeout(function(){
            sendMessage(message);
        }, k);
    }
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Pages // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function game(){
    clearAll();
    drawButton();
    drawMatch(thisStatus['currentMatch']);
    drawStatus(thisStatus['numberClicks']);
}

function postMatch(){
    clearAll();
    genericScreen("That match is over.  The next match will start in &lt;time id='timer'>0&lt;/time>");
    moveTimer("timer");
}
</code></pre>
</div>

<div class="header">/examples/speedTest/files/experiment.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#file: experiment.py
#this is where you will define the experimentClass class, subjectClass class, and monitorClass class
from __future__ import print_function
import os

class experimentClass():
   # - the dictionary self.data will be stored automatically every 10 seconds.
   # - store data in self.data[subjectID] which is a Subject class (defined below)
   # - send messages like self.customMessage(subjectID,msg)
   # - list of all subjects at self.data['subjectIDs']
   def __init__(self):
      # initialize the class
      self.setParameters()
      #these are function that can be run by clicking a button on the monitor page
      self.monitorTaskList=['startExperiment']
   def setParameters(self):
      self.data['exchangeRate']=.1
      self.currentMatch=-1
      self.currentClicks=-1
 
   def sendParameters(self,sid):
      msg={}
      msg['payoffVariable']=2
      msg['type']="sendParameters"
      self.customMessage(sid,msg)

   def notAcceptingClientsAnymore(self):
      #This is run when you stop accepting clients.  This is where you might want to do your random matching, or randomly determine parameters for the experiment.
      print(self.data['subjectIDs'])
   
   def reconnectingClient(self,client):
      #This function is needed, DO NOT DELETE
      sid=client.subjectID
      self.sendParameters(sid)
      self.updateStatus(sid)

   def startExperiment(self,message,client):
      #this is run when you click the "start Experiment" button on the monitor page.
      self.taskDone(message)
      
      #this sets the monitor table as defined in the function below
      self.experimentSpecificMonitorTableEntries()
      #this updates the monitor table
      self.monitorMessage()

      self.startMatch()
      print("Starting Experiment!")

   def startMatch(self):
      #add 1 to self.currentMatch
      self.currentMatch+=1
      #set current clicks for this match to 0
      self.currentClicks=0
      #this starts a timer for all subject that lasts 120 seconds and runs the function self.endMatch after it expires. 
      self.initializeTimer("everyoneTimer",120,self.endMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].matchClicks=0
         self.data[sid].status={"page":"game","numberClicks":0,"currentMatch":self.currentMatch,"warning":"no"}
         self.updateStatus(sid)
      #update monitor screen:
      self.monitorMessage()

   def makeChoice(self,message,client):
      #this function is run when the sever receives a message from a client such that message['type']="makeChoice"
      #get subjectID
      sid=client.subjectID
      #Add 1 to the number of currentClicks for self.currentMatch
      self.currentClicks+=1
      self.data[sid].matchClicks+=1
      #Record the data to self.data to be saved. This adds a list [currentMatch,#clicks] to self.data[sid].choices     
      self.data[sid].choices.append([self.currentMatch,self.currentClicks])
      #start a self timer "can be called anything"
      self.initializeTimer("myTimeCanBeLabledAnything"+sid,5,self.highlightMakeChoice,sid)

      #Check if there are more than 10 clicks, if so run self.endMatch, otherwise, run self.updateClicks      
      if self.currentClicks>10000:
         self.endMatch()
      else:
         self.updateClicks()

      #update monitor screen:
      self.monitorMessage()


   def highlightMakeChoice(self,sid):
      self.data[sid].status['warning']="yes"
      self.updateStatus(sid)

   def updateClicks(self):
      #update status of all clients
      msg={}
      msg['type']="updateNumberClicks"
      msg['number']=self.currentClicks
      self.messageToId(msg,sid="all")

   def endMatch(self):
      #wait 10 seconds, and then run self.startMatch to start the next match
      self.initializeTimer("timer",10,self.startMatch)
      #update status of all clients
      # messageToId(self,msg,sid="all",output="send"):
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"postMatch","stage":"noChoices"}
         self.updateStatus(sid)
      

   def experimentSpecificMonitorTableEntries(self):
      self.currentMonitorTable="experiment"
      self.data['monitorTableInfo']['experiment']=[
      ['page'           ,'self.data[sid].status["page"]'],
      ['stage'          ,'self.data[sid].status["stage"]'],
      ['Match#'          ,'self.currentMatch'],
      ['My Clicks'         ,'self.data[sid].matchClicks'],
      ['Total Clicks'            ,'self.currentClicks'],
      ]
      self.newMonitorTable()


class subjectClass():
   def __init__(self):
      #the subjectID is automatically defined in server.py, and can be accessed with self.subjectID
      #every time the client clicks the button will be recorded here.
      self.choices=[]
      #the total payoffs are recorded here
      self.totalPayoffs=0
      #the subject status is initialized here.  Any time this is changed, you can update the client with self.updateStatus(subjectID)
      self.status={}
      self.status['page']="generic"
      self.status['message']=["Please read, sign, and date your consent form. &lt;br> You may read over the instructions as we wait to begin."]

      #number of clicks this match
      self.matchClicks=0



if __name__ == "__main__":
   import imp
   filename="../../../code/python/server.py"
   completePathToServerDotPyFile=os.path.abspath(filename) 
   server = imp.load_source('server',completePathToServerDotPyFile)
   #python experiment.py -l local -o True -s False



</code></pre>
</div>

<div class="header">/examples/speedTest2/analyze/messageLog.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 

filename='../data/tmp/logs/messagesLog.pickle'
with open(filename,'rb') as f:
	while True:
		try:
			data=pickle.load(f)
			print data[0],data[1],data[2]['type'],data[2]['sid']
		except Exception,e: 
			print str(e)
			break

</code></pre>
</div>

<div class="header">/examples/speedTest2/analyze/readData.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">import imp
experiment = imp.load_source('experiment',"../files/experiment.py")
from experiment import subjectClass
import pickle 


filename='../data/tmp/tmp.pickle'
file = open(filename,'rb')
data=pickle.load(file)
file.close() 

for sid in data['subjectIDs']:
   print sid,data[sid].choices
</code></pre>
</div>

<div class="header">/examples/speedTest2/files/experiment.css</div>
<div class="p">
<pre class="line-numbers"><code class="language-css">#makeChoiceButton {
    position: absolute;
    top: 400px;
    left: 700px;
    width: 200px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    background-color: rgba(255, 0, 0, .11);
}

#matchText {
    color: black;
    position: absolute;
    top: 200px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}

#numberClicks {
    position: absolute;
    top: 700px;
    left: 600px;
    width: 400px;
    height: 100px;
    text-align: center;
    line-height: 100px;
    font-size: 150%;
}
</code></pre>
</div>

<div class="header">/examples/speedTest2/files/experiment.js</div>
<div class="p">
<pre class="line-numbers"><code class="language-js">// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Message // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function sendParameters(msg){
    window.payoffVariable=msg['payoffVariable'];
}

function updateNumberClicks(msg){
    console.log(msg['number'],new Date().getTime());
    document.getElementById("numberClicks").innerHTML="There have been " + msg['number'] + " clicks so far.";
}
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Draw Interface // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function drawButton() {
    placeText({"divid":"makeChoiceButton","text":"Click Here to Submit","top":"400px","left":"700px","width":"200px","height":"100px","backgroundColor":"rgba(255,0,0,.11)",'border':'5px solid transparent'})
    clickButton("many","makeChoiceButton",makeChoiceButtonClicked,27);
    hoverDivChangeOtherDiv("makeChoiceButton","makeChoiceButton",{'border':'5px solid red'});
}

function drawMatch(currentMatch) {
    var matchText = createAndAddDiv("matchText","mainDiv");
    var thisText = "Match #" + currentMatch + "  Time: &lt;time id='everyoneTimer'>0&lt;/time>";
    placeText({"divid":"matchText","text":thisText,"top":"200px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});

    if(window.state['warning']=="yes"){
        var thisColor="red";
        var thisText = "Please make choice!!!";
    }
    else{
        var thisColor="black";
        var personalTimer="myTimeCanBeLabledAnything"+window.state['subjectID']
        var thisText = "My Personal Timer That is Subject Specific: &lt;time id='"+personalTimer+"'>0&lt;/time>";
        moveTimer(personalTimer);
    }

    placeText({"divid":"myMatchText","color":thisColor,"text":thisText,"top":"600px","height":"100px","fontSize":"25px","lineHeight":"50px","width":"100%"});

    moveTimer("everyoneTimer");
}

function drawStatus(number) {
    var thisText = "There have been " + number + " clicks so far.";
    placeText({"divid":"numberClicks","text":thisText,"top":"700px","left":"600px","width":"400px","height":"100px","fontSize":"25px"});
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Actions // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function makeChoiceButtonClicked(someVariable) {
    var message = { "type": "makeChoice", "variable": someVariable };
    for(k=0;k&lt;1000;k++){
        window.setTimeout(function(){
            sendMessage(message);
        }, k);
    }
}

// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 
// // // // // // // // // // //  Pages // // // // // // // // // // 
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // 

function game(){
    clearAll();
    drawButton();
    drawMatch(thisStatus['currentMatch']);
    drawStatus(thisStatus['numberClicks']);
}

function postMatch(){
    clearAll();
    genericScreen("That match is over.  The next match will start in &lt;time id='timer'>0&lt;/time>");
    moveTimer("timer");
}
</code></pre>
</div>

<div class="header">/examples/speedTest2/files/experiment.py</div>
<div class="p">
<pre class="line-numbers"><code class="language-python">#file: experiment.py
#this is where you will define the experimentClass class, subjectClass class, and monitorClass class
from __future__ import print_function
import os

class experimentClass():
   # - the dictionary self.data will be stored automatically every 10 seconds.
   # - store data in self.data[subjectID] which is a Subject class (defined below)
   # - send messages like self.customMessage(subjectID,msg)
   # - list of all subjects at self.data['subjectIDs']
   def __init__(self):
      # initialize the class
      self.setParameters()
      #these are function that can be run by clicking a button on the monitor page
      self.monitorTaskList=['startExperiment']
   def setParameters(self):
      self.data['exchangeRate']=.1
      self.currentMatch=-1
      self.currentClicks=-1
 
   def sendParameters(self,sid):
      msg={}
      msg['payoffVariable']=2
      msg['type']="sendParameters"
      self.customMessage(sid,msg)

   def notAcceptingClientsAnymore(self):
      #This is run when you stop accepting clients.  This is where you might want to do your random matching, or randomly determine parameters for the experiment.
      print(self.data['subjectIDs'])
   
   def reconnectingClient(self,client):
      #This function is needed, DO NOT DELETE
      sid=client.subjectID
      self.sendParameters(sid)
      self.updateStatus(sid)

   def startExperiment(self,message,client):
      #this is run when you click the "start Experiment" button on the monitor page.
      self.taskDone(message)
      
      #this sets the monitor table as defined in the function below
      self.experimentSpecificMonitorTableEntries()
      #this updates the monitor table
      self.monitorMessage()

      self.initializeTimer("everyoneTimer",1,self.makeClick)
      print("Starting Experiment!")

   def makeClick(self):
      for sid in self.data['subjectIDs']:
         self.data[sid].matchClicks+=1
         self.data[sid].status={"page":"game","numberClicks":self.data[sid].matchClicks,"currentMatch":self.currentMatch,"warning":"no"}
         self.updateStatus(sid)
      #update monitor screen:
      self.monitorMessage()
      self.initializeTimer("everyoneTimer",.01,self.makeClick)

   def startMatch(self):
      #add 1 to self.currentMatch
      self.currentMatch+=1
      #set current clicks for this match to 0
      self.currentClicks=0
      #this starts a timer for all subject that lasts 120 seconds and runs the function self.endMatch after it expires. 
      self.initializeTimer("everyoneTimer",120,self.endMatch)
      #update status of all clients
      for sid in self.data['subjectIDs']:
         self.data[sid].matchClicks=0
         self.data[sid].status={"page":"game","numberClicks":0,"currentMatch":self.currentMatch,"warning":"no"}
         self.updateStatus(sid)
      #update monitor screen:
      self.monitorMessage()

   def makeChoice(self,message,client):
      #this function is run when the sever receives a message from a client such that message['type']="makeChoice"
      #get subjectID
      sid=client.subjectID
      #Add 1 to the number of currentClicks for self.currentMatch
      self.currentClicks+=1
      self.data[sid].matchClicks+=1
      #Record the data to self.data to be saved. This adds a list [currentMatch,#clicks] to self.data[sid].choices     
      self.data[sid].choices.append([self.currentMatch,self.currentClicks])
      #start a self timer "can be called anything"
      self.initializeTimer("myTimeCanBeLabledAnything"+sid,5,self.highlightMakeChoice,sid)

      #Check if there are more than 10 clicks, if so run self.endMatch, otherwise, run self.updateClicks      
      if self.currentClicks>10000:
         self.endMatch()
      else:
         self.updateClicks()

      #update monitor screen:
      self.monitorMessage()


   def highlightMakeChoice(self,sid):
      self.data[sid].status['warning']="yes"
      self.updateStatus(sid)

   def updateClicks(self):
      #update status of all clients
      msg={}
      msg['type']="updateNumberClicks"
      msg['number']=self.currentClicks
      self.messageToId(msg,sid="all")

   def endMatch(self):
      #wait 10 seconds, and then run self.startMatch to start the next match
      self.initializeTimer("timer",10,self.startMatch)
      #update status of all clients
      # messageToId(self,msg,sid="all",output="send"):
      for sid in self.data['subjectIDs']:
         self.data[sid].status={"page":"postMatch","stage":"noChoices"}
         self.updateStatus(sid)
      

   def experimentSpecificMonitorTableEntries(self):
      self.currentMonitorTable="experiment"
      self.data['monitorTableInfo']['experiment']=[
      ['page'           ,'self.data[sid].status["page"]'],
      ['stage'          ,'self.data[sid].status["stage"]'],
      ['Match#'          ,'self.currentMatch'],
      ['My Clicks'         ,'self.data[sid].matchClicks'],
      ['Total Clicks'            ,'self.currentClicks'],
      ]
      self.newMonitorTable()


class subjectClass():
   def __init__(self):
      #the subjectID is automatically defined in server.py, and can be accessed with self.subjectID
      #every time the client clicks the button will be recorded here.
      self.choices=[]
      #the total payoffs are recorded here
      self.totalPayoffs=0
      #the subject status is initialized here.  Any time this is changed, you can update the client with self.updateStatus(subjectID)
      self.status={}
      self.status['page']="generic"
      self.status['message']=["Please read, sign, and date your consent form. &lt;br> You may read over the instructions as we wait to begin."]

      #number of clicks this match
      self.matchClicks=0



if __name__ == "__main__":
   import imp
   filename="../../../code/python/server.py"
   completePathToServerDotPyFile=os.path.abspath(filename) 
   server = imp.load_source('server',completePathToServerDotPyFile)
   #python experiment.py -l local -o True -s False



</code></pre>
</div>

<div class="header">/requirements.txt</div>
<div class="p">
<pre class="line-numbers"><code class="language-plain">setuptools
wheel
pathlib
twisted
autobahn
future
netifaces
</code></pre>
</div>


<script src="../code/css/prism/prism.js"></script>

<script>
    var sideBar=document.getElementById("sideBar");
    var headers=document.querySelectorAll('.header,.subheader')
    for(k=0;k<headers.length;k++){
        var thisHeader=document.createElement("div");  
        var thisHeaderLink=document.createElement("a");  
        if(headers[k].className=="header"){
            thisHeader.className="sideBarEntry"
        }
        else if(headers[k].className=="subheader"){
            thisHeader.className="sideBarEntrys"
        }
        thisHeaderLink.innerHTML=headers[k].innerHTML;
        var replaced = headers[k].innerHTML.split(' ').join('').split('.').join('').split(')').join('').split('(').join('');
        thisHeaderLink.href="#"+replaced;
        thisHeader.innerHTML=thisHeaderLink.outerHTML;
        sideBar.appendChild(thisHeader);
        var subheaders=headers[k].getElementsByClassName("p");

        var target=document.createElement("a");  
        target.name=replaced;
        headers[k].parentNode.insertBefore(target,headers[k]);
    }




</script>

</body>

</html>


